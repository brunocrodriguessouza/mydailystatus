!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Nl){"use strict";try{(function(){Nl=Nl&&Object.prototype.hasOwnProperty.call(Nl,"default")?Nl.default:Nl;var t,a,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function c(t,s,a,u){return new(a=a||Promise)(function(n,e){function i(t){try{o(u.next(t))}catch(t){e(t)}}function r(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,r)}o((u=u.apply(t,s||[])).next())})}function y(n,i){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}(e=a=a||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";a.DEBUG,a.VERBOSE,a.INFO,a.WARN,a.ERROR,a.SILENT;function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}var u=a.INFO,h=((t={})[a.DEBUG]="log",t[a.VERBOSE]="log",t[a.INFO]="info",t[a.WARN]="warn",t[a.ERROR]="error",t),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.DEBUG],t)),this._logHandler.apply(this,s([this,a.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.VERBOSE],t)),this._logHandler.apply(this,s([this,a.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.INFO],t)),this._logHandler.apply(this,s([this,a.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.WARN],t)),this._logHandler.apply(this,s([this,a.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,a.ERROR],t)),this._logHandler.apply(this,s([this,a.ERROR],t))},f);function f(t){this.name=t,this._logLevel=u,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,v=(n(g,d=Error),g);function g(t,e){var n=d.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(i=r,s.replace(b,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new v(o,u),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var b=/\{\$([^}]+)}/g,E=(A.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},A.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},A.prototype.setServiceProps=function(t){return this.serviceProps=t,this},A);function A(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var I,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},T=T||{},_=N;function S(t){return"string"==typeof t}function k(t){return"number"==typeof t}function R(t,e){t=t.split("."),e=e||_;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function L(){}function D(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function O(t){return"array"==D(t)}function C(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function V(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var U="closure_uid_"+(1e9*Math.random()>>>0),P=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function q(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function F(t,e,n){return(F=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:q).apply(null,arguments)}function G(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now||function(){return+new Date};function j(t,o){function e(){}e.prototype=o.prototype,t.N=o.prototype,t.prototype=new e,(t.prototype.constructor=t).yb=function(t,e,n){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return o.prototype[e].apply(t,i)}}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0))this[U]||(this[U]=++P)},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var H=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(S(t))return S(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r=S(t)?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function Y(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var X,J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var $=_.navigator;if($){var tt=$.userAgent;if(tt){X=tt;break t}}X=""}function et(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function nt(t){var e,n={};for(e in t)n[e]=t[e];return n}var it="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<it.length;o++)n=it[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ot(t){return ot[" "](t),t}ot[" "]=L;var st,at,ut=K(X,"Opera"),ht=K(X,"Trident")||K(X,"MSIE"),ct=K(X,"Edge"),lt=ct||ht,ft=K(X,"Gecko")&&!(K(X.toLowerCase(),"webkit")&&!K(X,"Edge"))&&!(K(X,"Trident")||K(X,"MSIE"))&&!K(X,"Edge"),pt=K(X.toLowerCase(),"webkit")&&!K(X,"Edge");function dt(){var t=_.document;return t?t.documentMode:void 0}t:{var yt="",vt=(at=X,ft?/rv:([^\);]+)(\)|;)/.exec(at):ct?/Edge\/([\d\.]+)/.exec(at):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(at):pt?/WebKit\/(\S+)/.exec(at):ut?/(?:Version)[ \/]?(\S+)/.exec(at):void 0);if(vt&&(yt=vt?vt[1]:""),ht){var gt=dt();if(null!=gt&&gt>parseFloat(yt)){st=String(gt);break t}}st=yt}var mt,wt={};function bt(a){return t=a,e=function(){for(var t=0,e=J(String(st)).split("."),n=J(String(a)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=wt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var Et=_.document;mt=Et&&ht?dt()||("CSS1Compat"==Et.compatMode?parseInt(st,10):5):void 0;var At=!ht||9<=Number(mt),It=ht&&!bt("9"),Nt=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",L,e),_.removeEventListener("test",L,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function _t(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{ot(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=S(t.pointerType)?t.pointerType:St[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.Ia=!1},j(_t,Tt);var St={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var kt="closure_listenable_"+(1e6*Math.random()|0),Rt=0;function Lt(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.da=r,this.key=++Rt,this.X=this.Z=!1}function Dt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Ot(t){this.src=t,this.a={},this.b=0}function Ct(t,e){var n=e.type;if(n in t.a){var i,r=t.a[n],o=H(r,e);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(Dt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Vt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==i)return r}return-1}Ot.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Vt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Lt(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Ut="closure_lm_"+(1e6*Math.random()|0),Pt={};function Mt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(O(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}i=Qt(i);return e&&e[kt]?e.Aa(n,i,V(r)?!!r.capture:!!r,o):qt(e,n,i,!0,r,o)}(t,e,n,i,r);if(O(e)){for(var o=0;o<e.length;o++)Mt(t,e[o],n,i,r);return null}return n=Qt(n),t&&t[kt]?t.za(e,n,V(i)?!!i.capture:!!i,r):qt(t,e,n,!1,i,r)}function qt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=V(r)?!!r.capture:!!r;if(s&&!At)return null;var a,u,h=Bt(t);if(h||(t[Ut]=h=new Ot(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(a=jt,i=u=At?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)Nt||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Gt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ft(t){if(!k(t)&&t&&!t.X){var e=t.src;if(e&&e[kt])Ct(e.c,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Gt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Bt(e))?(Ct(n,t),0==n.b&&(n.src=null,e[Ut]=null)):Dt(t)}}}function Gt(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function xt(t,e){var n=t.listener,i=t.da||t.src;return t.Z&&Ft(t),n.call(i,e)}function jt(t,e){return!!t.X||(At?xt(t,new _t(e,this)):xt(t,e=new _t(e||R("window.event"),this)))}function Bt(t){return(t=t[Ut])instanceof Ot?t:null}var Ht="__closure_events_fn_"+(1e9*Math.random()>>>0);function Qt(e){return"function"==D(e)?e:(e[Ht]||(e[Ht]=function(t){return e.handleEvent(t)}),e[Ht])}function zt(){B.call(this),this.c=new Ot(this),(this.J=this).B=null}function Yt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&Ct(t.c,s),r=!1!==a.call(u,i)&&r}}return r&&0!=i.Ia}j(zt,B),zt.prototype[kt]=!0,(I=zt.prototype).addEventListener=function(t,e,n,i){Mt(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(O(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=V(r)?!!r.capture:!!r,i=Qt(i),e&&e[kt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Vt(s=e.a[n],i,r,o))&&(Dt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Bt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Vt(n,i,r,o)),(i=-1<e?n[e]:null)&&Ft(i))}(this,t,e,n,i)},I.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var i=t.type||t;if(S(t))t=new Tt(t,n);else if(t instanceof Tt)t.target=t.target||n;else{var r=t;rt(t=new Tt(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];r=Yt(s,i,!0,t)&&r}if(r=Yt(s=t.a=n,i,!0,t)&&r,r=Yt(s,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=Yt(s=t.a=e[o],i,!1,t)&&r;return r},I.G=function(){if(zt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Dt(n[i]);delete e.a[t],e.b--}}this.B=null},I.za=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},I.Aa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Wt=_.JSON.stringify;function Xt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Jt(){this.b=this.a=null}Xt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Kt,Zt=new Xt(function(){return new $t},function(t){t.reset()});function $t(){this.next=this.b=this.a=null}function te(t){_.setTimeout(function(){throw t},0)}function ee(t,e){var n;Kt||(n=_.Promise.resolve(void 0),Kt=function(){n.then(re)}),ne||(Kt(),ne=!0),ie.add(t,e)}Jt.prototype.add=function(t,e){var n=Zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var ne=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),ie=new Jt;function re(){for(var t;i=n=void 0,i=null,(n=ie).a&&(i=n.a,n.a=n.a.next,n.a||(n.b=null),i.next=null),t=i;){try{t.a.call(t.b)}catch(t){te(t)}var e=Zt;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,i;ne=!1}function oe(t,e){zt.call(this),this.b=t||1,this.a=e||_,this.f=F(this.gb,this),this.g=x()}function se(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ae(t,e,n){if("function"==D(t))n&&(t=F(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=F(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function ue(t,e,n){B.call(this),this.f=null!=n?F(t,n):t,this.c=e,this.b=F(this.$a,this),this.a=[]}function he(t){t.U=ae(t.b,t.c),t.f.apply(null,t.a)}function ce(t){B.call(this),this.b=t,this.a={}}j(oe,zt),(I=oe.prototype).ba=!1,I.L=null,I.gb=function(){if(this.ba){var t=x()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(se(this),this.start()))}},I.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=x())},I.G=function(){oe.N.G.call(this),se(this),delete this.a},j(ue,B),(I=ue.prototype).ea=!1,I.U=null,I.Ta=function(t){this.a=arguments,this.U?this.ea=!0:he(this)},I.G=function(){ue.N.G.call(this),this.U&&(_.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},I.$a=function(){this.U=null,this.ea&&(this.ea=!1,he(this))},j(ce,B);var le=[];function fe(t,e,n,i){O(n)||(n&&(le[0]=n.toString()),n=le);for(var r=0;r<n.length;r++){var o=Mt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ft(t)},t),t.a={}}function de(){}ce.prototype.G=function(){ce.N.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ye=new zt;function ve(t){Tt.call(this,"serverreachability",t)}function ge(t){ye.dispatchEvent(new ve(ye))}function me(t){Tt.call(this,"statevent",t)}function we(t){ye.dispatchEvent(new me(ye))}function be(t){Tt.call(this,"timingevent",t)}function Ee(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}j(ve,Tt),j(me,Tt),j(be,Tt);var Ae={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9},Ie={jb:"complete",wb:"success",Ma:"error",La:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function Ne(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ne.prototype.a=null;var Se,ke={OPEN:"a",ib:"b",Ma:"c",rb:"d"};function Re(){Tt.call(this,"d")}function Le(){Tt.call(this,"c")}function De(){}function Oe(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new ce(this),this.O=Ce,t=lt?125:void 0,this.P=new oe(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}j(Re,Tt),j(Le,Tt),j(De,Ne),Se=new De;var Ce=45e3,Ve={},Ue={};function Pe(t,e,n){t.F=1,t.f=un(tn(e)),t.l=n,t.H=!0,qe(t,null)}function Me(t,e,n,i){t.F=1,t.f=un(tn(e)),t.l=null,t.H=n,qe(t,i)}function qe(t,e){t.v=x(),xe(t),t.D=tn(t.f),an(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new ue(F(t.Ja,t,t.a),t.J)),fe(t.I,t.a,"readystatechange",t.cb),e=t.h?nt(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),ge(1)}function Fe(t,e,n){for(var i=!0;!t.m&&t.A<n.length;){var r=Ge(t,n);if(r==Ue){4==e&&(t.c=4,we(14),i=!1);break}if(r==Ve){t.c=4,we(15),i=!1;break}ze(t,r)}4==e&&0==n.length&&(t.c=1,we(16),i=!1),t.b=t.b&&i,i||(Qe(t),He(t))}function Ge(t,e){var n=t.A,i=e.indexOf("\n",n);return-1==i?Ue:(n=Number(e.substring(n,i)),isNaN(n)?Ve:(i+=1)+n>e.length?Ue:(e=e.substr(i,n),t.A=i+n,e))}function xe(t){t.R=x()+t.O,je(t,t.O)}function je(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=Ee(F(t.ab,t),e)}function Be(t){t.i&&(_.clearTimeout(t.i),t.i=null)}function He(t){t.g.Ca()||t.m||t.g.na(t)}function Qe(t){Be(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,se(t.P),pe(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function ze(t,e){try{t.g.Fa(t,e),ge(4)}catch(t){}}function Ye(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(C(t)||S(t))Q(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(C(t)||S(t)){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(S(t))return t.split("");if(C(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof We)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Xe(t,e){Ke(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Je(t))}function Je(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Ke(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Ke(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(I=Oe.prototype).setTimeout=function(t){this.O=t},I.cb=function(t){t=t.target;var e=this.B;e&&3==ti(t)?e.Ta():this.Ja(t)},I.Ja=function(t){try{if(t==this.a)t:{var e=ti(this.a),n=this.a.ya(),i=this.a.T();if(!(e<3||3==e&&!lt&&!this.a.aa())){this.m||4!=e||7==n||ge(8==n||i<=0?3:2),Be(this);var r=this.a.T();this.o=r;var o=this.a.aa();if(this.b=200==r){if(this.S&&!this.s){e:{if(this.a){var s=ei(this.a,"X-HTTP-Initial-Response");if(s&&!W(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,we(12),Qe(this),He(this);break t}this.s=!0,ze(this,a)}this.H?(Fe(this,e,o),lt&&this.b&&3==e&&(fe(this.I,this.P,"tick",this.bb),this.P.start())):ze(this,o),4==e&&Qe(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,xe(this)))}else 400==r&&0<o.indexOf("Unknown SID")?(this.c=3,we(12)):(this.c=0,we(13)),Qe(this),He(this)}}}catch(t){}},I.bb=function(){if(this.a){var t=ti(this.a),e=this.a.aa();this.A<e.length&&(Be(this),Fe(this,t,e),this.b&&4!=t&&xe(this))}},I.cancel=function(){this.m=!0,Qe(this)},I.ab=function(){this.i=null;var t=x();0<=t-this.R?(2!=this.F&&(ge(3),we(17)),Qe(this),this.c=2,He(this)):je(this,this.R-t)},(I=We.prototype).C=function(){Je(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},I.K=function(){return Je(this),this.a.concat()},I.get=function(t,e){return Ke(this.b,t)?this.b[t]:e},I.set=function(t,e){Ke(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},I.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof $e?(this.h=void 0!==e?e:t.h,en(this,t.f),this.j=t.j,nn(this,t.b),rn(this,t.i),this.a=t.a,on(this,An(t.c)),this.g=t.g):t&&(n=String(t).match(Ze))?(this.h=!!e,en(this,n[1]||"",!0),this.j=hn(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.a=hn(n[5]||"",!0),on(this,n[6]||"",!0),this.g=hn(n[7]||"")):(this.h=!!e,this.c=new gn(null,this.h))}function tn(t){return new $e(t)}function en(t,e,n){t.f=n?hn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.b=n?hn(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function on(t,e,n){var i,r;e instanceof gn?(t.c=e,i=t.c,(r=t.h)&&!i.f&&(mn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(wn(this,e),En(this,n,t))},i)),i.f=r):(n||(e=cn(e,yn)),t.c=new gn(e,t.h))}function sn(t,e,n){t.c.set(e,n)}function an(t,e,n){O(n)||(n=[String(n)]),En(t.c,e,n)}function un(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function hn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cn(t,e,n){return S(t)?(t=encodeURI(t).replace(e,ln),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ln(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(cn(e,fn,!0),":");var n=this.b;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(cn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(cn(n,"/"==n.charAt(0)?dn:pn,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",cn(n,vn)),t.join("")},$e.prototype.resolve=function(t){var e=tn(this),n=!!t.f;n?en(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?nn(e,t.b):n=null!=t.i;var i=t.a;if(n)rn(e,t.i);else if(n=!!t.a){if("/"!=i.charAt(0))if(this.b&&!this.a)i="/"+i;else{var r=e.a.lastIndexOf("/");-1!=r&&(i=e.a.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if(K(r,"./")||K(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],s=0;s<r.length;){var a=r[s++];"."==a?i&&s==r.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&s==r.length&&o.push("")):(o.push(a),i=!0)}i=o.join("/")}else i=r}return n?e.a=i:n=""!==t.c.toString(),n?on(e,An(t.c)):n=!!t.g,n&&(e.g=t.g),e};var fn=/[#\/\?@]/g,pn=/[#\?:]/g,dn=/[#\?]/g,yn=/[#\?@]/g,vn=/#/g;function gn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function mn(n){n.a||(n.a=new We,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function wn(t,e){mn(t),e=In(t,e),Ke(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe(t.a,e))}function bn(t,e){return mn(t),e=In(t,e),Ke(t.a.b,e)}function En(t,e,n){wn(t,e),0<n.length&&(t.c=null,t.a.set(In(t,e),Y(n)),t.b+=n.length)}function An(t){var e=new gn;return e.c=t.c,t.a&&(e.a=new We(t.a),e.b=t.b),e}function In(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Nn(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function Tn(t){var e=t.a.F.a;if(null!=e)we(4),e?(we(10),pi(t.a,t,!1)):(we(11),pi(t.a,t,!0));else{t.b=new Oe(t,void 0,void 0),t.b.h=t.h,e=mi(e=t.a,e.Y()?t.f:null,t.i),we(4),an(e,"TYPE","xmlhttp");var n=t.a.j,i=t.a.I;n&&i&&sn(e,n,i),Me(t.b,e,!1,t.f)}}function _n(){this.a=this.b=null}function Sn(){this.a=new We}function kn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[U]||(t[U]=++P)):e.charAt(0)+t}function Rn(t,e){this.b=t,this.a=e}function Ln(t){this.g=t||Dn,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ka&&_.ka.Da&&_.ka.Da()&&_.ka.Da().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Sn),this.b=null,this.c=[]}(I=gn.prototype).add=function(t,e){mn(this),this.c=null,t=In(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},I.forEach=function(n,i){mn(this),this.a.forEach(function(t,e){Q(t,function(t){n.call(i,t,e,this)},this)},this)},I.K=function(){mn(this);for(var t=this.a.C(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},I.C=function(t){mn(this);var e=[];if(S(t))bn(this,t)&&(e=z(e,this.a.get(In(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},I.set=function(t,e){return mn(this),this.c=null,bn(this,t=In(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},I.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},I.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.C(i);for(var o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}}return this.c=t.join("&")},j(function(){},function(){}),(I=Nn.prototype).M=null,I.$=function(t){return this.a.$(t)},I.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},I.Ca=function(){return!1},I.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=ei(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=ei(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var i=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void vi(e,2)}this.f=i[0]}else(e=this.a).m=this.c,vi(e,2)}else 1==this.M&&(this.g?we(6):"11111"==e?(we(5),this.g=!0,(!ht||10<=Number(mt))&&(this.c=200,this.b.cancel(),we(11),pi(this.a,this,!0))):(we(7),this.g=!1))},I.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,Tn(this)):1==this.M&&(this.g?(we(11),pi(this.a,this,!0)):(we(10),pi(this.a,this,!1)));else{0==this.M?we(8):1==this.M&&we(9);var t=this.a;t.m=this.c,vi(t,2)}},I.Y=function(){return this.a.Y()},I.ma=function(){return this.a.ma()},Sn.prototype.add=function(t){this.a.set(kn(t),t)},Sn.prototype.C=function(){return this.a.C()};var Dn=10;function On(t,e){!t.a&&(K(e,"spdy")||K(e,"quic")||K(e,"h2"))&&(t.f=t.g,t.a=new Sn,t.b&&(Pn(t,t.b),t.b=null))}function Cn(t){return t.b||t.a&&t.a.a.c>=t.f}function Vn(t){return t.b?1:t.a?t.a.a.c:0}function Un(t,e){return t=t.b?t.b==e:!!t.a&&(e=kn(e),Ke(t.a.a.b,e))}function Pn(t,e){t.a?t.a.add(e):t.b=e}function Mn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=kn(e),n=Ke(t.a.a.b,n)),n&&Xe(t.a.a,kn(e)))}function qn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return Y(t.c);var e=t.c;return Q(t.a.C(),function(t){e=e.concat(t.j)}),e}function Fn(){}function Gn(){this.a=new Fn}function xn(t,i,e){var r=e||"";try{Ye(t,function(t,e){var n=t;V(t)&&(n=Wt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function jn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}Ln.prototype.cancel=function(){var t;this.c=qn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(Q(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},Fn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},Fn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var Bn=_.JSON.parse;function Hn(t){zt.call(this),this.headers=new We,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Qn,this.D=this.F=!1}j(Hn,zt);var Qn="",zn=/^https?$/i,Yn=["POST","PUT"];function Wn(t){return"content-type"==t.toLowerCase()}function Xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Jn(t),Zn(t)}function Jn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Kn(t){if(t.b&&void 0!==T&&(!t.s[1]||4!=ti(t)||2!=t.T()))if(t.l&&4==ti(t))ae(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==ti(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var o=String(t.A).match(Ze)[1]||null;if(!o&&_.self&&_.self.location){var s=_.self.location.protocol;o=s.substr(0,s.length-1)}r=!zn.test(o?o.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<ti(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.T()+"]",Jn(t)}}finally{Zn(t)}}}function Zn(t,e){if(t.a){$n(t);var n=t.a,i=t.s[0]?L:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function $n(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function ti(t){return t.a?t.a.readyState:0}function ei(t,e){return t.a?t.a.getResponseHeader(e):null}function ni(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}if(i)return t;var r;if(r="",et(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,S(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(i=t.indexOf("?"))<0||n<i){i=n;var o=""}else o=t.substring(i+1,n);n=(t=[t.substr(0,i),o,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return sn(t,e,n),t}function ii(t){this.f=[],this.F=new _n,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!R("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=R("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=R("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=R("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=R("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new Ln(t&&t.concurrentRequestLimit),this.ja=new Gn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function ri(t){if(oi(t),3==t.u){var e=t.P++,n=tn(t.B);sn(n,"SID",t.H),sn(n,"RID",e),sn(n,"TYPE","terminate"),hi(t,n),(e=new Oe(t,e,void 0)).F=2,e.f=un(tn(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=x(),xe(e)}gi(t)}function oi(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(_.clearTimeout(t.l),t.l=null),di(t),t.b.cancel(),t.h&&(k(t.h)&&_.clearTimeout(t.h),t.h=null)}function si(t,e){t.f.push(new Rn(t.Qa++,e)),3==t.u&&ai(t)}function ai(t){Cn(t.b)||t.h||(t.h=!0,ee(t.Ha,t),t.A=0)}function ui(t,e){var n;n=e?e.W:t.P++;var i=tn(t.B);sn(i,"SID",t.H),sn(i,"RID",n),sn(i,"AID",t.O),hi(t,i),t.g&&t.i&&ni(i,t.g,t.i),n=new Oe(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=ci(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Pn(t.b,n),Pe(n,i,e)}function hi(t,n){t.c&&Ye({},function(t,e){sn(n,e,t)})}function ci(t,e,n){n=Math.min(t.f.length,n);var i=t.c?F(t.c.Sa,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=r[u].b,c=r[u].a;if((h-=o)<0)o=Math.max(0,r[u].b-100),a=!1;else try{xn(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(a){i=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,i}function li(t){t.a||t.l||(t.S=1,ee(t.Ga,t),t.v=0)}function fi(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=Ee(F(t.Ga,t),yi(t,t.v)),t.v++,1)}function pi(t,e,n){var i=e.l;i&&On(t.b,i),t.ia=t.oa&&n,t.m=e.c,t.B=mi(t,null,t.ha),ai(t)}function di(t){null!=t.s&&(_.clearTimeout(t.s),t.s=null)}function yi(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function vi(t,e){if(2==e){var n=null;t.c&&(n=null);var i=F(t.eb,t);n||(n=new $e("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||en(n,"https"),un(n)),function(t,e){var n=new de;if(_.Image){var i=new Image;i.onload=G(jn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=G(jn,n,i,"TestLoadImage: error",!1,e),i.onabort=G(jn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=G(jn,n,i,"TestLoadImage: timeout",!1,e),_.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(n.toString(),i)}else we(2);t.u=0,t.c&&t.c.ta(e),gi(t),oi(t)}function gi(t){t.u=0,t.m=-1,t.c&&(0==qn(t.b).length&&0==t.f.length||(t.b.c.length=0,Y(t.f),t.f.length=0),t.c.sa())}function mi(t,e,n){var i,r,o,s,a,u,h=(i=n)instanceof $e?tn(i):new $e(i,void 0);if(""!=h.b)e&&nn(h,e+"."+h.b),rn(h,h.i);else{var c,l=_.location;c=e?e+"."+l.hostname:l.hostname,r=l.protocol,o=c,s=+l.port,a=n,u=new $e(null,void 0),r&&en(u,r),o&&nn(u,o),s&&rn(u,s),a&&(u.a=a),h=u}return t.V&&et(t.V,function(t,e){sn(h,e,t)}),e=t.j,n=t.I,e&&n&&sn(h,e,n),sn(h,"VER",t.wa),hi(t,h),h}function wi(){}function bi(){if(ht&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function Ei(t,e){zt.call(this),this.a=new ii(e),this.g=t,this.m=e&&e.fb?e.fb:function(t){for(var e=t,n=1;n<arguments.length;n++){var i,r=arguments[n];if(0==r.lastIndexOf("/",0))e=r;else(i=""==e)||(i=0<=(i=e.length-1)&&e.indexOf("/",i)==i),e+=i?r:"/"+r}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new Ni(this)}function Ai(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Ii(){Le.call(this),this.status=1}function Ni(t){this.a=t}(I=Hn.prototype).ca=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Se),this.a.onreadystatechange=F(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Xn(this,t)}t=n||"";var r,o=new We(this.headers);i&&Ye(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Wn,n=t.length,i=S(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:S(t)?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=H(Yn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{$n(this),0<this.o&&((this.D=(r=this.a,ht&&bt(9)&&k(r.timeout)&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=F(this.Ba,this)):this.m=ae(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Xn(this,t)}},I.Ba=function(){void 0!==T&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},I.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Zn(this))},I.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Zn(this,!0)),Hn.N.G.call(this)},I.Ea=function(){this.j||(this.w||this.l||this.g?Kn(this):this.Za())},I.Za=function(){Kn(this)},I.T=function(){try{return 2<ti(this)?this.a.status:-1}catch(t){return-1}},I.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},I.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Bn(e)}},I.ya=function(){return this.h},I.Xa=function(){return S(this.f)?this.f:String(this.f)},(I=ii.prototype).wa=8,I.u=1,I.Ca=function(){return 0==this.u},I.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random()),t=this.P++;var e,n=new Oe(this,t,void 0),i=this.i;if(this.J&&(i?rt(i=nt(i),this.J):i=this.J),null===this.g&&(n.h=i),this.W)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if("__data__"in o.a&&S(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ci(this,n,e),sn(r=tn(this.B),"RID",t),sn(r,"CVER",22),this.o&&this.j&&sn(r,"X-HTTP-Session-Id",this.j),hi(this,r),this.g&&i&&ni(r,this.g,i),Pn(this.b,n),this.W?(sn(r,"$req",e),sn(r,"SID","null"),n.S=!0,Pe(n,r,null)):Pe(n,r,e),this.u=2}}else 3==this.u&&(t?ui(this,t):0==this.f.length||Cn(this.b)||ui(this))},I.Ga=function(){this.l=null,this.a=new Oe(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=tn(this.pa);sn(t,"RID","rpc"),sn(t,"SID",this.H),sn(t,"CI",this.ia?"0":"1"),sn(t,"AID",this.O),hi(this,t),sn(t,"TYPE","xmlhttp"),this.g&&this.i&&ni(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Me(this.a,t,!0,this.ga)},I.Fa=function(t,e){if(0!=this.u&&(this.a==t||Un(this.b,t)))if(this.m=t.o,!t.s&&Un(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(O(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;di(this),this.a.cancel(),this.a=null}fi(this),we(18)}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=Ee(F(this.Ya,this),6e3));if(Vn(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else vi(this,11)}else if(!t.s&&this.a!=t||di(this),!W(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var i=e[n];if(this.O=i[0],i=i[1],2==this.u)if("c"==i[0]){this.H=i[1],this.ga=i[2];var r=i[3];null!=r&&(this.wa=r),null!=(i=i[5])&&k(i)&&0<i&&(this.D=1.5*i),this.o&&(i=t.a)&&((r=ei(i,"X-Client-Wire-Protocol"))&&On(this.b,r),this.j&&(i=ei(i,"X-HTTP-Session-Id")))&&(this.I=i,sn(this.B,this.j,i)),this.u=3,this.c&&this.c.va(),i=t,this.pa=mi(this,this.Y()?this.ga:null,this.ha),i.s?(Mn(this.b,i),(r=this.D)&&i.setTimeout(r),i.i&&(Be(i),xe(i)),this.a=i):li(this),0<this.f.length&&ai(this)}else"stop"!=i[0]&&"close"!=i[0]||vi(this,7);else 3==this.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?vi(this,7):ri(this):"noop"!=i[0]&&this.c&&this.c.ua(i),this.v=0)}},I.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,fi(this),we(19))},I.na=function(t){var e=null;if(this.a==t){di(this),this.a=null;var n=2}else{if(!Un(this.b,t))return;e=t.j,Mn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=x()-t.v,ye.dispatchEvent(new be(ye,t.l&&t.l.length,this.A)),ai(this)):li(this);else{var i=t.c;if(3==i||0==i&&0<this.m||!(1==n&&function(t,e){if(!(Vn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.f=e.j.concat(t.f),1;if(!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa)))return t.h=Ee(F(t.Ha,t,e),yi(t,t.A)),t.A++,1}}(this,t)||2==n&&fi(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),i){case 1:vi(this,5);break;case 4:vi(this,10);break;case 3:vi(this,6);break;default:vi(this,2)}}},I.eb=function(t){we(t?2:1)},I.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Hn(this.Ka)).F=this.R,t},I.ma=function(){return!!this.c&&!0},I.Y=function(){return this.R},(I=wi.prototype).va=function(){},I.ua=function(){},I.ta=function(){},I.sa=function(){},I.Sa=function(){},bi.prototype.a=function(t,e){return new Ei(t,e)},j(Ei,zt),(I=Ei.prototype).addEventListener=function(t,e,n,i){Ei.N.addEventListener.call(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){Ei.N.removeEventListener.call(this,t,e,n,i)},I.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,i=this.b||void 0;we(0),t.ha=n,t.V=i||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new Nn(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=ni(e,t.g,t.i)),(t=t.w).i=n,e=mi(t.a,null,t.i),we(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,Tn(t)):(an(e,"MODE","init"),!t.a.o&&t.a.j&&an(e,"X-HTTP-Session-Id",t.a.j),t.b=new Oe(t,void 0,void 0),t.b.h=t.h,Me(t.b,e,!1,null),t.M=0)},I.close=function(){ri(this.a)},I.Wa=function(t){if(S(t)){var e={};e.__data__=t,si(this.a,e)}else this.h?((e={}).__data__=Wt(t),si(this.a,e)):si(this.a,t)},I.G=function(){this.a.c=null,delete this.f,ri(this.a),delete this.a,Ei.N.G.call(this)},j(Ai,Re),j(Ii,Le),j(Ni,wi),Ni.prototype.va=function(){this.a.dispatchEvent("a")},Ni.prototype.ua=function(t){this.a.dispatchEvent(new Ai(t))},Ni.prototype.ta=function(t){this.a.dispatchEvent(new Ii)},Ni.prototype.sa=function(){this.a.dispatchEvent("b")};var Ti=G(function(t,e){function n(){}n.prototype=t.prototype;var i=new n;return t.apply(i,Array.prototype.slice.call(arguments,1)),i},bi);bi.prototype.createWebChannel=bi.prototype.a,Ei.prototype.send=Ei.prototype.Wa,Ei.prototype.open=Ei.prototype.Va,Ei.prototype.close=Ei.prototype.close,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Ie.COMPLETE="complete",(_e.EventType=ke).OPEN="a",ke.CLOSE="b",ke.ERROR="c",ke.MESSAGE="d",zt.prototype.listen=zt.prototype.za,Hn.prototype.listenOnce=Hn.prototype.Aa,Hn.prototype.getLastError=Hn.prototype.Xa,Hn.prototype.getLastErrorCode=Hn.prototype.ya,Hn.prototype.getStatus=Hn.prototype.T,Hn.prototype.getResponseJson=Hn.prototype.Ua,Hn.prototype.getResponseText=Hn.prototype.aa,Hn.prototype.send=Hn.prototype.ca;var _i={createWebChannelTransport:Ti,ErrorCode:Ae,EventType:Ie,WebChannel:_e,XhrIo:Hn},Si=_i.createWebChannelTransport,ki=_i.ErrorCode,Ri=_i.EventType,Li=_i.WebChannel,Di=_i.XhrIo,Oi=Nl.SDK_VERSION,Ci=(Vi.prototype.t=function(){return null!=this.uid},Vi.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Vi.prototype.isEqual=function(t){return t.uid===this.uid},Vi);function Vi(t){this.uid=t}Ci.UNAUTHENTICATED=new Ci(null),Ci.i=new Ci("google-credentials-uid"),Ci.h=new Ci("first-party-uid");function Ui(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}var Pi,Mi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qi=(n(Ki,Pi=Error),Ki),Fi=(Ji.prototype.getToken=function(){return Promise.resolve(null)},Ji.prototype.l=function(){},Ji.prototype._=function(t){(this.u=t)(Ci.UNAUTHENTICATED)},Ji.prototype.T=function(){this.u=null},Ji),Gi=(Xi.prototype.getToken=function(){var e=this,n=this.I,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.I!==n)throw new qi(Mi.ABORTED,"getToken aborted due to token change.");return t?(ga("string"==typeof t.accessToken,"Invalid tokenData returned from getToken():"+t),new Ui(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Xi.prototype.l=function(){this.forceRefresh=!0},Xi.prototype._=function(t){this.u=t,this.R&&t(this.currentUser)},Xi.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.m),this.m=null,this.u=null},Xi.prototype.A=function(){var t=this.auth&&this.auth.getUid();return ga(null===t||"string"==typeof t,"Received invalid UID: "+t),new Ci(t)},Xi),xi=(Object.defineProperty(Wi.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Wi),ji=(Yi.prototype.getToken=function(){return Promise.resolve(new xi(this.P,this.V))},Yi.prototype._=function(t){t(Ci.h)},Yi.prototype.T=function(){},Yi.prototype.l=function(){},Yi),Bi=(zi.now=function(){return zi.fromMillis(Date.now())},zi.fromDate=function(t){return zi.fromMillis(t.getTime())},zi.fromMillis=function(t){var e=Math.floor(t/1e3);return new zi(e,1e6*(t-1e3*e))},zi.prototype.toDate=function(){return new Date(this.toMillis())},zi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},zi.prototype.g=function(t){return this.seconds===t.seconds?ba(this.nanoseconds,t.nanoseconds):ba(this.seconds,t.seconds)},zi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},zi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},zi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},zi),Hi=(Qi.v=function(t){return new Qi(t)},Qi.S=function(){return Qi.MIN},Qi.prototype.C=function(t){return this.timestamp.g(t.timestamp)},Qi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Qi.prototype.D=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Qi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Qi.prototype.F=function(){return this.timestamp},Qi);function Qi(t){this.timestamp=t}function zi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new qi(Mi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new qi(Mi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qi(Mi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new qi(Mi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Yi(t,e){this.P=t,this.V=e}function Wi(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=Ci.h}function Xi(t){var e=this;this.m=null,this.currentUser=Ci.UNAUTHENTICATED,this.R=!1,this.I=0,this.u=null,this.forceRefresh=!1,this.m=function(){e.I++,e.currentUser=e.A(),e.R=!0,e.u&&e.u(e.currentUser)},this.I=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.m):(this.m(null),t.get().then(function(t){e.auth=t,e.m&&e.auth.addAuthTokenListener(e.m)},function(){}))}function Ji(){this.u=null}function Ki(t,e){var n=this;return(n=Pi.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Hi.MIN=new Hi(new Bi(0,0));var Zi,$i=(Object.defineProperty(nr.prototype,"length",{get:function(){return this.N},enumerable:!0,configurable:!0}),nr.prototype.isEqual=function(t){return 0===nr.k(this,t)},nr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof nr?t.forEach(function(t){e.push(t)}):e.push(t),this.L(e)},nr.prototype.limit=function(){return this.offset+this.length},nr.prototype.$=function(t){return t=void 0===t?1:t,this.L(this.segments,this.offset+t,this.length-t)},nr.prototype.O=function(){return this.L(this.segments,this.offset,this.length-1)},nr.prototype.M=function(){return this.segments[this.offset]},nr.prototype.U=function(){return this.get(this.length-1)},nr.prototype.get=function(t){return this.segments[this.offset+t]},nr.prototype.q=function(){return 0===this.length},nr.prototype.B=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},nr.prototype.W=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},nr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},nr.prototype.j=function(){return this.segments.slice(this.offset,this.limit())},nr.k=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},nr),tr=(n(er,Zi=$i),er.prototype.L=function(t,e,n){return new er(t,e,n)},er.prototype.G=function(){return this.j().join("/")},er.prototype.toString=function(){return this.G()},er.K=function(t){if(0<=t.indexOf("//"))throw new qi(Mi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new er(t.split("/").filter(function(t){return 0<t.length}))},er);function er(){return null!==Zi&&Zi.apply(this,arguments)||this}function nr(t,e,n){void 0===e?e=0:e>t.length&&va("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&va("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.N=n}tr.H=new tr([]);var ir,rr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,or=(n(sr,ir=$i),sr.prototype.L=function(t,e,n){return new sr(t,e,n)},sr.J=function(t){return rr.test(t)},sr.prototype.G=function(){return this.j().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),sr.J(t)||(t="`"+t+"`"),t}).join(".")},sr.prototype.toString=function(){return this.G()},sr.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},sr.X=function(){return new sr(["__name__"])},sr.Z=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new qi(Mi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new qi(Mi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new qi(Mi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new qi(Mi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new sr(e)},sr);function sr(){return null!==ir&&ir.apply(this,arguments)||this}or.H=new or([]);var ar=(ur.tt=function(t){return new ur(tr.K(t).$(5))},ur.prototype.et=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ur.prototype.isEqual=function(t){return null!==t&&0===tr.k(this.path,t.path)},ur.prototype.toString=function(){return this.path.toString()},ur.k=function(t,e){return tr.k(t.path,e.path)},ur.st=function(t){return t.length%2==0},ur.it=function(t){return new ur(new tr(t.slice()))},ur);function ur(t){this.path=t}ar.EMPTY=new ar(new tr([]));var hr=(dr.prototype.nt=function(t,e){return new dr(this.k,this.root.nt(t,e,this.k).rt(null,null,lr.ht,null,null))},dr.prototype.remove=function(t){return new dr(this.k,this.root.remove(t,this.k).rt(null,null,lr.ht,null,null))},dr.prototype.get=function(t){for(var e=this.root;!e.q();){var n=this.k(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},dr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.q();){var i=this.k(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},dr.prototype.q=function(){return this.root.q()},Object.defineProperty(dr.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),dr.prototype.ot=function(){return this.root.ot()},dr.prototype.at=function(){return this.root.at()},dr.prototype.ut=function(t){return this.root.ut(t)},dr.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},dr.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},dr.prototype.ct=function(t){return this.root.ct(t)},dr.prototype.lt=function(){return new cr(this.root,null,this.k,!1)},dr.prototype._t=function(t){return new cr(this.root,t,this.k,!1)},dr.prototype.dt=function(){return new cr(this.root,null,this.k,!0)},dr.prototype.ft=function(t){return new cr(this.root,t,this.k,!0)},dr),cr=(pr.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.q();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.q();)this.Tt.push(t),t=t.left;return e},pr.prototype.Rt=function(){return 0<this.Tt.length},pr.prototype.It=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},pr),lr=(fr.prototype.rt=function(t,e,n,i,r){return new fr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},fr.prototype.q=function(){return!1},fr.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},fr.prototype.ct=function(t){return this.right.ct(t)||t(this.key,this.value)||this.left.ct(t)},fr.prototype.min=function(){return this.left.q()?this:this.left.min()},fr.prototype.ot=function(){return this.min().key},fr.prototype.at=function(){return this.right.q()?this.key:this.right.at()},fr.prototype.nt=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.rt(null,null,null,i.left.nt(t,e,n),null):0===r?i.rt(null,e,null,null,null):i.rt(null,null,null,null,i.right.nt(t,e,n))).At()},fr.prototype.Pt=function(){if(this.left.q())return fr.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.pt()),(t=t.rt(null,null,null,t.left.Pt(),null)).At()},fr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.q()||i.left.Vt()||i.left.left.Vt()||(i=i.pt()),i=i.rt(null,null,null,i.left.remove(t,e),null);else{if(i.left.Vt()&&(i=i.gt()),i.right.q()||i.right.Vt()||i.right.left.Vt()||(i=i.yt()),0===e(t,i.key)){if(i.right.q())return fr.EMPTY;n=i.right.min(),i=i.rt(n.key,n.value,null,null,i.right.Pt())}i=i.rt(null,null,null,null,i.right.remove(t,e))}return i.At()},fr.prototype.Vt=function(){return this.color},fr.prototype.At=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.left.left.Vt()&&(t=t.gt()),t.left.Vt()&&t.right.Vt()&&(t=t.vt()),t},fr.prototype.pt=function(){var t=this.vt();return t.right.left.Vt()&&(t=(t=(t=t.rt(null,null,null,null,t.right.gt())).bt()).vt()),t},fr.prototype.yt=function(){var t=this.vt();return t.left.left.Vt()&&(t=(t=t.gt()).vt()),t},fr.prototype.bt=function(){var t=this.rt(null,null,fr.RED,null,this.right.left);return this.right.rt(null,null,this.color,t,null)},fr.prototype.gt=function(){var t=this.rt(null,null,fr.RED,this.left.right,null);return this.left.rt(null,null,this.color,null,t)},fr.prototype.vt=function(){var t=this.left.rt(null,null,!this.left.color,null,null),e=this.right.rt(null,null,!this.right.color,null,null);return this.rt(null,null,!this.color,t,e)},fr.prototype.St=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},fr.prototype.Ct=function(){if(this.Vt()&&this.left.Vt())throw va("Red node has red child("+this.key+","+this.value+")");if(this.right.Vt())throw va("Right child of ("+this.key+","+this.value+") is red");var t=this.left.Ct();if(t!==this.right.Ct())throw va("Black depths differ");return t+(this.Vt()?0:1)},fr);function fr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:fr.RED,this.left=null!=i?i:fr.EMPTY,this.right=null!=r?r:fr.EMPTY,this.size=this.left.size+1+this.right.size}function pr(t,e,n,i){this.wt=i,this.Tt=[];for(var r=1;!t.q();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.wt?t.left:t.right;else{if(0===r){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function dr(t,e){this.k=t,this.root=e||lr.EMPTY}function yr(){this.size=0}lr.EMPTY=null,lr.RED=!0,lr.ht=!1,lr.EMPTY=(Object.defineProperty(yr.prototype,"key",{get:function(){throw va("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"value",{get:function(){throw va("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"color",{get:function(){throw va("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"left",{get:function(){throw va("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"right",{get:function(){throw va("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),yr.prototype.rt=function(t,e,n,i,r){return this},yr.prototype.nt=function(t,e,n){return new lr(t,e)},yr.prototype.remove=function(t,e){return this},yr.prototype.q=function(){return!0},yr.prototype.ut=function(t){return!1},yr.prototype.ct=function(t){return!1},yr.prototype.ot=function(){return null},yr.prototype.at=function(){return null},yr.prototype.Vt=function(){return!1},yr.prototype.St=function(){return!0},yr.prototype.Ct=function(){return 0},new yr);var vr=(wr.prototype.has=function(t){return null!==this.data.get(t)},wr.prototype.first=function(){return this.data.ot()},wr.prototype.last=function(){return this.data.at()},Object.defineProperty(wr.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),wr.prototype.indexOf=function(t){return this.data.indexOf(t)},wr.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},wr.prototype.Dt=function(t,e){for(var n=this.data._t(t[0]);n.Rt();){var i=n.Et();if(0<=this.k(i.key,t[1]))return;e(i.key)}},wr.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.Rt();)if(!t(n.Et().key))return},wr.prototype.Nt=function(t){var e=this.data._t(t);return e.Rt()?e.Et().key:null},wr.prototype.lt=function(){return new gr(this.data.lt())},wr.prototype._t=function(t){return new gr(this.data._t(t))},wr.prototype.add=function(t){return this.rt(this.data.remove(t).nt(t,!0))},wr.prototype.delete=function(t){return this.has(t)?this.rt(this.data.remove(t)):this},wr.prototype.q=function(){return this.data.q()},wr.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},wr.prototype.isEqual=function(t){if(!(t instanceof wr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.Rt();){var i=e.Et().key,r=n.Et().key;if(0!==this.k(i,r))return!1}return!0},wr.prototype.j=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},wr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},wr.prototype.rt=function(t){var e=new wr(this.k);return e.data=t,e},wr),gr=(mr.prototype.Et=function(){return this.Lt.Et().key},mr.prototype.Rt=function(){return this.Lt.Rt()},mr);function mr(t){this.Lt=t}function wr(t){this.k=t,this.data=new hr(this.k)}function br(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Er(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ar(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ir=(Nr.fromBase64String=function(t){return new Nr(ua.Ot().atob(t))},Nr.fromUint8Array=function(t){return new Nr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Nr.prototype.toBase64=function(){return ua.Ot().btoa(this.$t)},Nr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.$t)},Nr.prototype.Mt=function(){return 2*this.$t.length},Nr.prototype.C=function(t){return ba(this.$t,t.$t)},Nr.prototype.isEqual=function(t){return this.$t===t.$t},Nr);function Nr(t){this.$t=t}function Tr(t){return null==t}function _r(t){return-0===t&&1/t==-1/0}function Sr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function kr(t){var e=Pr(t.mapValue.fields.__local_write_time__.timestampValue);return new Bi(e.seconds,e.nanos)}Ir.Ut=new Ir("");var Rr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Lr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Sr(t)?4:10:va("Invalid value type: "+JSON.stringify(t))}function Dr(r,t){var e,n,i,o=Lr(r);if(o!==Lr(t))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return kr(r).isEqual(kr(t));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Pr(r.timestampValue),n=Pr(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return r.stringValue===t.stringValue;case 6:return i=t,qr(r.bytesValue).isEqual(qr(i.bytesValue));case 7:return r.referenceValue===t.referenceValue;case 8:return n=t,Mr((e=r).geoPointValue.latitude)===Mr(n.geoPointValue.latitude)&&Mr(e.geoPointValue.longitude)===Mr(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Mr(t.integerValue)===Mr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Mr(t.doubleValue),i=Mr(e.doubleValue);return n===i?_r(n)===_r(i):isNaN(n)&&isNaN(i)}return!1}(r,t);case 9:return Ea(r.arrayValue.values||[],t.arrayValue.values||[],Dr);case 10:return function(t){var e=r.mapValue.fields||{},n=t.mapValue.fields||{};if(br(e)!==br(n))return!1;for(var i in e)if(e.hasOwnProperty(i)&&(void 0===n[i]||!Dr(e[i],n[i])))return!1;return!0}(t);default:return va("Unexpected value type: "+JSON.stringify(r))}}function Or(t,e){return void 0!==(t.values||[]).find(function(t){return Dr(t,e)})}function Cr(t,e){var n,i,r,o,s,a,u,h,c,l,f=Lr(t),p=Lr(e);if(f!==p)return ba(f,p);switch(f){case 0:return 0;case 1:return ba(t.booleanValue,e.booleanValue);case 2:return h=e,c=Mr(t.integerValue||t.doubleValue),l=Mr(h.integerValue||h.doubleValue),c<l?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return Vr(t.timestampValue,e.timestampValue);case 4:return Vr(kr(t),kr(e));case 5:return ba(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=qr(o),u=qr(s),a.C(u);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=ba(n[r],i[r]);if(0!==o)return o}return ba(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=ba(Mr(n.latitude),Mr(i.latitude)))?r:ba(Mr(n.longitude),Mr(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=Cr(n[r],i[r]);if(o)return o}return ba(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var a=ba(i[s],o[s]);if(0!==a)return a;var u=Cr(n[i[s]],r[o[s]]);if(0!==u)return u}return ba(i.length,o.length)}(t.mapValue,e.mapValue);default:throw va("Invalid value type: "+f)}}function Vr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ba(t,e);var n=Pr(t),i=Pr(e),r=ba(n.seconds,i.seconds);return 0!==r?r:ba(n.nanos,i.nanos)}function Ur(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=Pr(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?qr(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,ar.tt(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++){e?e=!1:t+=",",t+=s(i[n])}return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):va("Invalid value type: "+JSON.stringify(r));var t,e,n}(t)}function Pr(t){if(ga(!!t,"Cannot normalize null or undefined timestamp."),"string"!=typeof t)return{seconds:Mr(t.seconds),nanos:Mr(t.nanos)};var e=0,n=Rr.exec(t);if(ga(!!n,"invalid timestamp: "+t),n[1]){var i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}function Mr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function qr(t){return"string"==typeof t?Ir.fromBase64String(t):Ir.fromUint8Array(t)}function Fr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.G()}}function Gr(t){return t&&"integerValue"in t}function xr(t){return!!t&&"arrayValue"in t}function jr(t){return t&&"nullValue"in t}function Br(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Hr(t){return t&&"mapValue"in t}var Qr=(zr.prototype.qt=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},zr.prototype.Bt=function(t,e){return e},zr.prototype.xt=function(t){return null},zr.prototype.isEqual=function(t){return t instanceof zr},zr);function zr(){}Qr.instance=new Qr;var Yr=(Zr.prototype.qt=function(t,e){return this.apply(t)},Zr.prototype.Bt=function(t,e){return this.apply(t)},Zr.prototype.apply=function(t){for(var n=$r(t),e=function(e){n.some(function(t){return Dr(t,e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Zr.prototype.xt=function(t){return null},Zr.prototype.isEqual=function(t){return t instanceof Zr&&Ea(this.elements,t.elements,Dr)},Zr),Wr=(Kr.prototype.qt=function(t,e){return this.apply(t)},Kr.prototype.Bt=function(t,e){return this.apply(t)},Kr.prototype.apply=function(t){for(var n=$r(t),e=function(e){n=n.filter(function(t){return!Dr(t,e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Kr.prototype.xt=function(t){return null},Kr.prototype.isEqual=function(t){return t instanceof Kr&&Ea(this.elements,t.elements,Dr)},Kr),Xr=(Jr.prototype.qt=function(t,e){var n=this.xt(t),i=this.asNumber(n)+this.asNumber(this.Qt);return Gr(n)&&Gr(this.Qt)?this.serializer.Wt(i):this.serializer.jt(i)},Jr.prototype.Bt=function(t,e){return e},Jr.prototype.xt=function(t){return Gr(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Jr.prototype.isEqual=function(t){return t instanceof Jr&&Dr(this.Qt,t.Qt)},Jr.prototype.asNumber=function(t){return Mr(t.integerValue||t.doubleValue)},Jr);function Jr(t,e){this.serializer=t,this.Qt=e}function Kr(t){this.elements=t}function Zr(t){this.elements=t}function $r(t){return xr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function to(t,e){this.version=t,this.transformResults=e}var eo=(so.Gt=function(t){return new so(t)},so.zt=function(t){var e=new vr(or.k);return t.forEach(function(t){return e=e.add(t)}),new so(e)},so.prototype.Kt=function(e){var n=!1;return this.fields.forEach(function(t){t.B(e)&&(n=!0)}),n},so.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},so),no=(oo.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},oo),io=(ro.exists=function(t){return new ro(void 0,t)},ro.updateTime=function(t){return new ro(t)},Object.defineProperty(ro.prototype,"Ht",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),ro.prototype.Jt=function(t){return void 0!==this.updateTime?t instanceof Oo&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof Oo},ro.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ro);function ro(t,e){this.updateTime=t,this.exists=e}function oo(t,e){this.field=t,this.transform=e}function so(t){this.fields=t}io.NONE=new io;var ao,uo,ho,co,lo,fo=(_o.prototype.Yt=function(t){},_o.Xt=function(t){return t instanceof Oo?t.version:Hi.MIN},_o),po=(n(To,lo=fo),To.prototype.Bt=function(t,e){this.Yt(t);var n=e.version;return new Oo(this.key,n,this.value,{hasCommittedMutations:!0})},To.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=fo.Xt(t);return new Oo(this.key,i,this.value,{te:!0})},To.prototype.ee=function(t){return null},To.prototype.isEqual=function(t){return t instanceof To&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Zt.isEqual(t.Zt)},To),yo=(n(No,co=fo),No.prototype.Bt=function(t,e){if(this.Yt(t),!this.Zt.Jt(t))return new Vo(this.key,e.version);var n=this.ie(t);return new Oo(this.key,e.version,n,{hasCommittedMutations:!0})},No.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=fo.Xt(t),r=this.ie(t);return new Oo(this.key,i,r,{te:!0})},No.prototype.ee=function(t){return null},No.prototype.isEqual=function(t){return t instanceof No&&this.key.isEqual(t.key)&&this.se.isEqual(t.se)&&this.Zt.isEqual(t.Zt)},No.prototype.ie=function(t){var e;return e=t instanceof Oo?t.data():wo.EMPTY,this.ne(e)},No.prototype.ne=function(t){var n=this,i=t.re();return this.se.fields.forEach(function(t){if(!t.q()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.he()},No),vo=(n(Io,ho=fo),Io.prototype.Bt=function(t,e){if(this.Yt(t),ga(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.Zt.Jt(t))return new Vo(this.key,e.version);var n=this.oe(t),i=this.ae(t,e.transformResults),r=e.version,o=this.ue(n.data(),i);return new Oo(this.key,r,o,{hasCommittedMutations:!0})},Io.prototype.qt=function(t,e,n){if(this.Yt(t),!this.Zt.Jt(t))return t;var i=this.oe(t),r=this.ce(n,t,e),o=this.ue(i.data(),r);return new Oo(this.key,i.version,o,{te:!0})},Io.prototype.ee=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Oo?t.field(r.field):void 0,s=r.transform.xt(o||null);null!=s&&(e=null==e?wo.le().set(r.field,s):e.set(r.field,s))}return e?e.he():null},Io.prototype.isEqual=function(t){return t instanceof Io&&this.key.isEqual(t.key)&&Ea(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Zt.isEqual(t.Zt)},Io.prototype.oe=function(t){return t},Io.prototype.ae=function(t,e){var n=[];ga(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof Oo&&(s=t.field(r.field)),n.push(o.Bt(s,e[i]))}return n},Io.prototype.ce=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],a=s.transform,u=null;e instanceof Oo&&(u=e.field(s.field)),null===u&&n instanceof Oo&&(u=n.field(s.field)),i.push(a.qt(u,t))}return i},Io.prototype.ue=function(t,e){for(var n=t.re(),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.he()},Io),go=(n(Ao,uo=fo),Ao.prototype.Bt=function(t,e){return this.Yt(t),new Co(this.key,e.version,{hasCommittedMutations:!0})},Ao.prototype.qt=function(t,e,n){return this.Yt(t),this.Zt.Jt(t)?new Co(this.key,Hi.S()):t},Ao.prototype.ee=function(t){return null},Ao.prototype.isEqual=function(t){return t instanceof Ao&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},Ao),mo=(n(Eo,ao=fo),Eo.prototype.Bt=function(t,e){va("VerifyMutation should only be used in Transactions.")},Eo.prototype.qt=function(t,e,n){va("VerifyMutation should only be used in Transactions.")},Eo.prototype.ee=function(t){va("VerifyMutation should only be used in Transactions.")},Eo.prototype.isEqual=function(t){return t instanceof Eo&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},Eo),wo=(bo.le=function(){return bo.EMPTY.re()},bo.prototype.field=function(t){if(t.q())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Hr(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.U()])||null},bo.prototype.se=function(){return this._e(this.proto.mapValue)},bo.prototype._e=function(t){var r=this,o=new vr(or.k);return Er(t.fields||{},function(t,e){var n=new or([t]);if(10===Lr(e)){var i=r._e(e.mapValue).fields;i.q()?o=o.add(n):i.forEach(function(t){o=o.add(n.child(t))})}else o=o.add(n)}),eo.Gt(o)},bo.prototype.isEqual=function(t){return Dr(this.proto,t.proto)},bo.prototype.re=function(){return new Lo(this)},bo);function bo(t){this.proto=t}function Eo(t,e){var n=this;return(n=ao.call(this)||this).key=t,n.Zt=e,n.type=4,n}function Ao(t,e){var n=this;return(n=uo.call(this)||this).key=t,n.Zt=e,n.type=3,n}function Io(t,e){var n=this;return(n=ho.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Zt=io.exists(!0),n}function No(t,e,n,i){var r=this;return(r=co.call(this)||this).key=t,r.data=e,r.se=n,r.Zt=i,r.type=1,r}function To(t,e,n){var i=this;return(i=lo.call(this)||this).key=t,i.value=e,i.Zt=n,i.type=0,i}function _o(){}wo.EMPTY=new wo({mapValue:{}});var So,ko,Ro,Lo=(Qo.prototype.set=function(t,e){return this.we(t,e),this},Qo.prototype.delete=function(t){return this.we(t,null),this},Qo.prototype.we=function(t,e){for(var n=this.fe,i=0;i<t.length-1;++i){var r=t.get(i),o=n.get(r);o instanceof Map||(o=o&&10===Lr(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),n=o}n.set(t.U(),e)},Qo.prototype.he=function(){var t=this.Te(or.H,this.fe);return null!=t?new wo(t):this.de},Qo.prototype.Te=function(i,t){var r=this,o=!1,e=this.de.field(i),s=Hr(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=r.Te(i.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Qo),Do=(Ho.me=function(t,e){return ar.k(t.key,e.key)},Ho),Oo=(n(Bo,Ro=Do),Bo.prototype.field=function(t){return this.Ee.field(t)},Bo.prototype.data=function(){return this.Ee},Bo.prototype.Re=function(){return this.Ee.proto},Bo.prototype.isEqual=function(t){return t instanceof Bo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.te===t.te&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ee.isEqual(t.Ee)},Bo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ee.toString()+", {hasLocalMutations: "+this.te+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Bo.prototype,"hasPendingWrites",{get:function(){return this.te||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Bo.Ie=function(t,e,n){var i=e.field(t),r=n.field(t);return null!==i&&null!==r?Cr(i,r):va("Trying to compare documents on fields that don't exist")},Bo),Co=(n(jo,ko=Do),jo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(jo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),jo.prototype.isEqual=function(t){return t instanceof jo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},jo),Vo=(n(xo,So=Do),xo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(xo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),xo.prototype.isEqual=function(t){return t instanceof xo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},xo),Uo=(Go.prototype.canonicalId=function(){if(null===this.Ae){var t=this.path.G();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),Tr(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Ae=t}return this.Ae},Go.prototype.toString=function(){var t=this.path.G();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),Tr(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Go.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Go.prototype.Pe=function(){return ar.st(this.path)&&null===this.collectionGroup&&0===this.filters.length},Go),Po=(Fo.ve=function(t){return new Fo(t)},Object.defineProperty(Fo.prototype,"orderBy",{get:function(){if(null===this.ge){var t=this.Se(),e=this.Ce();if(null!==t&&null===e)t.Y()?this.ge=[gs]:this.ge=[new vs(t),gs];else{for(var n=!(this.ge=[]),i=0,r=this.Ve;i<r.length;i++){var o=r[i];this.ge.push(o),o.field.Y()&&(n=!0)}if(!n){var s=0<this.Ve.length?this.Ve[this.Ve.length-1].dir:rs.ASCENDING;this.ge.push(s===rs.ASCENDING?gs:ms)}}}return this.ge},enumerable:!0,configurable:!0}),Fo.prototype.De=function(t){var e=this.filters.concat([t]);return new Fo(this.path,this.collectionGroup,this.Ve.slice(),e,this.limit,this.pe,this.startAt,this.endAt)},Fo.prototype.Fe=function(t){var e=this.Ve.concat([t]);return new Fo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},Fo.prototype.Ne=function(t){return new Fo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},Fo.prototype.ke=function(t){return new Fo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},Fo.prototype.Le=function(t){return new Fo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,t,this.endAt)},Fo.prototype.$e=function(t){return new Fo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,t)},Fo.prototype.Oe=function(t){return new Fo(t,null,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},Fo.prototype.Me=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ve.length||1===this.Ve.length&&this.Ve[0].field.Y())},Fo.prototype.canonicalId=function(){return this.Ue().canonicalId()+"|lt:"+this.pe},Fo.prototype.toString=function(){return"Query(target="+this.Ue().toString()+"; limitType="+this.pe+")"},Fo.prototype.isEqual=function(t){return this.Ue().isEqual(t.Ue())&&this.pe===t.pe},Fo.prototype.qe=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},Fo.prototype.matches=function(t){return this.Be(t)&&this.xe(t)&&this.Qe(t)&&this.We(t)},Fo.prototype.je=function(){return!Tr(this.limit)&&"F"===this.pe},Fo.prototype.Ge=function(){return!Tr(this.limit)&&"L"===this.pe},Fo.prototype.Ce=function(){return 0<this.Ve.length?this.Ve[0].field:null},Fo.prototype.Se=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Zo&&n.ze())return n.field}return null},Fo.prototype.Ke=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof Zo&&0<=t.indexOf(i.op))return i.op}return null},Fo.prototype.Pe=function(){return this.Ue().Pe()},Fo.prototype.He=function(){return null!==this.collectionGroup},Fo.prototype.Ue=function(){if(!this.ye)if("F"===this.pe)this.ye=new Uo(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r=i.dir===rs.DESCENDING?rs.ASCENDING:rs.DESCENDING;t.push(new vs(i.field,r))}var o=this.endAt?new ys(this.endAt.position,!this.endAt.before):null,s=this.startAt?new ys(this.startAt.position,!this.startAt.before):null;this.ye=new Uo(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.ye},Fo.prototype.Be=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.et(this.collectionGroup)&&this.path.B(e):ar.st(this.path)?this.path.isEqual(e):this.path.W(e)},Fo.prototype.xe=function(t){for(var e=0,n=this.Ve;e<n.length;e++){var i=n[e];if(!i.field.Y()&&null===t.field(i.field))return!1}return!0},Fo.prototype.Qe=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},Fo.prototype.We=function(t){return!(this.startAt&&!this.startAt.Je(this.orderBy,t)||this.endAt&&this.endAt.Je(this.orderBy,t))},Fo.prototype.be=function(t){},Fo),Mo=(qo.K=function(t){switch(t){case"<":return qo.LESS_THAN;case"<=":return qo.LESS_THAN_OR_EQUAL;case"==":return qo.EQUAL;case">=":return qo.GREATER_THAN_OR_EQUAL;case">":return qo.GREATER_THAN;case"array-contains":return qo.ARRAY_CONTAINS;case"in":return qo.IN;case"array-contains-any":return qo.ARRAY_CONTAINS_ANY;default:return va("Unknown FieldFilter operator: "+t)}},qo.prototype.toString=function(){return this.name},qo.prototype.isEqual=function(t){return this.name===t.name},qo);function qo(t){this.name=t}function Fo(t,e,n,i,r,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.Ve=n,this.filters=i,this.limit=r,this.pe=o,this.startAt=s,this.endAt=a,this.ge=null,this.ye=null,this.startAt&&this.be(this.startAt),this.endAt&&this.be(this.endAt)}function Go(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.Ae=null}function xo(){return null!==So&&So.apply(this,arguments)||this}function jo(t,e,n){var i=this;return(i=ko.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function Bo(t,e,n,i){var r=this;return(r=Ro.call(this,t,e)||this).Ee=n,r.te=!!i.te,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Ho(t,e){this.key=t,this.version=e}function Qo(t){this.de=t,this.fe=new Map}Mo.LESS_THAN=new Mo("<"),Mo.LESS_THAN_OR_EQUAL=new Mo("<="),Mo.EQUAL=new Mo("=="),Mo.GREATER_THAN=new Mo(">"),Mo.GREATER_THAN_OR_EQUAL=new Mo(">="),Mo.ARRAY_CONTAINS=new Mo("array-contains"),Mo.IN=new Mo("in"),Mo.ARRAY_CONTAINS_ANY=new Mo("array-contains-any");var zo,Yo,Wo,Xo,Jo,Ko,Zo=(n(ls,Ko=function(){}),ls.create=function(t,e,n){if(t.Y())return e===Mo.IN?new ts(t,n):new $o(t,e,n);if(jr(n)){if(e!==Mo.EQUAL)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new ls(t,e,n)}if(Br(n)){if(e!==Mo.EQUAL)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new ls(t,e,n)}return e===Mo.ARRAY_CONTAINS?new es(t,n):e===Mo.IN?new ns(t,n):e===Mo.ARRAY_CONTAINS_ANY?new is(t,n):new ls(t,e,n)},ls.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Lr(this.value)===Lr(e)&&this.Ye(Cr(e,this.value))},ls.prototype.Ye=function(t){switch(this.op){case Mo.LESS_THAN:return t<0;case Mo.LESS_THAN_OR_EQUAL:return t<=0;case Mo.EQUAL:return 0===t;case Mo.GREATER_THAN:return 0<t;case Mo.GREATER_THAN_OR_EQUAL:return 0<=t;default:return va("Unknown FieldFilter operator: "+this.op)}},ls.prototype.ze=function(){return 0<=[Mo.LESS_THAN,Mo.LESS_THAN_OR_EQUAL,Mo.GREATER_THAN,Mo.GREATER_THAN_OR_EQUAL].indexOf(this.op)},ls.prototype.canonicalId=function(){return this.field.G()+this.op.toString()+Ur(this.value)},ls.prototype.isEqual=function(t){return t instanceof ls&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&Dr(this.value,t.value)},ls.prototype.toString=function(){return this.field.G()+" "+this.op+" "+Ur(this.value)},ls),$o=(n(cs,Jo=Zo),cs.prototype.matches=function(t){var e=ar.k(t.key,this.key);return this.Ye(e)},cs),ts=(n(hs,Xo=Zo),hs.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},hs),es=(n(us,Wo=Zo),us.prototype.matches=function(t){var e=t.field(this.field);return xr(e)&&Or(e.arrayValue,this.value)},us),ns=(n(as,Yo=Zo),as.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Or(this.value.arrayValue,e)},as),is=(n(ss,zo=Zo),ss.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!xr(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Or(e.value.arrayValue,t)})},ss),rs=(os.prototype.toString=function(){return this.name},os);function os(t){this.name=t}function ss(t,e){return zo.call(this,t,Mo.ARRAY_CONTAINS_ANY,e)||this}function as(t,e){return Yo.call(this,t,Mo.IN,e)||this}function us(t,e){return Wo.call(this,t,Mo.ARRAY_CONTAINS,e)||this}function hs(t,e){var n=this;return(n=Xo.call(this,t,Mo.IN,e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ar.tt(t.referenceValue)}),n}function cs(t,e,n){var i=this;return(i=Jo.call(this,t,e,n)||this).key=ar.tt(n.referenceValue),i}function ls(t,e,n){var i=this;return(i=Ko.call(this)||this).field=t,i.op=e,i.value=n,i}rs.ASCENDING=new rs("asc"),rs.DESCENDING=new rs("desc");function fs(t){this.count=t}var ps,ds,ys=(As.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return Ur(t)}).join(",")},As.prototype.Je=function(t,e){for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i];if(n=r.field.Y()?ar.k(ar.tt(o.referenceValue),e.key):Cr(o,e.field(r.field)),r.dir===rs.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},As.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!Dr(this.position[e],t.position[e]))return!1;return!0},As),vs=(Es.prototype.compare=function(t,e){var n=this.Xe?Oo.me(t,e):Oo.Ie(this.field,t,e);switch(this.dir){case rs.ASCENDING:return n;case rs.DESCENDING:return-1*n;default:return va("Unknown direction: "+this.dir)}},Es.prototype.canonicalId=function(){return this.field.G()+this.dir.toString()},Es.prototype.toString=function(){return this.field.G()+" ("+this.dir+")"},Es.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Es),gs=new vs(or.X(),rs.ASCENDING),ms=new vs(or.X(),rs.DESCENDING),ws=(bs.prototype.es=function(t){return new bs(this.target,this.targetId,this.Ze,t,this.ts,this.lastLimboFreeSnapshotVersion,this.resumeToken)},bs.prototype.ss=function(t,e){return new bs(this.target,this.targetId,this.Ze,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},bs.prototype.ns=function(t){return new bs(this.target,this.targetId,this.Ze,this.sequenceNumber,this.ts,t,this.resumeToken)},bs);function bs(t,e,n,i,r,o,s){void 0===r&&(r=Hi.MIN),void 0===o&&(o=Hi.MIN),void 0===s&&(s=Ir.Ut),this.target=t,this.targetId=e,this.Ze=n,this.sequenceNumber=i,this.ts=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Es(t,e){this.field=t,void 0===e&&(e=rs.ASCENDING),this.dir=e,this.Xe=t.Y()}function As(t,e){this.position=t,this.before=e}function Is(t){switch(t){case Mi.OK:return va("Treated status OK as error");case Mi.CANCELLED:case Mi.UNKNOWN:case Mi.DEADLINE_EXCEEDED:case Mi.RESOURCE_EXHAUSTED:case Mi.INTERNAL:case Mi.UNAVAILABLE:case Mi.UNAUTHENTICATED:return;case Mi.INVALID_ARGUMENT:case Mi.NOT_FOUND:case Mi.ALREADY_EXISTS:case Mi.PERMISSION_DENIED:case Mi.FAILED_PRECONDITION:case Mi.ABORTED:case Mi.OUT_OF_RANGE:case Mi.UNIMPLEMENTED:case Mi.DATA_LOSS:return 1;default:return va("Unknown status code: "+t)}}function Ns(t){if(void 0===t)return da("GRPC error has no .code"),Mi.UNKNOWN;switch(t){case ps.OK:return Mi.OK;case ps.CANCELLED:return Mi.CANCELLED;case ps.UNKNOWN:return Mi.UNKNOWN;case ps.DEADLINE_EXCEEDED:return Mi.DEADLINE_EXCEEDED;case ps.RESOURCE_EXHAUSTED:return Mi.RESOURCE_EXHAUSTED;case ps.INTERNAL:return Mi.INTERNAL;case ps.UNAVAILABLE:return Mi.UNAVAILABLE;case ps.UNAUTHENTICATED:return Mi.UNAUTHENTICATED;case ps.INVALID_ARGUMENT:return Mi.INVALID_ARGUMENT;case ps.NOT_FOUND:return Mi.NOT_FOUND;case ps.ALREADY_EXISTS:return Mi.ALREADY_EXISTS;case ps.PERMISSION_DENIED:return Mi.PERMISSION_DENIED;case ps.FAILED_PRECONDITION:return Mi.FAILED_PRECONDITION;case ps.ABORTED:return Mi.ABORTED;case ps.OUT_OF_RANGE:return Mi.OUT_OF_RANGE;case ps.UNIMPLEMENTED:return Mi.UNIMPLEMENTED;case ps.DATA_LOSS:return Mi.DATA_LOSS;default:return va("Unknown status code: "+t)}}(ds=ps=ps||{})[ds.OK=0]="OK",ds[ds.CANCELLED=1]="CANCELLED",ds[ds.UNKNOWN=2]="UNKNOWN",ds[ds.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ds[ds.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ds[ds.NOT_FOUND=5]="NOT_FOUND",ds[ds.ALREADY_EXISTS=6]="ALREADY_EXISTS",ds[ds.PERMISSION_DENIED=7]="PERMISSION_DENIED",ds[ds.UNAUTHENTICATED=16]="UNAUTHENTICATED",ds[ds.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ds[ds.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ds[ds.ABORTED=10]="ABORTED",ds[ds.OUT_OF_RANGE=11]="OUT_OF_RANGE",ds[ds.UNIMPLEMENTED=12]="UNIMPLEMENTED",ds[ds.INTERNAL=13]="INTERNAL",ds[ds.UNAVAILABLE=14]="UNAVAILABLE",ds[ds.DATA_LOSS=15]="DATA_LOSS";var Ts=new hr(ar.k);function _s(){return Ts}function Ss(){return _s()}var ks=new hr(ar.k);function Rs(){return ks}var Ls=new hr(ar.k);function Ds(){return Ls}var Os=new vr(ar.k);function Cs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Os,i=0,r=t;i<r.length;i++){var o=r[i];n=n.add(o)}return n}var Vs=new vr(ba);function Us(){return Vs}function Ps(t,e,n,i){this.gs=t,this.removedTargetIds=e,this.key=n,this.ys=i}function Ms(t,e){this.targetId=t,this.bs=e}function qs(t,e,n,i){void 0===n&&(n=Ir.Ut),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Fs=(Zs.os=function(t){return new Zs(t.k)},Zs.prototype.has=function(t){return null!=this.rs.get(t)},Zs.prototype.get=function(t){return this.rs.get(t)},Zs.prototype.first=function(){return this.hs.ot()},Zs.prototype.last=function(){return this.hs.at()},Zs.prototype.q=function(){return this.hs.q()},Zs.prototype.indexOf=function(t){var e=this.rs.get(t);return e?this.hs.indexOf(e):-1},Object.defineProperty(Zs.prototype,"size",{get:function(){return this.hs.size},enumerable:!0,configurable:!0}),Zs.prototype.forEach=function(n){this.hs.ut(function(t,e){return n(t),!1})},Zs.prototype.add=function(t){var e=this.delete(t.key);return e.rt(e.rs.nt(t.key,t),e.hs.nt(t,null))},Zs.prototype.delete=function(t){var e=this.get(t);return e?this.rt(this.rs.remove(t),this.hs.remove(e)):this},Zs.prototype.isEqual=function(t){if(!(t instanceof Zs))return!1;if(this.size!==t.size)return!1;for(var e=this.hs.lt(),n=t.hs.lt();e.Rt();){var i=e.Et().key,r=n.Et().key;if(!i.isEqual(r))return!1}return!0},Zs.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Zs.prototype.rt=function(t,e){var n=new Zs;return n.k=this.k,n.rs=t,n.hs=e,n},Zs),Gs=(Ks.prototype.track=function(t){var e=t.doc.key,n=this.as.get(e);!n||0!==t.type&&3===n.type?this.as=this.as.nt(e,t):3===t.type&&1!==n.type?this.as=this.as.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.as=this.as.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.as=this.as.remove(e):1===t.type&&2===n.type?this.as=this.as.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):va("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n))},Ks.prototype.us=function(){var n=[];return this.as.ut(function(t,e){n.push(e)}),n},Ks),xs=(Js.fs=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new Js(t,e,Fs.os(e),r,n,i,!0,!1)},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return!this.ls.q()},enumerable:!0,configurable:!0}),Js.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this._s===t._s&&this.ls.isEqual(t.ls)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.cs.isEqual(t.cs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},Js),js=(Xs.Rs=function(t,e){var n=new Map;return n.set(t,Bs.Is(t,e)),new Xs(Hi.MIN,n,Us(),_s(),Cs())},Xs),Bs=(Ws.Is=function(t,e){return new Ws(Ir.Ut,e,Cs(),Cs(),Cs())},Ws),Hs=(Object.defineProperty(Ys.prototype,"As",{get:function(){return this.Ds},enumerable:!0,configurable:!0}),Object.defineProperty(Ys.prototype,"resumeToken",{get:function(){return this.Cs},enumerable:!0,configurable:!0}),Object.defineProperty(Ys.prototype,"Ns",{get:function(){return 0!==this.vs},enumerable:!0,configurable:!0}),Object.defineProperty(Ys.prototype,"ks",{get:function(){return this.Fs},enumerable:!0,configurable:!0}),Ys.prototype.Ls=function(t){0<t.Mt()&&(this.Fs=!0,this.Cs=t)},Ys.prototype.$s=function(){var n=Cs(),i=Cs(),r=Cs();return this.Ss.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:va("Encountered invalid change type: "+e)}}),new Bs(this.Cs,this.Ds,n,i,r)},Ys.prototype.Os=function(){this.Fs=!1,this.Ss=ta()},Ys.prototype.Ms=function(t,e){this.Fs=!0,this.Ss=this.Ss.nt(t,e)},Ys.prototype.Us=function(t){this.Fs=!0,this.Ss=this.Ss.remove(t)},Ys.prototype.qs=function(){this.vs+=1},Ys.prototype.Bs=function(){--this.vs},Ys.prototype.xs=function(){this.Fs=!0,this.Ds=!0},Ys),Qs=(zs.prototype.Ks=function(t){for(var e=0,n=t.gs;e<n.length;e++){var i=n[e];t.ys instanceof Oo?this.Hs(i,t.ys):t.ys instanceof Co&&this.Js(i,t.key,t.ys)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.Js(s,t.key,t.ys)}},zs.prototype.Ys=function(n){var i=this;this.Xs(n,function(t){var e=i.Zs(t);switch(n.state){case 0:i.ti(t)&&e.Ls(n.resumeToken);break;case 1:e.Bs(),e.Ns||e.Os(),e.Ls(n.resumeToken);break;case 2:e.Bs(),e.Ns||i.removeTarget(t);break;case 3:i.ti(t)&&(e.xs(),e.Ls(n.resumeToken));break;case 4:i.ti(t)&&(i.ei(t),e.Ls(n.resumeToken));break;default:va("Unknown target watch change state: "+n.state)}})},zs.prototype.Xs=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ws.forEach(function(t,e){i.ti(e)&&n(e)})},zs.prototype.si=function(t){var e=t.targetId,n=t.bs.count,i=this.ii(e);if(i){var r=i.target;if(r.Pe())if(0===n){var o=new ar(r.path);this.Js(e,o,new Co(o,Hi.S()))}else ga(1===n,"Single document existence filter with count: "+n);else this.ni(e)!==n&&(this.ei(e),this.zs=this.zs.add(e))}},zs.prototype.ri=function(r){var o=this,s=new Map;this.Ws.forEach(function(t,e){var n=o.ii(e);if(n){if(t.As&&n.target.Pe()){var i=new ar(n.target.path);null!==o.js.get(i)||o.hi(e,i)||o.Js(e,i,new Co(i,r))}t.ks&&(s.set(e,t.$s()),t.Os())}});var i=Cs();this.Gs.forEach(function(t,e){var n=!0;e.Ft(function(t){var e=o.ii(t);return!e||2===e.Ze||(n=!1)}),n&&(i=i.add(t))});var t=new js(r,s,this.zs,this.js,i);return this.js=_s(),this.Gs=$s(),this.zs=new vr(ba),t},zs.prototype.Hs=function(t,e){if(this.ti(t)){var n=this.hi(t,e.key)?2:0;this.Zs(t).Ms(e.key,n),this.js=this.js.nt(e.key,e),this.Gs=this.Gs.nt(e.key,this.oi(e.key).add(t))}},zs.prototype.Js=function(t,e,n){if(this.ti(t)){var i=this.Zs(t);this.hi(t,e)?i.Ms(e,1):i.Us(e),this.Gs=this.Gs.nt(e,this.oi(e).delete(t)),n&&(this.js=this.js.nt(e,n))}},zs.prototype.removeTarget=function(t){this.Ws.delete(t)},zs.prototype.ni=function(t){var e=this.Zs(t).$s();return this.Qs.ai(t).size+e.Ps.size-e.ps.size},zs.prototype.qs=function(t){this.Zs(t).qs()},zs.prototype.Zs=function(t){var e=this.Ws.get(t);return e||(e=new Hs,this.Ws.set(t,e)),e},zs.prototype.oi=function(t){var e=this.Gs.get(t);return e||(e=new vr(ba),this.Gs=this.Gs.nt(t,e)),e},zs.prototype.ti=function(t){var e=null!==this.ii(t);return e||pa("WatchChangeAggregator","Detected inactive target",t),e},zs.prototype.ii=function(t){var e=this.Ws.get(t);return e&&e.Ns?null:this.Qs.ui(t)},zs.prototype.ei=function(e){var n=this;this.Ws.set(e,new Hs),this.Qs.ai(e).forEach(function(t){n.Js(e,t,null)})},zs.prototype.hi=function(t,e){return this.Qs.ai(t).has(e)},zs);function zs(t){this.Qs=t,this.Ws=new Map,this.js=_s(),this.Gs=$s(),this.zs=new vr(ba)}function Ys(){this.vs=0,this.Ss=ta(),this.Cs=Ir.Ut,this.Ds=!1,this.Fs=!0}function Ws(t,e,n,i,r){this.resumeToken=t,this.As=e,this.Ps=n,this.Vs=i,this.ps=r}function Xs(t,e,n,i,r){this.ts=t,this.ws=e,this.Ts=n,this.ms=i,this.Es=r}function Js(t,e,n,i,r,o,s,a){this.query=t,this.docs=e,this.cs=n,this.docChanges=i,this.ls=r,this.fromCache=o,this._s=s,this.ds=a}function Ks(){this.as=new hr(ar.k)}function Zs(n){this.k=n?function(t,e){return n(t,e)||ar.k(t.key,e.key)}:function(t,e){return ar.k(t.key,e.key)},this.rs=Rs(),this.hs=new hr(this.k)}function $s(){return new hr(ar.k)}function ta(){return new hr(ar.k)}var ea,na,ia=((na={})[rs.ASCENDING.name]="ASCENDING",na[rs.DESCENDING.name]="DESCENDING",na),ra=((ea={})[Mo.LESS_THAN.name]="LESS_THAN",ea[Mo.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",ea[Mo.GREATER_THAN.name]="GREATER_THAN",ea[Mo.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",ea[Mo.EQUAL.name]="EQUAL",ea[Mo.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",ea[Mo.IN.name]="IN",ea[Mo.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",ea),oa=(sa.prototype.li=function(t){var e=void 0===t.code?Mi.UNKNOWN:Ns(t.code);return new qi(e,t.message||"")},sa.prototype._i=function(t){return this.options.di||Tr(t)?t:{value:t}},sa.prototype.fi=function(t){var e;return Tr(e="object"==typeof t?t.value:t)?null:e},sa.prototype.Wt=function(t){return{integerValue:""+t}},sa.prototype.jt=function(t){if(this.options.di){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_r(t)?"-0":t}},sa.prototype.wi=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!_r(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.Wt(t):this.jt(t);var e},sa.prototype.F=function(t){return this.options.di?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},sa.prototype.v=function(t){var e=Pr(t);return new Bi(e.seconds,e.nanos)},sa.prototype.Ti=function(t){return this.options.di?t.toBase64():t.toUint8Array()},sa.prototype.mi=function(t){return this.options.di?(ga(void 0===t||"string"==typeof t,"value must be undefined or a string when using proto3 Json"),Ir.fromBase64String(t||"")):(ga(void 0===t||t instanceof Uint8Array,"value must be undefined or Uint8Array"),Ir.fromUint8Array(t||new Uint8Array))},sa.prototype.toVersion=function(t){return this.F(t.F())},sa.prototype.fromVersion=function(t){return ga(!!t,"Trying to deserialize version that isn't set"),Hi.v(this.v(t))},sa.prototype.Ei=function(t,e){return this.Ri(e||this.ci).child("documents").child(t).G()},sa.prototype.Ii=function(t){var e=tr.K(t);return ga(aa(e),"Tried to deserialize invalid key "+e.toString()),e},sa.prototype.Ai=function(t){return this.Ei(t.path)},sa.prototype.tt=function(t){var e=this.Ii(t);return ga(e.get(1)===this.ci.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.ci.projectId),ga(!e.get(3)&&!this.ci.database||e.get(3)===this.ci.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.ci.database),new ar(this.Pi(e))},sa.prototype.Vi=function(t){return this.Ei(t)},sa.prototype.pi=function(t){var e=this.Ii(t);return 4===e.length?tr.H:this.Pi(e)},Object.defineProperty(sa.prototype,"gi",{get:function(){return new tr(["projects",this.ci.projectId,"databases",this.ci.database]).G()},enumerable:!0,configurable:!0}),sa.prototype.Ri=function(t){return new tr(["projects",t.projectId,"databases",t.database])},sa.prototype.Pi=function(t){return ga(4<t.length&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.$(5)},sa.prototype.yi=function(t,e){return{name:this.Ai(t),fields:e.proto.mapValue.fields}},sa.prototype.bi=function(t){return{name:this.Ai(t.key),fields:t.Re().mapValue.fields,updateTime:this.F(t.version.F())}},sa.prototype.vi=function(t,e){var n=this.tt(t.name),i=this.fromVersion(t.updateTime),r=new wo({mapValue:{fields:t.fields}});return new Oo(n,i,r,{hasCommittedMutations:!!e})},sa.prototype.Si=function(t){ga(!!t.found,"Tried to deserialize a found document from a missing document."),t.found.name,t.found.updateTime;var e=this.tt(t.found.name),n=this.fromVersion(t.found.updateTime),i=new wo({mapValue:{fields:t.found.fields}});return new Oo(e,n,i,{})},sa.prototype.Ci=function(t){ga(!!t.missing,"Tried to deserialize a missing document from a found document."),ga(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.tt(t.missing),n=this.fromVersion(t.readTime);return new Co(e,n)},sa.prototype.Di=function(t){return"found"in t?this.Si(t):"missing"in t?this.Ci(t):va("invalid batch get response: "+JSON.stringify(t))},sa.prototype.Fi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.Ni(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=this.mi(t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&this.li(o);e=new qs(n,i,r,s||null)}else if("documentChange"in t){t.documentChange;var a=t.documentChange;a.document,a.document.name,a.document.updateTime;var u=this.tt(a.document.name),h=this.fromVersion(a.document.updateTime),c=new wo({mapValue:{fields:a.document.fields}}),l=new Oo(u,h,c,{}),f=a.targetIds||[],p=a.removedTargetIds||[];e=new Ps(f,p,l.key,l)}else if("documentDelete"in t){t.documentDelete;var d=t.documentDelete;d.document;var y=this.tt(d.document),v=d.readTime?this.fromVersion(d.readTime):Hi.S(),g=new Co(y,v),m=d.removedTargetIds||[];e=new Ps([],m,g.key,g)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var b=this.tt(w.document),E=w.removedTargetIds||[];e=new Ps([],E,b,null)}else{if(!("filter"in t))return va("Unknown change type "+JSON.stringify(t));t.filter;var A=t.filter;A.targetId;var I=A.count||0,N=new fs(I),T=A.targetId;e=new Ms(T,N)}return e},sa.prototype.Ni=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:va("Got unexpected TargetChange.state: "+t)},sa.prototype.ki=function(t){if(!("targetChange"in t))return Hi.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Hi.MIN:this.fromVersion(e.readTime)},sa.prototype.Li=function(t){var e,n=this;if(t instanceof po)e={update:this.yi(t.key,t.value)};else if(t instanceof go)e={delete:this.Ai(t.key)};else if(t instanceof yo)e={update:this.yi(t.key,t.data),updateMask:this.$i(t.se)};else if(t instanceof vo)e={transform:{document:this.Ai(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Oi(t)})}};else{if(!(t instanceof mo))return va("Unknown mutation type "+t.type);e={verify:this.Ai(t.key)}}return t.Zt.Ht||(e.currentDocument=this.Mi(t.Zt)),e},sa.prototype.Ui=function(t){var e=this,n=t.currentDocument?this.qi(t.currentDocument):io.NONE;if(t.update){t.update.name;var i=this.tt(t.update.name),r=new wo({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.Bi(t.updateMask);return new yo(i,r,o,n)}return new po(i,r,n)}if(t.delete){var s=this.tt(t.delete);return new go(s,n)}if(t.transform){var a=this.tt(t.transform.document),u=t.transform.fieldTransforms.map(function(t){return e.xi(t)});return ga(!0===n.exists,'Transforms only support precondition "exists == true"'),new vo(a,u)}if(t.verify){var h=this.tt(t.verify);return new mo(h,n)}return va("unknown mutation proto: "+JSON.stringify(t))},sa.prototype.Mi=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:va("Unknown precondition")},sa.prototype.qi=function(t){return void 0!==t.updateTime?io.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?io.exists(t.exists):io.NONE},sa.prototype.Qi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Hi.MIN)&&(n=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new to(n,i)},sa.prototype.Wi=function(t,e){var n=this;return t&&0<t.length?(ga(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.Qi(t,e)})):[]},sa.prototype.Oi=function(t){var e=t.transform;if(e instanceof Qr)return{fieldPath:t.field.G(),setToServerValue:"REQUEST_TIME"};if(e instanceof Yr)return{fieldPath:t.field.G(),appendMissingElements:{values:e.elements}};if(e instanceof Wr)return{fieldPath:t.field.G(),removeAllFromArray:{values:e.elements}};if(e instanceof Xr)return{fieldPath:t.field.G(),increment:e.Qt};throw va("Unknown transform: "+t.transform)},sa.prototype.xi=function(t){var e=null;if("setToServerValue"in t)ga("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),e=Qr.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new Yr(n)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];e=new Wr(i)}else"increment"in t?e=new Xr(this,t.increment):va("Unknown transform proto: "+JSON.stringify(t));var r=or.Z(t.fieldPath);return new no(r,e)},sa.prototype.ji=function(t){return{documents:[this.Vi(t.path)]}},sa.prototype.Gi=function(t){var e=t.documents.length;ga(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return Po.ve(this.pi(n)).Ue()},sa.prototype.zi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Vi(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Vi(n.O()),e.structuredQuery.from=[{collectionId:n.U()}]);var i=this.Ki(t.filters);i&&(e.structuredQuery.where=i);var r=this.Hi(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this._i(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Ji(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Ji(t.endAt)),e},sa.prototype.Yi=function(t){var e=this.pi(t.parent),n=t.structuredQuery,i=n.from?n.from.length:0,r=null;if(0<i){ga(1===i,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?r=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.Xi(n.where));var a=[];n.orderBy&&(a=this.Zi(n.orderBy));var u=null;n.limit&&(u=this.fi(n.limit));var h=null;n.startAt&&(h=this.tn(n.startAt));var c=null;return n.endAt&&(c=this.tn(n.endAt)),new Po(e,r,a,s,u,"F",h,c).Ue()},sa.prototype.en=function(t){var e=this.sn(t.Ze);return null==e?null:{"goog-listen-tags":e}},sa.prototype.sn=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return va("Unrecognized query purpose: "+t)}},sa.prototype.Ue=function(t){var e,n=t.target;return(e=n.Pe()?{documents:this.ji(n)}:{query:this.zi(n)}).targetId=t.targetId,0<t.resumeToken.Mt()&&(e.resumeToken=this.Ti(t.resumeToken)),e},sa.prototype.Ki=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Zo?e.in(t):va("Unrecognized filter: "+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},sa.prototype.Xi=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.nn(t)]:void 0!==t.fieldFilter?[this.rn(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.Xi(t)}).reduce(function(t,e){return t.concat(e)}):va("Unknown filter: "+JSON.stringify(t)):[]},sa.prototype.Hi=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.hn(t)})},sa.prototype.Zi=function(t){var e=this;return t.map(function(t){return e.on(t)})},sa.prototype.Ji=function(t){return{before:t.before,values:t.position}},sa.prototype.tn=function(t){var e=!!t.before,n=t.values||[];return new ys(n,e)},sa.prototype.an=function(t){return ia[t.name]},sa.prototype.un=function(t){switch(t){case"ASCENDING":return rs.ASCENDING;case"DESCENDING":return rs.DESCENDING;default:return}},sa.prototype.cn=function(t){return ra[t.name]},sa.prototype.ln=function(t){switch(t){case"EQUAL":return Mo.EQUAL;case"GREATER_THAN":return Mo.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Mo.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Mo.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Mo.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Mo.ARRAY_CONTAINS;case"IN":return Mo.IN;case"ARRAY_CONTAINS_ANY":return Mo.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return va("Unspecified operator");default:return va("Unknown operator")}},sa.prototype._n=function(t){return{fieldPath:t.G()}},sa.prototype.dn=function(t){return or.Z(t.fieldPath)},sa.prototype.hn=function(t){return{field:this._n(t.field),direction:this.an(t.dir)}},sa.prototype.on=function(t){return new vs(this.dn(t.field),this.un(t.direction))},sa.prototype.rn=function(t){return Zo.create(this.dn(t.fieldFilter.field),this.ln(t.fieldFilter.op),t.fieldFilter.value)},sa.prototype.in=function(t){if(t.op===Mo.EQUAL){if(Br(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NAN"}};if(jr(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this._n(t.field),op:this.cn(t.op),value:t.value}}},sa.prototype.nn=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.dn(t.unaryFilter.field);return Zo.create(e,Mo.EQUAL,{doubleValue:NaN});case"IS_NULL":var n=this.dn(t.unaryFilter.field);return Zo.create(n,Mo.EQUAL,{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return va("Unspecified filter");default:return va("Unknown filter")}},sa.prototype.$i=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.G())}),{fieldPaths:e}},sa.prototype.Bi=function(t){var e=(t.fieldPaths||[]).map(function(t){return or.Z(t)});return eo.zt(e)},sa);function sa(t,e){this.ci=t,this.options=e}function aa(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var ua=(ca.fn=function(t){ca.platform&&va("Platform already defined"),ca.platform=t},ca.Ot=function(){return ca.platform||va("Platform not set"),ca.platform},ca),ha=new l("@firebase/firestore");function ca(){}function la(){return ha.logLevel}function fa(t){ha.logLevel=t}function pa(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ha.logLevel<=a.DEBUG){var i=e.map(ya);ha.debug.apply(ha,r(["Firestore ("+Oi+"): "+t],i))}}function da(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ha.logLevel<=a.ERROR){var i=e.map(ya);ha.error.apply(ha,r(["Firestore ("+Oi+"): "+t],i))}}function ya(t){if("string"==typeof t)return t;var e=ua.Ot();try{return e.wn(t)}catch(e){return t}}function va(t){var e="FIRESTORE ("+Oi+") INTERNAL ASSERTION FAILED: "+t;throw da(e),new Error(e)}function ga(t,e){t||va(e)}var ma=(wa.Tn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},wa);function wa(){}function ba(t,e){return t<e?-1:e<t?1:0}function Ea(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Aa(t,e,n,i,r){this.ci=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Ia=(Object.defineProperty(ja.prototype,"mn",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),ja.prototype.isEqual=function(t){return t instanceof ja&&t.projectId===this.projectId&&t.database===this.database},ja.prototype.C=function(t){return ba(this.projectId,t.projectId)||ba(this.database,t.database)},ja),Na=(xa.prototype.get=function(t){var e=this.En(t),n=this.Rn[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],a=o[1];if(s.isEqual(t))return a}},xa.prototype.has=function(t){return void 0!==this.get(t)},xa.prototype.set=function(t,e){var n=this.En(t),i=this.Rn[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.Rn[n]=[[t,e]]},xa.prototype.delete=function(t){var e=this.En(t),n=this.Rn[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.Rn[e]:n.splice(i,1),!0;return!1},xa.prototype.forEach=function(a){Er(this.Rn,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];a(o,s)}})},xa.prototype.q=function(){return Ar(this.Rn)},xa),Ta=(Ga.prototype.Bt=function(t,e,n){for(var i=n.An,r=0;r<this.mutations.length;r++){var o=this.mutations[r];if(o.key.isEqual(t)){var s=i[r];e=o.Bt(e,s)}}return e},Ga.prototype.qt=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.qt(e,e,this.In))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=u.qt(e,o,this.In))}return e},Ga.prototype.Pn=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.qt(t.key,n.get(t.key));e&&(r=r.nt(t.key,e))}),r},Ga.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Cs())},Ga.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ea(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Ea(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},Ga),_a=(Fa.from=function(t,e,n,i){ga(t.mutations.length===n.length,"Mutations sent "+t.mutations.length+" must equal results received "+n.length);for(var r=Ds(),o=t.mutations,s=0;s<o.length;s++)r=r.nt(o[s].key,n[s].version);return new Fa(t,e,n,i,r)},Fa),Sa=(qa.prototype.q=function(){return this.gn.q()},qa.prototype.vn=function(t,e){var n=new ka(t,e);this.gn=this.gn.add(n),this.yn=this.yn.add(n)},qa.prototype.Sn=function(t,e){var n=this;t.forEach(function(t){return n.vn(t,e)})},qa.prototype.Cn=function(t,e){this.Dn(new ka(t,e))},qa.prototype.Fn=function(t,e){var n=this;t.forEach(function(t){return n.Cn(t,e)})},qa.prototype.Nn=function(t){var e=this,n=ar.EMPTY,i=new ka(n,t),r=new ka(n,t+1),o=[];return this.yn.Dt([i,r],function(t){e.Dn(t),o.push(t.key)}),o},qa.prototype.kn=function(){var e=this;this.gn.forEach(function(t){return e.Dn(t)})},qa.prototype.Dn=function(t){this.gn=this.gn.delete(t),this.yn=this.yn.delete(t)},qa.prototype.Ln=function(t){var e=ar.EMPTY,n=new ka(e,t),i=new ka(e,t+1),r=Cs();return this.yn.Dt([n,i],function(t){r=r.add(t.key)}),r},qa.prototype.$n=function(t){var e=new ka(t,0),n=this.gn.Nt(e);return null!==n&&t.isEqual(n.key)},qa),ka=(Ma.me=function(t,e){return ar.k(t.key,e.key)||ba(t.On,e.On)},Ma.bn=function(t,e){return ba(t.On,e.On)||ar.k(t.key,e.key)},Ma),Ra=(Pa.prototype.catch=function(t){return this.next(void 0,t)},Pa.prototype.next=function(i,r){var o=this;return this.Bn&&va("Called next() or catch() twice for PersistencePromise"),this.Bn=!0,this.qn?this.error?this.xn(r,this.error):this.Qn(i,this.result):new Pa(function(e,n){o.Mn=function(t){o.Qn(i,t).next(e,n)},o.Un=function(t){o.xn(r,t).next(e,n)}})},Pa.prototype.Wn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Pa.prototype.jn=function(t){try{var e=t();return e instanceof Pa?e:Pa.resolve(e)}catch(t){return Pa.reject(t)}},Pa.prototype.Qn=function(t,e){return t?this.jn(function(){return t(e)}):Pa.resolve(e)},Pa.prototype.xn=function(t,e){return t?this.jn(function(){return t(e)}):Pa.reject(e)},Pa.resolve=function(n){return new Pa(function(t,e){t(n)})},Pa.reject=function(n){return new Pa(function(t,e){e(n)})},Pa.Gn=function(t){return new Pa(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},Pa.zn=function(t){for(var n=Pa.resolve(!1),e=function(e){n=n.next(function(t){return t?Pa.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},Pa.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Gn(r)},Pa),La=(Ua.prototype.Yn=function(e,n){var i=this;return this.Hn.Xn(e,n).next(function(t){return i.Zn(e,n,t)})},Ua.prototype.Zn=function(t,i,r){return this.Kn.tr(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].qt(i,t);return t})},Ua.prototype.er=function(t,e,r){var o=Ss();return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].qt(t,e);o=o.nt(t,e)}),o},Ua.prototype.sr=function(e,t){var n=this;return this.Kn.getEntries(e,t).next(function(t){return n.ir(e,t)})},Ua.prototype.ir=function(i,r){var o=this;return this.Hn.nr(i,r).next(function(t){var e=o.er(i,r,t),n=_s();return e.forEach(function(t,e){e=e||new Co(t,Hi.S()),n=n.nt(t,e)}),n})},Ua.prototype.rr=function(t,e,n){return e.Pe()?this.hr(t,e.path):e.He()?this.or(t,e,n):this.ar(t,e,n)},Ua.prototype.hr=function(t,e){return this.Yn(t,new ar(e)).next(function(t){var e=Rs();return t instanceof Oo&&(e=e.nt(t.key,t)),e})},Ua.prototype.or=function(n,i,r){var o=this,s=i.collectionGroup,a=Rs();return this.Jn.ur(n,s).next(function(t){return Ra.forEach(t,function(t){var e=i.Oe(t.child(s));return o.ar(n,e,r).next(function(t){t.forEach(function(t,e){a=a.nt(t,e)})})}).next(function(){return a})})},Ua.prototype.ar=function(e,n,t){var c,l,i=this;return this.Kn.rr(e,n,t).next(function(t){return c=t,i.Hn.cr(e,n)}).next(function(t){return l=t,i.lr(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],a=s.key,u=c.get(a),h=s.qt(u,u,i.In);c=h instanceof Oo?c.nt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},Ua.prototype.lr=function(t,e,n){for(var i=Cs(),r=0,o=e;r<o.length;r++)for(var s=0,a=o[r].mutations;s<a.length;s++){var u=a[s];u instanceof yo&&null===n.get(u.key)&&(i=i.add(u.key))}var h=n;return this.Kn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Oo&&(h=h.nt(t,e))}),h})},Ua),Da=(Va.wr=function(t,e){for(var n=Cs(),i=Cs(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Va(t,e.fromCache,n,i)},Va),Oa=(Ca.prototype.mr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ca.prototype.next=function(){var t=++this.previousValue;return this.Er&&this.Er(t),t},Ca);function Ca(t,e){var n=this;this.previousValue=t,e&&(e.Tr=function(t){return n.mr(t)},this.Er=function(t){return e.Rr(t)})}function Va(t,e,n,i){this.targetId=t,this.fromCache=e,this._r=n,this.dr=i}function Ua(t,e,n){this.Kn=t,this.Hn=e,this.Jn=n}function Pa(t){var e=this;this.Mn=null,this.Un=null,this.result=void 0,this.error=void 0,this.qn=!1,this.Bn=!1,t(function(t){e.qn=!0,e.result=t,e.Mn&&e.Mn(t)},function(t){e.qn=!0,e.error=t,e.Un&&e.Un(t)})}function Ma(t,e){this.key=t,this.On=e}function qa(){this.gn=new vr(ka.me),this.yn=new vr(ka.bn)}function Fa(t,e,n,i,r){this.batch=t,this.Vn=e,this.An=n,this.streamToken=i,this.pn=r}function Ga(t,e,n,i){this.batchId=t,this.In=e,this.baseMutations=n,this.mutations=i}function xa(t){this.En=t,this.Rn={}}function ja(t,e){this.projectId=t,this.database=e||"(default)"}Oa.Ir=-1;function Ba(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ha=(Xa.yr=function(t,e,n,i,r){var o=new Xa(t,e,Date.now()+n,i,r);return o.start(n),o},Xa.prototype.start=function(t){var e=this;this.br=setTimeout(function(){return e.vr()},t)},Xa.prototype.Sr=function(){return this.vr()},Xa.prototype.cancel=function(t){null!==this.br&&(this.clearTimeout(),this.gr.reject(new qi(Mi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Xa.prototype.vr=function(){var e=this;this.Ar.Cr(function(){return null!==e.br?(e.clearTimeout(),e.op().then(function(t){return e.gr.resolve(t)})):Promise.resolve()})},Xa.prototype.clearTimeout=function(){null!==this.br&&(this.pr(this),clearTimeout(this.br),this.br=null)},Xa),Qa=(Object.defineProperty(Wa.prototype,"Or",{get:function(){return this.Fr},enumerable:!0,configurable:!0}),Wa.prototype.Cr=function(t){this.enqueue(t)},Wa.prototype.Mr=function(t){this.Ur(),this.qr(t)},Wa.prototype.Br=function(t){return this.Ur(),this.qr(t)},Wa.prototype.xr=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ur(),this.Fr?[3,2]:(this.Fr=!0,[4,this.Br(e)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Wa.prototype.enqueue=function(t){return this.Ur(),this.Fr?new Promise(function(t){}):this.qr(t)},Wa.prototype.qr=function(t){var e=this,n=this.Dr.then(function(){return e.Lr=!0,t().catch(function(t){throw e.kr=t,e.Lr=!1,da("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.Lr=!1,t})});return this.Dr=n},Wa.prototype.Qr=function(t,e,n){var i=this;this.Ur(),-1<this.$r.indexOf(t)&&(e=0);var r=Ha.yr(this,t,e,n,function(t){return i.Wr(t)});return this.Nr.push(r),r},Wa.prototype.Ur=function(){this.kr&&va("AsyncQueue is already failed: "+(this.kr.stack||this.kr.message))},Wa.prototype.jr=function(){},Wa.prototype.Gr=function(){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Dr];case 1:t.sent(),t.label=2;case 2:if(e!==this.Dr)return[3,0];t.label=3;case 3:return[2]}})})},Wa.prototype.zr=function(t){for(var e=0,n=this.Nr;e<n.length;e++)if(n[e].Pr===t)return!0;return!1},Wa.prototype.Kr=function(i){var r=this;return this.Gr().then(function(){r.Nr.sort(function(t,e){return t.Vr-e.Vr});for(var t=0,e=r.Nr;t<e.length;t++){var n=e[t];if(n.Sr(),"all"!==i&&n.Pr===i)break}return r.Gr()})},Wa.prototype.Hr=function(t){this.$r.push(t)},Wa.prototype.Wr=function(t){var e=this.Nr.indexOf(t);this.Nr.splice(e,1)},Wa),za=(Ya.Zr=function(t){return new Ya(t,Ya.th,Ya.eh)},Ya);function Ya(t,e,n){this.Jr=t,this.Yr=e,this.Xr=n}function Wa(){this.Dr=Promise.resolve(),this.Fr=!1,this.Nr=[],this.kr=null,this.Lr=!1,this.$r=[]}function Xa(t,e,n,i,r){this.Ar=t,this.Pr=e,this.Vr=n,this.op=i,this.pr=r,this.gr=new Ba,this.then=this.gr.promise.then.bind(this.gr.promise),this.catch=this.gr.promise.catch.bind(this.gr.promise),this.gr.promise.catch(function(t){})}za.sh=-1,za.ih=1048576,za.nh=41943040,za.th=10,za.eh=1e3,za.rh=new za(za.nh,za.th,za.eh),za.DISABLED=new za(za.sh,0,0);var Ja=(Ka.prototype.start=function(){return this.Ph()},Ka.prototype.Vh=function(r){return c(this,void 0,void 0,function(){var e,m,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.Hn,m=this.Rh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.Hn.ph(v).next(function(t){return g=t,e=i.persistence.fh(r),m=new La(i.wh,e,i.persistence.Ih()),e.ph(v)}).next(function(t){for(var e=[],n=[],i=Cs(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++){var h=u[a];i=i.add(h.key)}}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.sr(v,i).next(function(t){return{gh:t,yh:e,bh:n}})})})];case 1:return n=t.sent(),[2,(this.Hn=e,this.Rh=m,this.hh.Ah(this.Rh),n)]}})})},Ka.prototype.vh=function(a){var u,h=this,c=Bi.now(),t=a.reduce(function(t,e){return t.add(e.key)},Cs());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Rh.sr(s,t).next(function(t){u=t;for(var e=[],n=0,i=a;n<i.length;n++){var r=i[n],o=r.ee(u.get(r.key));null!=o&&e.push(new yo(r.key,o,o.se(),io.exists(!0)))}return h.Hn.Sh(s,c,e,a)})}).then(function(t){var e=t.Pn(u);return{batchId:t.batchId,Ch:e}})},Ka.prototype.Dh=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return n.Hn.Fh(e,t).next(function(t){return t?n.Rh.sr(e,t):Ra.resolve(null)})})},Ka.prototype.Nh=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.wh.kh({Lh:!0});return r.Hn.Nh(t,i.batch,i.streamToken).next(function(){return r.$h(t,i,n)}).next(function(){return n.apply(t)}).next(function(){return r.Hn.Oh(t)}).next(function(){return r.Rh.sr(t,e)})})},Ka.prototype.Mh=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Hn.Uh(e,t).next(function(t){return ga(null!==t,"Attempt to reject nonexistent batch!"),n=t.keys(),i.Hn.qh(e,t)}).next(function(){return i.Hn.Oh(e)}).next(function(){return i.Rh.sr(e,n)})})},Ka.prototype.Bh=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Hn.Bh(t)})},Ka.prototype.xh=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.Hn.xh(t)})},Ka.prototype.Qh=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.Hn.Qh(t,e)})},Ka.prototype.Wh=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.mh.Wh(t)})},Ka.prototype.jh=function(u){var h=this,c=u.ts,l=this.ah;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.wh.kh({Lh:!0});l=h.ah;var s=[];u.ws.forEach(function(t,e){var n=l.get(e);if(n){s.push(h.mh.Gh(o,t.ps,e).next(function(){return h.mh.zh(o,t.Ps,e)}));var i=t.resumeToken;if(0<i.Mt()){var r=n.ss(i,c).es(o.Kh);l=l.nt(e,r),Ka.Hh(n,r,t)&&s.push(h.mh.Jh(o,r))}}});var a=_s(),n=Cs();if(u.ms.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){u.ms.forEach(function(t,e){var n=i.get(t);e instanceof Co&&e.version.isEqual(Hi.MIN)?(r.Yh(t,c),a=a.nt(t,e)):null==n||0<e.version.C(n.version)||0===e.version.C(n.version)&&n.hasPendingWrites?(r.Xh(e,c),a=a.nt(t,e)):pa("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.Es.has(t)&&s.push(h.persistence.dh.Zh(o,t))})})),!c.isEqual(Hi.MIN)){var t=h.mh.Wh(o).next(function(t){return h.mh.to(o,o.Kh,c)});s.push(t)}return Ra.Gn(s).next(function(){return r.apply(o)}).next(function(){return h.Rh.ir(o,a)})}).then(function(t){return h.ah=l,t})},Ka.Hh=function(t,e,n){return ga(0<e.resumeToken.Mt(),"Attempted to persist target data with no resume token"),0===t.resumeToken.Mt()||e.ts.D()-t.ts.D()>=this.eo||0<n.Ps.size+n.Vs.size+n.ps.size},Ka.prototype.so=function(t){for(var n=this,e=0,i=t;e<i.length;e++){var r=i[e],o=r.targetId;if(this.oh.Sn(r._r,o),this.oh.Fn(r.dr,o),!r.fromCache){var s=this.ah.get(o),a=s.ts,u=s.ns(a);this.ah=this.ah.nt(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return Ra.forEach(t,function(t){return Ra.forEach(t.dr,function(t){return n.persistence.dh.Cn(e,t)})})})},Ka.prototype.io=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Hn.no(t,e)})},Ka.prototype.ro=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Rh.Yn(t,e)})},Ka.prototype.ho=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.mh.oo(e,i).next(function(t){return t?(n=t,Ra.resolve(n)):r.mh.ao(e).next(function(t){return n=new ws(i,t,0,e.Kh),r.mh.uo(e,n).next(function(){return n})})})}).then(function(t){return null===r.ah.get(t.targetId)&&(r.ah=r.ah.nt(t.targetId,t),r.uh.set(i,t.targetId)),t})},Ka.prototype.oo=function(t,e){var n=this.uh.get(e);return void 0!==n?Ra.resolve(this.ah.get(n)):this.mh.oo(t,e)},Ka.prototype.co=function(n,i){var r=this,o=this.ah.get(n),t=i?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",t,function(e){var t=r.oh.Nn(n);return i?Ra.resolve():Ra.forEach(t,function(t){return r.persistence.dh.Cn(e,t)}).next(function(){r.persistence.dh.removeTarget(e,o)})}).then(function(){r.ah=r.ah.remove(n),r.uh.delete(o.target)})},Ka.prototype.lo=function(t,n){var i=this,r=Hi.MIN,o=Cs();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.oo(e,t.Ue()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.mh._o(e,t.targetId).next(function(t){o=t})}).next(function(){return i.hh.rr(e,t,n?r:Hi.MIN,n?o:Cs())}).next(function(t){return{documents:t,do:o}})})},Ka.prototype.fo=function(e){var n=this;return this.persistence.runTransaction("Remote document keys","readonly",function(t){return n.mh._o(t,e)})},Ka.prototype.wo=function(){return this.persistence.wo()},Ka.prototype.To=function(t){this.Hn.mo(t)},Ka.prototype.Eo=function(t){this.persistence.Eo(t)},Ka.prototype.$h=function(t,r,o){var e=this,s=r.batch,n=s.keys(),a=Ra.resolve();return n.forEach(function(i){a=a.next(function(){return o.tr(t,i)}).next(function(t){var e=t,n=r.pn.get(i);ga(null!==n,"ackVersions should contain every doc in the write."),(!e||e.version.C(n)<0)&&(e=s.Bt(i,e,r))&&o.Xh(e,r.Vn)})}),a.next(function(){return e.Hn.qh(t,s)})},Ka.prototype.Ro=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Io(t,n.ah)})},Ka.prototype.Ao=function(e){var n=this,t=this.ah.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly",function(t){return n.mh.ui(t,e).next(function(t){return t?t.target:null})})},Ka.prototype.Po=function(){var i=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return i.wh.Po(t,i.lh)}).then(function(t){var e=t.Vo,n=t.readTime;return i.lh=n,e})},Ka.prototype.Ph=function(){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.wh.po(t)})];case 1:return e.lh=t.sent(),[2]}})})},Ka);function Ka(t,e,n){this.persistence=t,this.hh=e,this.oh=new Sa,this.ah=new hr(ba),this.uh=new Na(function(t){return t.canonicalId()}),this.lh=Hi.MIN,this.persistence.dh._h(this.oh),this.Hn=t.fh(n),this.wh=t.Th(),this.mh=t.Eh(),this.Rh=new La(this.wh,this.Hn,this.persistence.Ih()),this.hh.Ah(this.Rh)}function Za(e){return c(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Mi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return pa("LocalStore","Unexpectedly lost primary lease"),[2]})})}function $a(t,e){if(0!==e.length)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+vu(e.length,"argument")+".")}function tu(t,e,n){if(e.length!==n)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires "+vu(n,"argument")+", but was called with "+vu(e.length,"argument")+".")}function eu(t,e,n){if(e.length<n)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+vu(n,"argument")+", but was called with "+vu(e.length,"argument")+".")}function nu(t,e,n,i){if(e.length<n||e.length>i)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+vu(e.length,"argument")+".")}function iu(t,e,n,i){uu(t,e,yu(n)+" argument",i)}function ru(t,e,n,i){void 0!==i&&iu(t,e,n,i)}function ou(t,e,n,i){uu(t,e,n+" option",i)}function su(t,e,n,i){void 0!==i&&ou(t,e,n,i)}function au(t,e,n,i,u){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=u;r<o.length;r++){var s=o[r];if(s===n)return;i.push(cu(s))}var a=cu(n);throw new qi(Mi.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function uu(t,e,n,i){if(!("object"===e?hu(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=cu(i);throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function hu(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function cu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":va("Unknown wrong type: "+typeof e);if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function lu(t,e,n){if(void 0===n)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+yu(e)+" argument, but it was undefined.")}function fu(n,t,i){Er(t,function(t,e){if(i.indexOf(t)<0)throw new qi(Mi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function pu(t,e,n,i){var r=cu(i);return new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires its "+yu(n)+" argument to be a "+e+", but it was: "+r)}function du(t,e,n){if(n<=0)throw new qi(Mi.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+yu(e)+" argument to be a positive number, but it was: "+n+".")}function yu(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function vu(t,e){return t+" "+e+(1===t?"":"s")}function gu(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new qi(Mi.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}function mu(){if("undefined"==typeof Uint8Array)throw new qi(Mi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function wu(){if(!ua.Ot().yo)throw new qi(Mi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}Ja.eo=3e8;var bu=(Nu.fromBase64String=function(t){tu("Blob.fromBase64String",arguments,1),iu("Blob.fromBase64String","string",1,t),wu();try{return new Nu(Ir.fromBase64String(t))}catch(t){throw new qi(Mi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Nu.fromUint8Array=function(t){if(tu("Blob.fromUint8Array",arguments,1),mu(),!(t instanceof Uint8Array))throw pu("Blob.fromUint8Array","Uint8Array",1,t);return new Nu(Ir.fromUint8Array(t))},Nu.prototype.toBase64=function(){return tu("Blob.toBase64",arguments,0),wu(),this.bo.toBase64()},Nu.prototype.toUint8Array=function(){return tu("Blob.toUint8Array",arguments,0),mu(),this.bo.toUint8Array()},Nu.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Nu.prototype.isEqual=function(t){return this.bo.isEqual(t.bo)},Nu),Eu=gu(bu,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Au=(Iu.documentId=function(){return Iu.So},Iu.prototype.isEqual=function(t){if(!(t instanceof Iu))throw pu("isEqual","FieldPath",1,t);return this.vo.isEqual(t.vo)},Iu);function Iu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new qi(Mi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(iu("FieldPath","string",n,t[n]),0===t[n].length)throw new qi(Mi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.vo=new or(t)}function Nu(t){wu(),this.bo=t}Au.So=new Au(or.X().G());var Tu,_u=new RegExp("[~\\*/\\[\\]]"),Su=(Lu.delete=function(){return $a("FieldValue.delete",arguments),ku.instance},Lu.serverTimestamp=function(){return $a("FieldValue.serverTimestamp",arguments),Ou.instance},Lu.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return eu("FieldValue.arrayUnion",arguments,1),new Mu(t)},Lu.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return eu("FieldValue.arrayRemove",arguments,1),new qu(t)},Lu.increment=function(t){return iu("FieldValue.increment","number",1,t),tu("FieldValue.increment",arguments,1),new Fu(t)},Lu.prototype.isEqual=function(t){return this===t},Lu),ku=(n(Ru,Tu=Su),Ru);function Ru(){return Tu.call(this,"FieldValue.delete")||this}function Lu(t){this.Co=t}ku.instance=new ku;var Du,Ou=(n(Cu,Du=Su),Cu);function Cu(){return Du.call(this,"FieldValue.serverTimestamp")||this}Ou.instance=new Ou;var Vu,Uu,Pu,Mu=(n(Ju,Pu=Su),Ju),qu=(n(Xu,Uu=Su),Xu),Fu=(n(Wu,Vu=Su),Wu),Gu=gu(Su,"Use FieldValue.<field>() instead."),xu=(Object.defineProperty(Yu.prototype,"latitude",{get:function(){return this.No},enumerable:!0,configurable:!0}),Object.defineProperty(Yu.prototype,"longitude",{get:function(){return this.ko},enumerable:!0,configurable:!0}),Yu.prototype.isEqual=function(t){return this.No===t.No&&this.ko===t.ko},Yu.prototype.g=function(t){return ba(this.No,t.No)||ba(this.ko,t.ko)},Yu),ju=/^__.*__$/,Bu=(zu.prototype.Lo=function(t,e){var n=[];return null!==this.se?n.push(new yo(t,this.data,this.se,e)):n.push(new po(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new vo(t,this.fieldTransforms)),n},zu),Hu=(Qu.prototype.Lo=function(t,e){var n=[new yo(t,this.data,this.se,e)];return 0<this.fieldTransforms.length&&n.push(new vo(t,this.fieldTransforms)),n},Qu);function Qu(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function zu(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function Yu(t,e){if(tu("GeoPoint",arguments,2),iu("GeoPoint","number",1,t),iu("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new qi(Mi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new qi(Mi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.No=t,this.ko=e}function Wu(t){var e=this;return(e=Vu.call(this,"FieldValue.increment")||this).Fo=t,e}function Xu(t){var e=this;return(e=Uu.call(this,"FieldValue.arrayRemove")||this).Do=t,e}function Ju(t){var e=this;return(e=Pu.call(this,"FieldValue.arrayUnion")||this).Do=t,e}function Ku(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw va("Unexpected case for UserDataSource: "+t)}}var Zu=(nh.prototype.Uo=function(t){var e=null==this.path?null:this.path.child(t),n=new nh(this.$o,this.methodName,e,!1,this.fieldTransforms,this.se);return n.qo(t),n},nh.prototype.Bo=function(t){var e=null==this.path?null:this.path.child(t),n=new nh(this.$o,this.methodName,e,!1,this.fieldTransforms,this.se);return n.Mo(),n},nh.prototype.xo=function(t){return new nh(this.$o,this.methodName,null,!0,this.fieldTransforms,this.se)},nh.prototype.Qo=function(t){var e=null===this.path||this.path.q()?"":" (found in field "+this.path.toString()+")";return new qi(Mi.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},nh.prototype.contains=function(e){return void 0!==this.se.find(function(t){return e.B(t)})||void 0!==this.fieldTransforms.find(function(t){return e.B(t.field)})},nh.prototype.Mo=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.qo(this.path.get(t))},nh.prototype.qo=function(t){if(0===t.length)throw this.Qo("Document fields must not be empty");if(Ku(this.$o)&&ju.test(t))throw this.Qo('Document fields cannot begin and end with "__"')},nh),$u=function(t,e){this.ci=t,this.key=e},th=(eh.prototype.jo=function(t,e){var n=new Zu(0,t,or.H);rh("Data must be an object, but it was:",n,e);var i=this.Go(e,n);return new Bu(new wo(i),null,n.fieldTransforms)},eh.prototype.zo=function(t,e,n){var i=new Zu(2,t,or.H);rh("Data must be an object, but it was:",i,e);var r,o,s=this.Go(e,i);if(n){for(var a=new vr(or.k),u=0,h=n;u<h.length;u++){var c=h[u],l=void 0;if(c instanceof Au)l=c.vo;else{if("string"!=typeof c)throw va("Expected stringOrFieldPath to be a string or a FieldPath");l=sh(t,c)}if(!i.contains(l))throw new qi(Mi.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");a=a.add(l)}r=eo.Gt(a),o=i.fieldTransforms.filter(function(t){return r.Kt(t.field)})}else r=eo.zt(i.se),o=i.fieldTransforms;return new Bu(new wo(s),r,o)},eh.prototype.Ko=function(o,t){var s=this,a=new Zu(1,o,or.H);rh("Data must be an object, but it was:",a,t);var u=new vr(or.k),h=wo.le();Er(t,function(t,e){var n=sh(o,t),i=a.Bo(n);if((e=s.Ho(e,i))instanceof ku)u=u.add(n);else{var r=s.Jo(e,i);null!=r&&(u=u.add(n),h.set(n,r))}});var e=eo.Gt(u);return new Hu(h.he(),e,a.fieldTransforms)},eh.prototype.Yo=function(t,e,n,i){var r=new Zu(1,t,or.H),o=[oh(t,e)],s=[n];if(i.length%2!=0)throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var a=0;a<i.length;a+=2)o.push(oh(t,i[a])),s.push(i[a+1]);for(var u=new vr(or.k),h=wo.le(),c=0;c<o.length;++c){var l=o[c],f=r.Bo(l),p=this.Ho(s[c],f);if(p instanceof ku)u=u.add(l);else{var d=this.Jo(p,f);null!=d&&(u=u.add(l),h.set(l,d))}}var y=eo.Gt(u);return new Hu(h.he(),y,r.fieldTransforms)},eh.prototype.Xo=function(t,e,n){void 0===n&&(n=!1);var i=new Zu(n?4:3,t,or.H);return this.Jo(e,i)},eh.prototype.Ho=function(t,e){try{return this.Wo(t)}catch(t){var n=ah(t);throw e.Qo(n)}},eh.prototype.Jo=function(t,e){if(ih(t=this.Ho(t,e)))return rh("Unsupported field value:",e,t),this.Go(t,e);if(t instanceof Su)return this.Zo(t,e),null;if(e.path&&e.se.push(e.path),t instanceof Array){if(e.Oo&&4!==e.$o)throw e.Qo("Nested arrays are not supported");return this.ta(t,e)}return this.ea(t,e)},eh.prototype.Go=function(t,i){var r=this,o={};return Ar(t)?i.path&&0<i.path.length&&i.se.push(i.path):Er(t,function(t,e){var n=r.Jo(e,i.Uo(t));null!=n&&(o[t]=n)}),{mapValue:{fields:o}}},eh.prototype.ta=function(t,e){for(var n=[],i=0,r=0,o=t;r<o.length;r++){var s=o[r],a=this.Jo(s,e.xo(i));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),i++}return{arrayValue:{values:n}}},eh.prototype.Zo=function(t,e){if(!Ku(e.$o))throw e.Qo(t.Co+"() can only be used with update() and set()");if(null===e.path)throw e.Qo(t.Co+"() is not currently supported inside arrays");if(t instanceof ku){if(2!==e.$o)throw 1===e.$o?e.Qo("FieldValue.delete() can only appear at the top level of your update data"):e.Qo("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.se.push(e.path)}else if(t instanceof Ou)e.fieldTransforms.push(new no(e.path,Qr.instance));else if(t instanceof Mu){var n=this.sa(t.Co,t.Do),i=new Yr(n);e.fieldTransforms.push(new no(e.path,i))}else if(t instanceof qu){var r=this.sa(t.Co,t.Do),o=new Wr(r);e.fieldTransforms.push(new no(e.path,o))}else if(t instanceof Fu){var s=this.Xo("FieldValue.increment",t.Fo),a=new Xr(this.serializer,s);e.fieldTransforms.push(new no(e.path,a))}else va("Unknown FieldValue type: "+t)},eh.prototype.ea=function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return this.serializer.wi(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Bi.fromDate(t);return{timestampValue:this.serializer.F(n)}}if(t instanceof Bi){var i=new Bi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:this.serializer.F(i)}}if(t instanceof xu)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof bu)return{bytesValue:this.serializer.Ti(t)};if(t instanceof $u)return{referenceValue:this.serializer.Ei(t.key.path,t.ci)};throw e.Qo("Unsupported field value: "+cu(t))},eh.prototype.sa=function(i,t){var r=this;return t.map(function(t,e){var n=new Zu(3,i,or.H);return r.Jo(t,n.xo(e))})},eh);function eh(t,e){this.serializer=t,this.Wo=e}function nh(t,e,n,i,r,o){this.$o=t,this.methodName=e,this.path=n,this.Oo=i,void 0===r&&this.Mo(),this.Oo=void 0!==i&&i,this.fieldTransforms=r||[],this.se=o||[]}function ih(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Bi||t instanceof xu||t instanceof bu||t instanceof $u||t instanceof Su)}function rh(t,e,n){if(!ih(n)||!hu(n)){var i=cu(n);throw"an object"===i?e.Qo(t+" a custom object"):e.Qo(t+" "+i)}}function oh(t,e){if(e instanceof Au)return e.vo;if("string"==typeof e)return sh(t,e);throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function sh(t,e){try{return function(e){if(0<=e.search(_u))throw new qi(Mi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Au.bind.apply(Au,r([void 0],e.split("."))))}catch(t){throw new qi(Mi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).vo}catch(e){var n=ah(e);throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function ah(t){return t instanceof Error?t.message:t.toString()}function uh(t){this.key=t}function hh(t){this.key=t}function ch(t,e,n){this.query=t,this.targetId=e,this.view=n}function lh(t){this.key=t,this.xc=!1}function fh(){this.yl=null,this.targetId=0,this.bl=[]}var ph,dh,yh,vh=(ic.prototype.reset=function(){this.oa=0},ic.prototype.ca=function(){this.oa=this.ha},ic.prototype.la=function(t){var e=this;this.cancel();var n=Math.floor(this.oa+this._a()),i=Math.max(0,Date.now()-this.ua),r=Math.max(0,n-i);0<this.oa&&pa("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.oa+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.aa=this.ia.Qr(this.Pr,r,function(){return e.ua=Date.now(),t()}),this.oa*=this.ra,this.oa<this.na&&(this.oa=this.na),this.oa>this.ha&&(this.oa=this.ha)},ic.prototype.cancel=function(){null!==this.aa&&(this.aa.cancel(),this.aa=null)},ic.prototype._a=function(){return(Math.random()-.5)*this.oa},ic),gh=(nc.prototype.Ra=function(){return 1===this.state||2===this.state||4===this.state},nc.prototype.Ia=function(){return 2===this.state},nc.prototype.start=function(){3!==this.state?this.auth():this.Aa()},nc.prototype.stop=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Ra()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},nc.prototype.Pa=function(){this.state=0,this.Ea.reset()},nc.prototype.Va=function(){var t=this;this.Ia()&&null===this.ma&&(this.ma=this.ia.Qr(this.da,6e4,function(){return t.pa()}))},nc.prototype.ga=function(t){this.ya(),this.stream.send(t)},nc.prototype.pa=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return this.Ia()?[2,this.close(0)]:[2]})})},nc.prototype.ya=function(){this.ma&&(this.ma.cancel(),this.ma=null)},nc.prototype.close=function(e,n){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ya(),this.Ea.cancel(),this.Ta++,3!==e?this.Ea.reset():n&&n.code===Mi.RESOURCE_EXHAUSTED?(da(n.toString()),da("Using maximum backoff delay to prevent overloading the backend."),this.Ea.ca()):n&&n.code===Mi.UNAUTHENTICATED&&this.wa.l(),null!==this.stream&&(this.ba(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.va(n)];case 1:return t.sent(),[2]}})})},nc.prototype.ba=function(){},nc.prototype.auth=function(){var n=this;this.state=1;var t=this.Sa(this.Ta),e=this.Ta;this.wa.getToken().then(function(t){n.Ta===e&&n.Ca(t)},function(e){t(function(){var t=new qi(Mi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Da(t)})})},nc.prototype.Ca=function(t){var e=this,n=this.Sa(this.Ta);this.stream=this.Fa(t),this.stream.Na(function(){n(function(){return e.state=2,e.listener.Na()})}),this.stream.va(function(t){n(function(){return e.Da(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},nc.prototype.Aa=function(){var t=this;this.state=4,this.Ea.la(function(){return c(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},nc.prototype.Da=function(t){return pa("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},nc.prototype.Sa=function(e){var n=this;return function(t){n.ia.Cr(function(){return n.Ta===e?t():(pa("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},nc),mh=(n(ec,dh=gh),ec.prototype.Fa=function(t){return this.fa.ka("Listen",t)},ec.prototype.onMessage=function(t){this.Ea.reset();var e=this.serializer.Fi(t),n=this.serializer.ki(t);return this.listener.La(e,n)},ec.prototype.$a=function(t){var e={};e.database=this.serializer.gi,e.addTarget=this.serializer.Ue(t);var n=this.serializer.en(t);n&&(e.labels=n),this.ga(e)},ec.prototype.Oa=function(t){var e={};e.database=this.serializer.gi,e.removeTarget=t,this.ga(e)},ec),wh=(n(tc,ph=gh),Object.defineProperty(tc.prototype,"Ua",{get:function(){return this.Ma},enumerable:!0,configurable:!0}),tc.prototype.start=function(){this.Ma=!1,ph.prototype.start.call(this)},tc.prototype.ba=function(){this.Ma&&this.qa([])},tc.prototype.Fa=function(t){return this.fa.ka("Write",t)},tc.prototype.onMessage=function(t){if(ga(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=this.serializer.mi(t.streamToken),this.Ma){this.Ea.reset();var e=this.serializer.Wi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Ba(n,e)}return ga(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.Ma=!0,this.listener.xa()},tc.prototype.Qa=function(){var t={};t.database=this.serializer.gi,this.ga(t)},tc.prototype.qa=function(t){var e=this,n={streamToken:this.serializer.Ti(this.lastStreamToken),writes:t.map(function(t){return e.serializer.Li(t)})};this.ga(n)},tc),bh=($h.prototype.Wa=function(t){return new wh(this.ia,this.fa,this.credentials,this.serializer,t)},$h.prototype.ja=function(t){return new mh(this.ia,this.fa,this.credentials,this.serializer,t)},$h.prototype.commit=function(t){var e=this,n={database:this.serializer.gi,writes:t.map(function(t){return e.serializer.Li(t)})};return this.Ga("Commit",n).then(function(t){return e.serializer.Wi(t.writeResults,t.commitTime)})},$h.prototype.za=function(e){var r=this,t={database:this.serializer.gi,documents:e.map(function(t){return r.serializer.Ai(t)})};return this.Ka("BatchGetDocuments",t).then(function(t){var n=_s();t.forEach(function(t){var e=r.serializer.Di(t);n=n.nt(e.key,e)});var i=[];return e.forEach(function(t){var e=n.get(t);ga(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},$h.prototype.Ga=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.fa.Ga(e,n,t)}).catch(function(t){throw t.code===Mi.UNAUTHENTICATED&&i.credentials.l(),t})},$h.prototype.Ka=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.fa.Ka(e,n,t)}).catch(function(t){throw t.code===Mi.UNAUTHENTICATED&&i.credentials.l(),t})},$h),Eh=(Zh.prototype.za=function(i){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.tu(),0<this.mutations.length)throw new qi(Mi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.Ha.za(i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Co||t instanceof Oo?n.eu(t):va("Document in a transaction was a "+t.constructor.name)}),e)]}})})},Zh.prototype.set=function(t,e){this.write(e.Lo(t,this.Zt(t))),this.Za.add(t)},Zh.prototype.update=function(t,e){try{this.write(e.Lo(t,this.su(t)))}catch(t){this.Xa=t}this.Za.add(t)},Zh.prototype.delete=function(t){this.write([new go(t,this.Zt(t))]),this.Za.add(t)},Zh.prototype.commit=function(){return c(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.tu(),this.Xa)throw this.Xa;return e=this.Ja,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new mo(t,n.Zt(t)))}),[4,this.Ha.commit(this.mutations)];case 1:return t.sent(),this.Ya=!0,[2]}})})},Zh.prototype.eu=function(t){var e;if(t instanceof Oo)e=t.version;else{if(!(t instanceof Co))throw va("Document in a transaction was a "+t.constructor.name);e=Hi.S()}var n=this.Ja.get(t.key);if(null!==n){if(!e.isEqual(n))throw new qi(Mi.ABORTED,"Document version changed between two reads.")}else this.Ja=this.Ja.nt(t.key,e)},Zh.prototype.Zt=function(t){var e=this.Ja.get(t);return!this.Za.has(t)&&e?io.updateTime(e):io.NONE},Zh.prototype.su=function(t){var e=this.Ja.get(t);if(this.Za.has(t)||!e)return io.exists(!0);if(e.isEqual(Hi.S()))throw new qi(Mi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return io.updateTime(e)},Zh.prototype.write=function(t){this.tu(),this.mutations=this.mutations.concat(t)},Zh.prototype.tu=function(){},Zh),Ah=(Kh.prototype.ou=function(){var t=this;0===this.nu&&(this.au("Unknown"),this.ru=this.Ar.Qr("online_state_timeout",1e4,function(){return t.ru=null,t.uu("Backend didn't respond within 10 seconds."),t.au("Offline"),Promise.resolve()}))},Kh.prototype.cu=function(t){"Online"===this.state?this.au("Unknown"):(this.nu++,1<=this.nu&&(this.lu(),this.uu("Connection failed 1 times. Most recent error: "+t.toString()),this.au("Offline")))},Kh.prototype.set=function(t){this.lu(),this.nu=0,"Online"===t&&(this.hu=!1),this.au(t)},Kh.prototype.au=function(t){t!==this.state&&(this.state=t,this.iu(t))},Kh.prototype.uu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.hu?(da(e),this.hu=!1):pa("OnlineStateTracker",e)},Kh.prototype.lu=function(){null!==this.ru&&(this.ru.cancel(),this.ru=null)},Kh),Ih=(Jh.prototype.start=function(){return this.enableNetwork()},Jh.prototype.enableNetwork=function(){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.Eu()?(e=this.gu,[4,this._u.xh()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.Su()?this.Cu():this.Iu.set("Unknown"),[4,this.Du()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Jh.prototype.disableNetwork=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Iu.set("Offline"),[2]}})})},Jh.prototype.Fu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.gu.stop()];case 1:return t.sent(),[4,this.Au.stop()];case 2:return t.sent(),0<this.du.length&&(pa("RemoteStore","Stopping write stream with "+this.du.length+" pending writes"),this.du=[]),this.Nu(),[2]}})})},Jh.prototype.ku=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return pa("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Tu.ku(),this.Iu.set("Unknown"),[2]}})})},Jh.prototype.listen=function(t){this.fu.has(t.targetId)||(this.fu.set(t.targetId,t),this.Su()?this.Cu():this.Au.Ia()&&this.Lu(t))},Jh.prototype.$u=function(t){this.fu.delete(t),this.Au.Ia()&&this.Ou(t),0===this.fu.size&&(this.Au.Ia()?this.Au.Va():this.Eu()&&this.Iu.set("Unknown"))},Jh.prototype.ui=function(t){return this.fu.get(t)||null},Jh.prototype.ai=function(t){return this.Mu.ai(t)},Jh.prototype.Lu=function(t){this.wu.qs(t.targetId),this.Au.$a(t)},Jh.prototype.Ou=function(t){this.wu.qs(t),this.Au.Oa(t)},Jh.prototype.Cu=function(){this.wu=new Qs(this),this.Au.start(),this.Iu.ou()},Jh.prototype.Su=function(){return this.Eu()&&!this.Au.Ra()&&0<this.fu.size},Jh.prototype.Eu=function(){return this.isPrimary&&this.networkEnabled},Jh.prototype.Nu=function(){this.wu=null},Jh.prototype.Pu=function(){return c(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.fu.forEach(function(t,e){n.Lu(t)}),[2]})})},Jh.prototype.Vu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){return this.Nu(),this.Su()?(this.Iu.cu(e),this.Cu()):this.Iu.set("Unknown"),[2]})})},Jh.prototype.pu=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Iu.set("Online"),n instanceof qs&&2===n.state&&n.cause?[2,this.Uu(n)]:(n instanceof Ps?this.wu.Ks(n):n instanceof Ms?this.wu.si(n):this.wu.Ys(n),i.isEqual(Hi.MIN)?[3,4]:[4,this._u.Wh()]);case 1:return e=t.sent(),0<=i.C(e)?[4,this.qu(i)]:[3,3];case 2:t.sent(),t.label=3;case 3:t.label=4;case 4:return[2]}})})},Jh.prototype.qu=function(i){var r=this,t=this.wu.ri(i);return t.ws.forEach(function(t,e){if(0<t.resumeToken.Mt()){var n=r.fu.get(e);n&&r.fu.set(e,n.ss(t.resumeToken,i))}}),t.Ts.forEach(function(t){var e=r.fu.get(t);if(e){r.fu.set(t,e.ss(Ir.Ut,e.ts)),r.Ou(t);var n=new ws(e.target,t,1,e.sequenceNumber);r.Lu(n)}}),this.Mu.jh(t)},Jh.prototype.Uu=function(t){var n=this,i=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(e){r=r.then(function(){return c(n,void 0,void 0,function(){return y(this,function(t){return this.fu.has(e)?[2,(this.fu.delete(e),this.wu.removeTarget(e),this.Mu.Bu(e,i))]:[2]})})})}),r},Jh.prototype.Du=function(){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.xu()?(e=0<this.du.length?this.du[this.du.length-1].batchId:-1,[4,this._u.io(e)]):[3,5];case 1:return null!==(n=t.sent())?[3,2]:(0===this.du.length&&this.gu.Va(),[3,4]);case 2:return this.Qu(n),[4,this.Du()];case 3:t.sent(),t.label=4;case 4:t.label=5;case 5:return this.Wu()&&this.ju(),[2]}})})},Jh.prototype.xu=function(){return this.Eu()&&this.du.length<10},Jh.prototype.Gu=function(){return this.du.length},Jh.prototype.Qu=function(t){this.du.push(t),this.gu.Ia()&&this.gu.Ua&&this.gu.qa(t.mutations)},Jh.prototype.Wu=function(){return this.Eu()&&!this.gu.Ra()&&0<this.du.length},Jh.prototype.ju=function(){this.gu.start()},Jh.prototype.yu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return this.gu.Qa(),[2]})})},Jh.prototype.vu=function(){var i=this;return this._u.Qh(this.gu.lastStreamToken).then(function(){for(var t=0,e=i.du;t<e.length;t++){var n=e[t];i.gu.qa(n.mutations)}}).catch(Za)},Jh.prototype.Ba=function(t,e){var n=this,i=this.du.shift(),r=_a.from(i,t,e,this.gu.lastStreamToken);return this.Mu.zu(r).then(function(){return n.Du()})},Jh.prototype.bu=function(n){return c(this,void 0,void 0,function(){var e=this;return y(this,function(t){return n&&0<this.du.length?[2,(this.gu.Ua?this.Ku(n):this.Hu(n)).then(function(){e.Wu()&&e.ju()})]:[2]})})},Jh.prototype.Hu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){return Is(e.code)?[2,(pa("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.gu.lastStreamToken),this.gu.lastStreamToken=Ir.Ut,this._u.Qh(Ir.Ut).catch(Za))]:[2]})})},Jh.prototype.Ku=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return Is(n=r.code)&&n!==Mi.ABORTED?(e=this.du.shift(),[2,(this.gu.Pa(),this.Mu.Ju(e.batchId,r).then(function(){return i.Du()}))]):[2]})})},Jh.prototype.Yu=function(){return new Eh(this.Ha)},Jh.prototype.Ru=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Fu()];case 1:return t.sent(),this.Iu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Jh.prototype.Xu=function(){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eu()?(pa("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.Ru()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Jh.prototype.Zu=function(e){return c(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Fu()];case 3:t.sent(),this.Iu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Jh),Nh=(Xh.prototype.tc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Xh.prototype.ec=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Xh.prototype.sc=function(){var t={activeTargetIds:this.activeTargetIds.j(),updateTimeMs:Date.now()};return JSON.stringify(t)},Xh),Th=(Wh.prototype.rc=function(t){},Wh.prototype.hc=function(t,e,n){},Wh.prototype.oc=function(t){return this.ic.tc(t),this.nc[t]||"not-current"},Wh.prototype.ac=function(t,e,n){this.nc[t]=e},Wh.prototype.uc=function(t){this.ic.ec(t)},Wh.prototype.cc=function(t){return this.ic.activeTargetIds.has(t)},Wh.prototype.lc=function(t){delete this.nc[t]},Wh.prototype._c=function(){return this.ic.activeTargetIds},Wh.prototype.dc=function(t){return this.ic.activeTargetIds.has(t)},Wh.prototype.start=function(){return this.ic=new Nh,Promise.resolve()},Wh.prototype.Vh=function(t,e,n){},Wh.prototype.fc=function(t){},Wh.prototype.ku=function(){},Wh.prototype.Rr=function(t){},Wh),_h=(Yh.prototype.next=function(){return this.wc+=2,this.wc},Yh.Tc=function(){return new Yh(0)},Yh.mc=function(){return new Yh(-1)},Yh),Sh=(Object.defineProperty(zh.prototype,"Pc",{get:function(){return this.Ec},enumerable:!0,configurable:!0}),zh.prototype.Vc=function(t,e){var a=this,u=e?e.pc:new Gs,h=e?e.Ac:this.Ac,c=e?e.ls:this.ls,l=h,f=!1,p=this.query.je()&&h.size===this.query.limit?h.last():null,d=this.query.Ge()&&h.size===this.query.limit?h.first():null;if(t.ut(function(t,e){var n=h.get(t),i=e instanceof Oo?e:null;i=i&&(a.query.matches(i)?i:null);var r=!!n&&a.ls.has(n.key),o=!!i&&(i.te||a.ls.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(u.track({type:3,doc:i}),s=!0):a.gc(n,i)||(u.track({type:2,doc:i}),s=!0,(p&&0<a.query.qe(i,p)||d&&a.query.qe(i,d)<0)&&(f=!0)):!n&&i?(u.track({type:0,doc:i}),s=!0):n&&!i&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.je()||this.query.Ge())for(;l.size>this.query.limit;){var n=this.query.je()?l.last():l.first();l=l.delete(n.key),c=c.delete(n.key),u.track({type:1,doc:n})}return{Ac:l,pc:u,yc:f,ls:c}},zh.prototype.gc=function(t,e){return t.te&&e.hasCommittedMutations&&!e.te},zh.prototype.bc=function(t,e,n){var o=this,i=this.Ac;this.Ac=t.Ac,this.ls=t.ls;var r=t.pc.us();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.qe(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return va("Unknown ChangeType: "+t)}}var i,r}),this.vc(n);var s=e?this.Sc():[],a=0===this.Ic.size&&this.As?1:0,u=a!==this.Rc;return this.Rc=a,0!==r.length||u?{snapshot:new xs(this.query,t.Ac,i,r,t.ls,0==a,u,!1),Cc:s}:{Cc:s}},zh.prototype.Dc=function(t){return this.As&&"Offline"===t?(this.As=!1,this.bc({Ac:this.Ac,pc:new Gs,ls:this.ls,yc:!1},!1)):{Cc:[]}},zh.prototype.Fc=function(t){return!this.Ec.has(t)&&!!this.Ac.has(t)&&!this.Ac.get(t).te},zh.prototype.vc=function(t){var e=this;t&&(t.Ps.forEach(function(t){return e.Ec=e.Ec.add(t)}),t.Vs.forEach(function(t){}),t.ps.forEach(function(t){return e.Ec=e.Ec.delete(t)}),this.As=t.As)},zh.prototype.Sc=function(){var e=this;if(!this.As)return[];var n=this.Ic;this.Ic=Cs(),this.Ac.forEach(function(t){e.Fc(t.key)&&(e.Ic=e.Ic.add(t.key))});var i=[];return n.forEach(function(t){e.Ic.has(t)||i.push(new hh(t))}),this.Ic.forEach(function(t){n.has(t)||i.push(new uh(t))}),i},zh.prototype.Nc=function(t){this.Ec=t.do,this.Ic=Cs();var e=this.Vc(t.documents);return this.bc(e,!0)},zh.prototype.kc=function(){return xs.fs(this.query,this.Ac,this.ls,0===this.Rc)},zh),kh=(Qh.prototype.Oc=function(){this.Mc()},Qh.prototype.Mc=function(){var t=this;this.Ea.la(function(){return c(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=this.Lc.Yu(),(n=this.Uc(e))&&n.then(function(t){i.Ar.Cr(function(){return e.commit().then(function(){i.gr.resolve(t)}).catch(function(t){i.qc(t)})})}).catch(function(t){i.qc(t)}),[2]})})})},Qh.prototype.Uc=function(t){try{var e=this.updateFunction(t);return!Tr(e)&&e.catch&&e.then?e:(this.gr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.gr.reject(t),null}},Qh.prototype.qc=function(t){var e=this;0<this.$c&&this.Bc(t)?(--this.$c,this.Ar.Cr(function(){return e.Mc(),Promise.resolve()})):this.gr.reject(t)},Qh.prototype.Bc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Is(e)},Qh),Rh=(Object.defineProperty(Hh.prototype,"el",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),Hh.prototype.subscribe=function(t){this.jc=t},Hh.prototype.listen=function(s){return c(this,void 0,void 0,function(){var e,n,i,r,o;return y(this,function(t){switch(t.label){case 0:return this.sl("listen()"),(i=this.Gc.get(s))?(e=i.targetId,this.Qc.oc(e),n=i.view.kc(),[3,4]):[3,1];case 1:return[4,this._u.ho(s.Ue())];case 2:return r=t.sent(),o=this.Qc.oc(r.targetId),e=r.targetId,[4,this.il(s,e,"current"===o)];case 3:n=t.sent(),this.isPrimary&&this.Lc.listen(r),t.label=4;case 4:return[2,(this.jc.La([n]),e)]}})})},Hh.prototype.il=function(a,u,h){return c(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(a,!0)];case 1:return e=t.sent(),n=new Sh(a,e.do),i=n.Vc(e.documents),r=Bs.Is(u,h&&"Offline"!==this.onlineState),o=n.bc(i,!0===this.isPrimary,r),s=new ch(a,u,n),[2,(this.Gc.set(a,s),this.zc.has(u)?this.zc.get(u).push(a):this.zc.set(u,[a]),o.snapshot)]}})})},Hh.prototype.nl=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(i.query,!0)];case 1:return e=t.sent(),n=i.view.Nc(e),[2,(this.isPrimary&&this.rl(i.targetId,n.Cc),n)]}})})},Hh.prototype.$u=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.sl("unlisten()"),e=this.Gc.get(r),1<(n=this.zc.get(e.targetId)).length?[2,(this.zc.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.Gc.delete(r))]:this.isPrimary?(this.Qc.uc(e.targetId),this.Qc.dc(e.targetId)?[3,2]:[4,this._u.co(e.targetId,!1).then(function(){i.Qc.lc(e.targetId),i.Lc.$u(e.targetId),i.hl(e.targetId)}).catch(Za)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.hl(e.targetId),[4,this._u.co(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Hh.prototype.write=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.sl("write()"),[4,this._u.vh(n)];case 1:return e=t.sent(),this.Qc.rc(e.batchId),this.ol(e.batchId,i),[4,this.al(e.Ch)];case 2:return t.sent(),[4,this.Lc.Du()];case 3:return t.sent(),[2]}})})},Hh.prototype.runTransaction=function(t,e,n){new kh(t,this.Lc,e,n).Oc()},Hh.prototype.jh=function(n){return c(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.sl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.jh(n)];case 2:return e=t.sent(),n.ws.forEach(function(t,e){var n=i.Jc.get(e);n&&(ga(t.Ps.size+t.Vs.size+t.ps.size<=1,"Limbo resolution for single document contains multiple changes."),0<t.Ps.size?n.xc=!0:0<t.Vs.size?ga(n.xc,"Received change for limbo target document without add."):0<t.ps.size&&(ga(n.xc,"Received remove for limbo target document without add."),n.xc=!1))}),[4,this.al(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Za(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Hh.prototype.Dc=function(i,t){if(this.isPrimary&&0===t||!this.isPrimary&&1===t){this.sl("applyOnlineStateChange()");var r=[];this.Gc.forEach(function(t,e){var n=e.view.Dc(i);n.snapshot&&r.push(n.snapshot)}),this.jc.ul(i),this.jc.La(r),this.onlineState=i,this.isPrimary&&this.Qc.fc(i)}},Hh.prototype.Bu=function(a,u){return c(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.sl("rejectListens()"),this.Qc.ac(a,"rejected",u),e=this.Jc.get(a),(n=e&&e.key)?(this.Hc=this.Hc.remove(n),this.Jc.delete(a),this.cl(),i=(i=new hr(ar.k)).nt(n,new Co(n,Hi.S())),r=Cs().add(n),o=new js(Hi.MIN,new Map,new vr(ba),i,r),[2,this.jh(o)]):[4,this._u.co(a,!1).then(function(){return s.hl(a,u)}).catch(Za)];case 1:return t.sent(),[2]}})})},Hh.prototype.ll=function(n,i,r){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.sl("applyBatchState()"),[4,this._u.Dh(n)];case 1:return null===(e=t.sent())?[3,6]:"pending"!==i?[3,3]:[4,this.Lc.Du()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===i||"rejected"===i?(this._l(n,r||null),this._u.To(n)):va("Unknown batchState: "+i),t.label=4;case 4:return[4,this.al(e)];case 5:return t.sent(),[3,7];case 6:pa("SyncEngine","Cannot apply mutation batch with id: "+n),t.label=7;case 7:return[2]}})})},Hh.prototype.zu=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.sl("applySuccessfulWrite()"),e=i.batch.batchId,this._l(e,null),this.dl(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.Nh(i)];case 2:return n=t.sent(),this.Qc.hc(e,"acknowledged"),[4,this.al(n)];case 3:return t.sent(),[3,6];case 4:return[4,Za(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Hh.prototype.Ju=function(n,i){return c(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.sl("rejectFailedWrite()"),this._l(n,i),this.dl(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._u.Mh(n)];case 2:return e=t.sent(),this.Qc.hc(n,"rejected",i),[4,this.al(e)];case 3:return t.sent(),[3,6];case 4:return[4,Za(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Hh.prototype.fl=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.Lc.Eu()||pa("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this._u.Bh()];case 1:return-1===(e=t.sent())?[2,void i.resolve()]:((n=this.Zc.get(e)||[]).push(i),this.Zc.set(e,n),[2])}})})},Hh.prototype.dl=function(t){(this.Zc.get(t)||[]).forEach(function(t){t.resolve()}),this.Zc.delete(t)},Hh.prototype.wl=function(e){this.Zc.forEach(function(t){t.forEach(function(t){t.reject(new qi(Mi.CANCELLED,e))})}),this.Zc.clear()},Hh.prototype.ol=function(t,e){var n=this.Xc[this.currentUser.s()];n=(n=n||new hr(ba)).nt(t,e),this.Xc[this.currentUser.s()]=n},Hh.prototype._l=function(t,e){var n=this.Xc[this.currentUser.s()];if(n){var i=n.get(t);i&&(e?i.reject(e):i.resolve(),n=n.remove(t)),this.Xc[this.currentUser.s()]=n}},Hh.prototype.hl=function(t,e){var n=this;void 0===e&&(e=null),this.Qc.uc(t);for(var i=0,r=this.zc.get(t);i<r.length;i++){var o=r[i];this.Gc.delete(o),e&&this.jc.Tl(o,e)}if(this.zc.delete(t),this.isPrimary){var s=this.Yc.Ln(t);this.Yc.Nn(t),s.forEach(function(t){n.Yc.$n(t)||n.ml(t)})}},Hh.prototype.ml=function(t){var e=this.Hc.get(t);null!==e&&(this.Lc.$u(e),this.Hc=this.Hc.remove(t),this.Jc.delete(e),this.cl())},Hh.prototype.rl=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof uh?(this.Yc.vn(r.key,t),this.El(r)):r instanceof hh?(pa("SyncEngine","Document no longer in limbo: "+r.key),this.Yc.Cn(r.key,t),this.Yc.$n(r.key)||this.ml(r.key)):va("Unknown limbo change: "+JSON.stringify(r))}},Hh.prototype.El=function(t){var e=t.key;this.Hc.get(e)||(pa("SyncEngine","New document in limbo: "+e),this.Kc.push(e),this.cl())},Hh.prototype.cl=function(){for(;0<this.Kc.length&&this.Hc.size<this.Wc;){var t=this.Kc.shift(),e=this.tl.next();this.Jc.set(e,new lh(t)),this.Hc=this.Hc.nt(t,e),this.Lc.listen(new ws(Po.ve(t.path).Ue(),e,2,Oa.Ir))}},Hh.prototype.Rl=function(){return this.Hc},Hh.prototype.Il=function(){return this.Kc},Hh.prototype.al=function(i,u){return c(this,void 0,void 0,function(){var o,s,e,a=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Gc.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.Vc(i);return n.yc?a._u.lo(r.query,!1).then(function(t){var e=t.documents;return r.view.Vc(e,n)}):n}).then(function(t){var e=u&&u.ws.get(r.targetId),n=r.view.bc(t,!0===a.isPrimary,e);if(a.rl(r.targetId,n.Cc),n.snapshot){a.isPrimary&&a.Qc.ac(r.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var i=Da.wr(r.targetId,n.snapshot);s.push(i)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.jc.La(o),[4,this._u.so(s)];case 2:return t.sent(),[2]}})})},Hh.prototype.sl=function(t){},Hh.prototype.Xu=function(i){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(i),this.currentUser=i,e?(this.wl("'waitForPendingWrites' promise is rejected due to a user change."),[4,this._u.Vh(i)]):[3,3];case 1:return n=t.sent(),this.Qc.Vh(i,n.yh,n.bh),[4,this.al(n.gh)];case 2:t.sent(),t.label=3;case 3:return[4,this.Lc.Xu()];case 4:return t.sent(),[2]}})})},Hh.prototype.Zu=function(h){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u=this;return y(this,function(t){switch(t.label){case 0:return!0!==h||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Lc.Zu(!0)]);case 1:return t.sent(),e=this.Qc._c(),[4,this.Al(e.j())];case 2:for(n=t.sent(),i=0,r=n;i<r.length;i++)o=r[i],this.Lc.listen(o);return[3,7];case 3:return!1!==h||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,s=[],a=Promise.resolve(),this.zc.forEach(function(t,e){u.Qc.cc(e)?s.push(e):a=a.then(function(){return u.hl(e),u._u.co(e,!0)}),u.Lc.$u(e)}),[4,a]);case 4:return t.sent(),[4,this.Al(s)];case 5:return t.sent(),this.Pl(),[4,this.Lc.Zu(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},Hh.prototype.Pl=function(){var n=this;this.Jc.forEach(function(t,e){n.Lc.$u(e)}),this.Yc.kn(),this.Jc=new Map,this.Hc=new hr(ar.k)},Hh.prototype.Al=function(d){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u,h,c,l,f,p;return y(this,function(t){switch(t.label){case 0:e=[],n=[],i=0,r=d,t.label=1;case 1:return i<r.length?(o=r[i],s=void 0,(a=this.zc.get(o))&&0!==a.length?[4,this._u.co(o,!0)]:[3,8]):[3,14];case 2:return t.sent(),[4,this._u.ho(a[0].Ue())];case 3:s=t.sent(),u=0,h=a,t.label=4;case 4:return u<h.length?(c=h[u],l=this.Gc.get(c),[4,this.nl(l)]):[3,7];case 5:(f=t.sent()).snapshot&&n.push(f.snapshot),t.label=6;case 6:return u++,[3,4];case 7:return[3,12];case 8:return[4,this._u.Ao(o)];case 9:return p=t.sent(),[4,this._u.ho(p)];case 10:return s=t.sent(),[4,this.il(this.Vl(p),o,!1)];case 11:t.sent(),t.label=12;case 12:e.push(s),t.label=13;case 13:return i++,[3,1];case 14:return[2,(this.jc.La(n),e)]}})})},Hh.prototype.Vl=function(t){return new Po(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},Hh.prototype.wo=function(){return this._u.wo()},Hh.prototype.pl=function(i,r,o){return c(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.isPrimary?(pa("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.zc.has(i))return[3,8];switch(r){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this._u.Po()];case 3:return e=t.sent(),n=js.Rs(i,"current"===r),[4,this.al(e,n)];case 4:return t.sent(),[3,8];case 5:return[4,this._u.co(i,!0)];case 6:return t.sent(),this.hl(i,o),[3,8];case 7:va("Unexpected target state: "+r),t.label=8;case 8:return[2]}})})},Hh.prototype.gl=function(f,p){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u,h,c,l=this;return y(this,function(t){switch(t.label){case 0:if(!this.isPrimary)return[3,10];e=0,n=f,t.label=1;case 1:return e<n.length?(i=n[e],[4,this._u.Ao(i)]):[3,6];case 2:return r=t.sent(),[4,this._u.ho(r)];case 3:return o=t.sent(),[4,this.il(this.Vl(r),o.targetId,!1)];case 4:t.sent(),this.Lc.listen(o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return y(this,function(t){switch(t.label){case 0:return a.zc.has(e)?[4,a._u.co(e,!1).then(function(){l.Lc.$u(e),l.hl(e)}).catch(Za)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=this,u=0,h=p,t.label=7;case 7:return u<h.length?(c=h[u],[5,s(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})},Hh.prototype.enableNetwork=function(){return this._u.Eo(!0),this.Lc.enableNetwork()},Hh.prototype.disableNetwork=function(){return this._u.Eo(!1),this.Lc.disableNetwork()},Hh.prototype.ai=function(t){var e=this.Jc.get(t);if(e&&e.xc)return Cs().add(e.key);var n=Cs(),i=this.zc.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++){var s=o[r],a=this.Gc.get(s);n=n.kt(a.view.Pc)}return n},Hh),Lh=(Bh.prototype.listen=function(t){var e=t.query,n=!1,i=this.vl.get(e);return i||(n=!0,i=new fh,this.vl.set(e,i)),i.bl.push(t),t.Dc(this.onlineState),i.yl&&t.Cl(i.yl)&&this.Dl(),n?this.Mu.listen(e).then(function(t){return i.targetId=t}):Promise.resolve(i.targetId)},Bh.prototype.$u=function(o){return c(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.vl.get(e))&&0<=(r=i.bl.indexOf(o))&&(i.bl.splice(r,1),n=0===i.bl.length),n?[2,(this.vl.delete(e),this.Mu.$u(e))]:[2]})})},Bh.prototype.La=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.vl.get(o);if(s){for(var a=0,u=s.bl;a<u.length;a++)u[a].Cl(r)&&(e=!0);s.yl=r}}e&&this.Dl()},Bh.prototype.Tl=function(t,e){var n=this.vl.get(t);if(n)for(var i=0,r=n.bl;i<r.length;i++)r[i].onError(e);this.vl.delete(t)},Bh.prototype.ul=function(r){this.onlineState=r;var o=!1;this.vl.forEach(function(t,e){for(var n=0,i=e.bl;n<i.length;n++)i[n].Dc(r)&&(o=!0)}),o&&this.Dl()},Bh.prototype.Fl=function(t){this.Sl.add(t),t.next()},Bh.prototype.Nl=function(t){this.Sl.delete(t)},Bh.prototype.Dl=function(){this.Sl.forEach(function(t){t.next()})},Bh),Dh=(jh.prototype.Cl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new xs(t.query,t.docs,t.cs,e,t.ls,t.fromCache,t._s,!0)}var o=!1;return this.Ll?this.Ol(t)&&(this.kl.next(t),o=!0):this.Ml(t,this.onlineState)&&(this.Ul(t),o=!0),this.$l=t,o},jh.prototype.onError=function(t){this.kl.error(t)},jh.prototype.Dc=function(t){this.onlineState=t;var e=!1;return this.$l&&!this.Ll&&this.Ml(this.$l,t)&&(this.Ul(this.$l),e=!0),e},jh.prototype.Ml=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.ql&&n||t.docs.q()&&"Offline"!==e)},jh.prototype.Ol=function(t){if(0<t.docChanges.length)return!0;var e=this.$l&&this.$l.hasPendingWrites!==t.hasPendingWrites;return!(!t._s&&!e)&&!0===this.options.includeMetadataChanges},jh.prototype.Ul=function(t){t=xs.fs(t.query,t.docs,t.ls,t.fromCache),this.Ll=!0,this.kl.next(t)},jh),Oh=(xh.prototype.Ah=function(t){this.Bl=t},xh.prototype.rr=function(e,i,r,o){var s=this;return i.Me()||r.isEqual(Hi.MIN)?this.xl(e,i):this.Bl.sr(e,o).next(function(t){var n=s.Ql(i,t);return(i.je()||i.Ge())&&s.yc(i.pe,n,o,r)?s.xl(e,i):(la()<=a.DEBUG&&pa("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.Bl.rr(e,i,r).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},xh.prototype.Ql=function(n,t){var i=new vr(function(t,e){return n.qe(t,e)});return t.forEach(function(t,e){e instanceof Oo&&n.matches(e)&&(i=i.add(e))}),i},xh.prototype.yc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.C(i))},xh.prototype.xl=function(t,e){return la()<=a.DEBUG&&pa("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Bl.rr(t,e,Hi.MIN)},xh),Ch=(Gh.prototype.jl=function(t,e){return this.Wl.add(e),Ra.resolve()},Gh.prototype.ur=function(t,e){return Ra.resolve(this.Wl.getEntries(e))},Gh),Vh=(Fh.prototype.add=function(t){var e=t.U(),n=t.O(),i=this.index[e]||new vr(tr.k),r=!i.has(n);return this.index[e]=i.add(n),r},Fh.prototype.has=function(t){var e=t.U(),n=t.O(),i=this.index[e];return i&&i.has(n)},Fh.prototype.getEntries=function(t){return(this.index[t]||new vr(tr.k)).j()},Fh),Uh=(qh.prototype.Kl=function(t){return Ra.resolve(0===this.Hn.length)},qh.prototype.Nh=function(t,e,n){var i=e.batchId,r=this.Hl(i,"acknowledged");return ga(0===r,"Can only acknowledge the first batch in the mutation queue"),this.Hn[r],this.lastStreamToken=n,Ra.resolve()},qh.prototype.xh=function(t){return Ra.resolve(this.lastStreamToken)},qh.prototype.Qh=function(t,e){return this.lastStreamToken=e,Ra.resolve()},qh.prototype.Sh=function(t,e,n,i){var r=this.Gl;this.Gl++,0<this.Hn.length&&this.Hn[this.Hn.length-1];var o=new Ta(r,e,n,i);this.Hn.push(o);for(var s=0,a=i;s<a.length;s++){var u=a[s];this.zl=this.zl.add(new ka(u.key,r)),this.Jn.jl(t,u.key.path.O())}return Ra.resolve(o)},qh.prototype.Uh=function(t,e){return Ra.resolve(this.Jl(e))},qh.prototype.Fh=function(t,e){var n=this.Jl(e);return Ra.resolve(n.keys())},qh.prototype.no=function(t,e){var n=e+1,i=this.Yl(n),r=i<0?0:i;return Ra.resolve(this.Hn.length>r?this.Hn[r]:null)},qh.prototype.Bh=function(){return Ra.resolve(0===this.Hn.length?-1:this.Gl-1)},qh.prototype.ph=function(t){return Ra.resolve(this.Hn.slice())},qh.prototype.Xn=function(t,e){var n=this,i=new ka(e,0),r=new ka(e,Number.POSITIVE_INFINITY),o=[];return this.zl.Dt([i,r],function(t){var e=n.Jl(t.On);o.push(e)}),Ra.resolve(o)},qh.prototype.nr=function(t,e){var i=this,r=new vr(ba);return e.forEach(function(t){var e=new ka(t,0),n=new ka(t,Number.POSITIVE_INFINITY);i.zl.Dt([e,n],function(t){r=r.add(t.On)})}),Ra.resolve(this.Xl(r))},qh.prototype.cr=function(t,e){var n=e.path,i=n.length+1,r=n;ar.st(r)||(r=r.child(""));var o=new ka(new ar(r),0),s=new vr(ba);return this.zl.Ft(function(t){var e=t.key.path;return!!n.B(e)&&(e.length===i&&(s=s.add(t.On)),!0)},o),Ra.resolve(this.Xl(s))},qh.prototype.Xl=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Jl(t);null!==e&&i.push(e)}),i},qh.prototype.qh=function(n,i){var r=this;ga(0===this.Hl(i.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.Hn.shift();var o=this.zl;return Ra.forEach(i.mutations,function(t){var e=new ka(t.key,i.batchId);return o=o.delete(e),r.dh.Zl(n,t.key)}).next(function(){r.zl=o})},qh.prototype.mo=function(t){},qh.prototype.$n=function(t,e){var n=new ka(e,0),i=this.zl.Nt(n);return Ra.resolve(e.isEqual(i&&i.key))},qh.prototype.Oh=function(t){return this.Hn.length,Ra.resolve()},qh.prototype.Hl=function(t,e){return this.Yl(t)},qh.prototype.Yl=function(t){return 0===this.Hn.length?0:t-this.Hn[0].batchId},qh.prototype.Jl=function(t){var e=this.Yl(t);return e<0||e>=this.Hn.length?null:this.Hn[e]},qh),Ph=(Mh.prototype.Xh=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.t_(e);return this.docs=this.docs.nt(i,{e_:e,size:s,readTime:n}),this.size+=s-o,this.Jn.jl(t,i.path.O())},Mh.prototype.Yh=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Mh.prototype.tr=function(t,e){var n=this.docs.get(e);return Ra.resolve(n?n.e_:null)},Mh.prototype.getEntries=function(t,e){var n=this,i=Ss();return e.forEach(function(t){var e=n.docs.get(t);i=i.nt(t,e?e.e_:null)}),Ra.resolve(i)},Mh.prototype.rr=function(t,e,n){for(var i=Rs(),r=new ar(e.path.child("")),o=this.docs._t(r);o.Rt();){var s=o.Et(),a=s.key,u=s.value,h=u.e_,c=u.readTime;if(!e.path.B(a.path))break;c.C(n)<=0||h instanceof Oo&&e.matches(h)&&(i=i.nt(h.key,h))}return Ra.resolve(i)},Mh.prototype.s_=function(t,e){return Ra.forEach(this.docs,function(t){return e(t)})},Mh.prototype.Po=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},Mh.prototype.po=function(t){return Ra.resolve(Hi.MIN)},Mh.prototype.kh=function(t){return new Mh.i_(this)},Mh.prototype.n_=function(t){return Ra.resolve(this.size)},Mh);function Mh(t,e){this.Jn=t,this.t_=e,this.docs=new hr(ar.k),this.size=0}function qh(t,e){this.Jn=t,this.dh=e,this.Hn=[],this.Gl=1,this.lastStreamToken=Ir.Ut,this.zl=new vr(ka.me)}function Fh(){this.index={}}function Gh(){this.Wl=new Vh}function xh(){}function jh(t,e,n){this.query=t,this.kl=e,this.Ll=!1,this.$l=null,this.onlineState="Unknown",this.options=n||{}}function Bh(t){this.Mu=t,this.vl=new Na(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.Sl=new Set,this.Mu.subscribe(this)}function Hh(t,e,n,i,r){this._u=t,this.Lc=e,this.Qc=n,this.currentUser=i,this.Wc=r,this.jc=null,this.Gc=new Na(function(t){return t.canonicalId()}),this.zc=new Map,this.Kc=[],this.Hc=new hr(ar.k),this.Jc=new Map,this.Yc=new Sa,this.Xc={},this.Zc=new Map,this.tl=_h.mc(),this.isPrimary=void 0,this.onlineState="Unknown"}function Qh(t,e,n,i){this.Ar=t,this.Lc=e,this.updateFunction=n,this.gr=i,this.$c=5,this.Ea=new vh(this.Ar,"retry_transaction")}function zh(t,e){this.query=t,this.Ec=e,this.Rc=null,this.As=!1,this.Ic=Cs(),this.ls=Cs(),this.Ac=new Fs(t.qe.bind(t))}function Yh(t){this.wc=t}function Wh(){this.ic=new Nh,this.nc={},this.Mu=null,this.iu=null,this.Tr=null}function Xh(){this.activeTargetIds=Us()}function Jh(t,e,n,i,r){var o=this;this._u=t,this.Ha=e,this.du=[],this.fu=new Map,this.wu=null,this.networkEnabled=!1,this.isPrimary=!1,this.Tu=r,this.Tu.mu(function(t){n.Cr(function(){return c(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eu()?(pa("RemoteStore","Restarting streams for network reachability change."),[4,this.Ru()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Iu=new Ah(n,i),this.Au=this.Ha.ja({Na:this.Pu.bind(this),va:this.Vu.bind(this),La:this.pu.bind(this)}),this.gu=this.Ha.Wa({Na:this.yu.bind(this),va:this.bu.bind(this),xa:this.vu.bind(this),Ba:this.Ba.bind(this)})}function Kh(t,e){this.Ar=t,this.iu=e,this.state="Unknown",this.nu=0,this.ru=null,this.hu=!0}function Zh(t){this.Ha=t,this.Ja=Ds(),this.mutations=[],this.Ya=!1,this.Xa=null,this.Za=new Set}function $h(t,e,n,i){this.ia=t,this.fa=e,this.credentials=n,this.serializer=i}function tc(t,e,n,i,r){var o=this;return(o=ph.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.Ma=!1,o.lastStreamToken=Ir.Ut,o}function ec(t,e,n,i,r){var o=this;return(o=dh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function nc(t,e,n,i,r,o){this.ia=t,this.da=n,this.fa=i,this.wa=r,this.listener=o,this.state=0,this.Ta=0,this.ma=null,this.stream=null,this.Ea=new vh(t,e)}function ic(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.ia=t,this.Pr=e,this.na=n,this.ra=i,this.ha=r,this.oa=0,this.aa=null,this.ua=Date.now(),this.reset()}function rc(t){var e=this;return(e=yh.call(this)||this).c_=t,e}function oc(){this.Ch=new Na(function(t){return t.toString()}),this.r_=!1}Ph.i_=(Object.defineProperty(oc.prototype,"readTime",{get:function(){return this.h_},set:function(t){this.h_=t},enumerable:!0,configurable:!0}),oc.prototype.Xh=function(t,e){this.o_(),this.readTime=e,this.Ch.set(t.key,t)},oc.prototype.Yh=function(t,e){this.o_(),e&&(this.readTime=e),this.Ch.set(t,null)},oc.prototype.tr=function(t,e){this.o_();var n=this.Ch.get(e);return void 0!==n?Ra.resolve(n):this.a_(t,e)},oc.prototype.getEntries=function(t,e){return this.u_(t,e)},oc.prototype.apply=function(t){return this.o_(),this.r_=!0,this.bc(t)},oc.prototype.o_=function(){},n(rc,yh=oc),rc.prototype.bc=function(n){var i=this,r=[];return this.Ch.forEach(function(t,e){e?r.push(i.c_.Xh(n,e,i.readTime)):i.c_.Yh(t)}),Ra.Gn(r)},rc.prototype.a_=function(t,e){return this.c_.tr(t,e)},rc.prototype.u_=function(t,e){return this.c_.getEntries(t,e)},rc);var sc,ac=(Ac.prototype.Xs=function(t,n){return this.l_.forEach(function(t,e){return n(e)}),Ra.resolve()},Ac.prototype.Wh=function(t){return Ra.resolve(this.lastRemoteSnapshotVersion)},Ac.prototype.w_=function(t){return Ra.resolve(this.__)},Ac.prototype.ao=function(t){return this.highestTargetId=this.f_.next(),Ra.resolve(this.highestTargetId)},Ac.prototype.to=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.__&&(this.__=e),Ra.resolve()},Ac.prototype.T_=function(t){this.l_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.f_=new _h(e),this.highestTargetId=e),t.sequenceNumber>this.__&&(this.__=t.sequenceNumber)},Ac.prototype.uo=function(t,e){return this.T_(e),this.targetCount+=1,Ra.resolve()},Ac.prototype.Jh=function(t,e){return this.T_(e),Ra.resolve()},Ac.prototype.m_=function(t,e){return this.l_.delete(e.target),this.d_.Nn(e.targetId),--this.targetCount,Ra.resolve()},Ac.prototype.E_=function(n,i,r){var o=this,s=0,a=[];return this.l_.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.l_.delete(t),a.push(o.R_(n,e.targetId)),s++)}),Ra.Gn(a).next(function(){return s})},Ac.prototype.I_=function(t){return Ra.resolve(this.targetCount)},Ac.prototype.oo=function(t,e){var n=this.l_.get(e)||null;return Ra.resolve(n)},Ac.prototype.ui=function(t,e){return va("Not yet implemented.")},Ac.prototype.zh=function(e,t,n){this.d_.Sn(t,n);var i=this.persistence.dh,r=[];return i&&t.forEach(function(t){r.push(i.vn(e,t))}),Ra.Gn(r)},Ac.prototype.Gh=function(e,t,n){this.d_.Fn(t,n);var i=this.persistence.dh,r=[];return i&&t.forEach(function(t){r.push(i.Cn(e,t))}),Ra.Gn(r)},Ac.prototype.R_=function(t,e){return this.d_.Nn(e),Ra.resolve()},Ac.prototype._o=function(t,e){var n=this.d_.Ln(e);return Ra.resolve(n)},Ac.prototype.$n=function(t,e){return Ra.resolve(this.d_.$n(e))},Ac),uc=(Ec.prototype.ku=function(){return this.V_=!1,Promise.resolve()},Object.defineProperty(Ec.prototype,"g_",{get:function(){return this.V_},enumerable:!0,configurable:!0}),Ec.prototype.wo=function(){return c(this,void 0,void 0,function(){return y(this,function(t){return[2,[this.clientId]]})})},Ec.prototype.y_=function(t){return t(!0)},Ec.prototype.b_=function(){},Ec.prototype.Eo=function(t){},Ec.prototype.Ih=function(){return this.Jn},Ec.prototype.fh=function(t){var e=this.A_[t.s()];return e||(e=new Uh(this.Jn,this.dh),this.A_[t.s()]=e),e},Ec.prototype.Eh=function(){return this.mh},Ec.prototype.Th=function(){return this.Kn},Ec.prototype.runTransaction=function(t,e,n){var i=this;pa("MemoryPersistence","Starting transaction:",t);var r=new hc(this.P_.next());return this.dh.v_(),n(r).next(function(t){return i.dh.S_(r).next(function(){return t})}).Wn().then(function(t){return r.C_(),t})},Ec.prototype.D_=function(e,n){return Ra.zn(Object.values(this.A_).map(function(t){return function(){return t.$n(e,n)}}))},Ec),hc=(bc.prototype.N_=function(t){this.F_.push(t)},bc.prototype.C_=function(){this.F_.forEach(function(t){return t()})},n(wc,sc=bc),wc),cc=(mc.O_=function(t){return new mc(t)},Object.defineProperty(mc.prototype,"M_",{get:function(){if(this.L_)return this.L_;throw va("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),mc.prototype._h=function(t){this.k_=t},mc.prototype.vn=function(t,e){return this.M_.delete(e),Ra.resolve()},mc.prototype.Cn=function(t,e){return this.M_.add(e),Ra.resolve()},mc.prototype.Zl=function(t,e){return this.M_.add(e),Ra.resolve()},mc.prototype.removeTarget=function(t,e){var n=this,i=this.persistence.Eh();return i._o(t,e.targetId).next(function(t){t.forEach(function(t){return n.M_.add(t)})}).next(function(){return i.m_(t,e)})},mc.prototype.v_=function(){this.L_=new Set},mc.prototype.S_=function(t){var n=this,i=this.persistence.Th().kh();return Ra.forEach(this.M_,function(e){return n.U_(t,e).next(function(t){t||i.Yh(e)})}).next(function(){return n.L_=null,i.apply(t)})},mc.prototype.Zh=function(t,e){var n=this;return this.U_(t,e).next(function(t){t?n.M_.delete(e):n.M_.add(e)})},mc.prototype.p_=function(t){return 0},mc.prototype.U_=function(t,e){var n=this;return Ra.zn([function(){return n.persistence.Eh().$n(t,e)},function(){return n.persistence.D_(t,e)},function(){return Ra.resolve(n.k_.$n(e))}])},mc),lc="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",fc=(gc.prototype.initialize=function(n,t,i,r,o,s,a,u){return c(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(u.B_)throw new qi(Mi.FAILED_PRECONDITION,lc);return this.persistence=new uc(o,this.q_),this.x_=null,this.Qc=new Th,this._u=new Ja(this.persistence,new Oh,s),this.Lc=new Ih(this._u,r,n,function(t){return e.Mu.Dc(t,0)},i.Q_()),this.Mu=new Rh(this._u,this.Lc,this.Qc,s,a),this.W_=new Lh(this.Mu),this.Lc.Mu=this.Mu,[4,this.Lc.start()];case 1:return t.sent(),[4,this.Lc.Zu(!0)];case 2:return t.sent(),[4,this.Mu.Zu(!0)];case 3:return t.sent(),[2]}})})},gc.prototype.clearPersistence=function(){throw new qi(Mi.FAILED_PRECONDITION,lc)},gc),pc=(vc.prototype.start=function(e,n){var i=this;this.G_();var r=new Ba,o=new Ba,s=!1;return this.credentials._(function(t){if(!s)return s=!0,pa("FirestoreClient","Initializing. user=",t.uid),i.z_(e,n,t,o).then(r.resolve,r.reject);i.Ar.Cr(function(){return i.Xu(t)})}),this.Ar.Cr(function(){return r.promise}),o.promise},vc.prototype.enableNetwork=function(){var t=this;return this.G_(),this.Ar.enqueue(function(){return t.Mu.enableNetwork()})},vc.prototype.z_=function(s,a,u,h){return c(this,void 0,void 0,function(){var e,n,i,r,o=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.K_(this.j_)];case 1:return e=t.sent(),n=this.platform.H_(this.j_.ci),i=new bh(this.Ar,e,this.credentials,n),[4,s.initialize(this.Ar,this.j_,this.platform,i,this.clientId,u,100,a)];case 2:return t.sent(),this.persistence=s.persistence,this.Qc=s.Qc,this._u=s._u,this.Lc=s.Lc,this.Mu=s.Mu,this.x_=s.x_,this.J_=s.W_,this.persistence.b_(function(){return c(o,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),h.resolve(),[3,4];case 3:if(r=t.sent(),h.reject(r),!this.Y_(r))throw r;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),this.z_(new fc,{B_:!1},u,h))];case 4:return[2]}})})},vc.prototype.Y_=function(t){return"FirebaseError"===t.name?t.code===Mi.FAILED_PRECONDITION||t.code===Mi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},vc.prototype.G_=function(){if(this.Ar.Or)throw new qi(Mi.FAILED_PRECONDITION,"The client has already been terminated.")},vc.prototype.Xu=function(t){return this.Ar.jr(),pa("FirestoreClient","Credential Changed. Current user: "+t.uid),this.Mu.Xu(t)},vc.prototype.disableNetwork=function(){var t=this;return this.G_(),this.Ar.enqueue(function(){return t.Mu.disableNetwork()})},vc.prototype.terminate=function(){var t=this;return this.Ar.xr(function(){return c(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.x_&&this.x_.stop(),[4,this.Lc.ku()];case 1:return t.sent(),[4,this.Qc.ku()];case 2:return t.sent(),[4,this.persistence.ku()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},vc.prototype.waitForPendingWrites=function(){var t=this;this.G_();var e=new Ba;return this.Ar.Cr(function(){return t.Mu.fl(e)}),e.promise},vc.prototype.listen=function(t,e,n){var i=this;this.G_();var r=new Dh(t,e,n);return this.Ar.Cr(function(){return i.J_.listen(r)}),r},vc.prototype.$u=function(t){var e=this;this.X_||this.Ar.Cr(function(){return e.J_.$u(t)})},vc.prototype.Z_=function(t){var e=this;return this.G_(),this.Ar.enqueue(function(){return e._u.ro(t)}).then(function(t){if(t instanceof Oo)return t;if(t instanceof Co)return null;throw new qi(Mi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},vc.prototype.td=function(r){var t=this;return this.G_(),this.Ar.enqueue(function(){return c(t,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return[4,this._u.lo(r,!0)];case 1:return e=t.sent(),n=new Sh(r,e.do),i=n.Vc(e.documents),[2,n.bc(i,!1).snapshot]}})})})},vc.prototype.write=function(t){var e=this;this.G_();var n=new Ba;return this.Ar.Cr(function(){return e.Mu.write(t,n)}),n.promise},vc.prototype.ci=function(){return this.j_.ci},vc.prototype.Fl=function(t){var e=this;this.G_(),this.Ar.Cr(function(){return e.J_.Fl(t),Promise.resolve()})},vc.prototype.Nl=function(t){this.X_||this.J_.Nl(t)},Object.defineProperty(vc.prototype,"X_",{get:function(){return this.Ar.Or},enumerable:!0,configurable:!0}),vc.prototype.transaction=function(t){var e=this;this.G_();var n=new Ba;return this.Ar.Cr(function(){return e.Mu.runTransaction(e.Ar,t,n),Promise.resolve()}),n.promise},vc),dc=(yc.prototype.next=function(t){this.ed(this.observer.next,t)},yc.prototype.error=function(t){this.ed(this.observer.error,t)},yc.prototype.sd=function(){this.muted=!0},yc.prototype.ed=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},yc);function yc(t){this.observer=t,this.muted=!1}function vc(t,e,n,i){this.platform=t,this.j_=e,this.credentials=n,this.Ar=i,this.clientId=ma.Tn()}function gc(t){void 0===t&&(t=cc.O_),this.q_=t}function mc(t){this.persistence=t,this.k_=null,this.L_=null}function wc(t){var e=this;return(e=sc.call(this)||this).Kh=t,e}function bc(){this.F_=[]}function Ec(t,e){var n=this;this.clientId=t,this.A_={},this.P_=new Oa(0),this.V_=!1,this.V_=!0,this.dh=e(this),this.mh=new ac(this),this.Jn=new Ch,this.Kn=new Ph(this.Jn,function(t){return n.dh.p_(t)})}function Ac(t){this.persistence=t,this.l_=new Na(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Hi.MIN,this.highestTargetId=0,this.__=0,this.d_=new Sa,this.targetCount=0,this.f_=_h.Tc()}function Ic(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var Nc,Tc,_c=(Jc.prototype.rd=function(t){switch(Lr(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Mr(t.integerValue||t.doubleValue);case 3:return this.hd(t.timestampValue);case 4:return this.od(t);case 5:return t.stringValue;case 6:return new bu(qr(t.bytesValue));case 7:return this.ad(t.referenceValue);case 8:return new xu(t.geoPointValue.latitude,t.geoPointValue.longitude);case 9:return this.ud(t.arrayValue);case 10:return this.ld(t.mapValue);default:throw va("Invalid value type: "+JSON.stringify(t))}},Jc.prototype.ld=function(t){var n=this,i={};return Er(t.fields||{},function(t,e){i[t]=n.rd(e)}),i},Jc.prototype.ud=function(t){var e=this;return(t.values||[]).map(function(t){return e.rd(t)})},Jc.prototype.od=function(t){switch(this.nd){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Sr(n)?t(n):n}(t);return null==e?null:this.rd(e);case"estimate":return this.hd(kr(t));default:return null}},Jc.prototype.hd=function(t){var e=Pr(t),n=new Bi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Jc.prototype.ad=function(t){var e=tr.K(t);ga(aa(e),"ReferenceValue is not valid "+t);var n=new Ia(e.get(1),e.get(3)),i=new ar(e.$(5));return n.isEqual(this.firestore._d)||da("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore._d.projectId+"/"+this.firestore._d.database+") instead."),new Oc(i,this.firestore,this.converter)},Jc),Sc=za.sh,kc=(Xc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},Xc),Rc=(Wc.prototype.settings=function(t){tu("Firestore.settings",arguments,1),iu("Firestore.settings","object",1,t);var e=new kc(t);if(this.Td&&!this.Ad.isEqual(e))throw new qi(Mi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Ad=e).credentials&&(this.Rd=function(t){if(!t)return new Fi;switch(t.type){case"gapi":var e=t.pd;return ga(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new ji(e,t.V||"0");case"provider":return t.pd;default:throw new qi(Mi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Wc.prototype.enableNetwork=function(){return this.wd(),this.Td.enableNetwork()},Wc.prototype.disableNetwork=function(){return this.wd(),this.Td.disableNetwork()},Wc.prototype.enablePersistence=function(t){var e,n;if(this.Td)throw new qi(Mi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1;return t&&(void 0!==t.experimentalTabSynchronization&&da("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.gd(this.Id,{B_:!0,cacheSizeBytes:this.Ad.cacheSizeBytes,synchronizeTabs:i})},Wc.prototype.clearPersistence=function(){return c(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){if(void 0!==this.Td&&!this.Td.X_)throw new qi(Mi.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new Ba,[2,(this.fd.Mr(function(){return c(e,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.yd(),[4,this.Id.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},Wc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Wc.prototype,"bd",{get:function(){return this.wd(),this.Td.X_},enumerable:!0,configurable:!0}),Wc.prototype.waitForPendingWrites=function(){return this.wd(),this.Td.waitForPendingWrites()},Wc.prototype.onSnapshotsInSync=function(t){if(this.wd(),Ic(t))return this.vd(t);iu("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.vd(e)},Wc.prototype.vd=function(t){var e=this,n=new dc({next:function(){t.next&&t.next()},error:function(t){throw va("Uncaught Error in onSnapshotsInSync")}});return this.Td.Fl(n),function(){n.sd(),e.Td.Nl(n)}},Wc.prototype.wd=function(){return this.Td||this.gd(new fc,{B_:!1}),this.Td},Wc.prototype.yd=function(){return new Aa(this._d,this.Ed,this.Ad.host,this.Ad.ssl,this.Ad.forceLongPolling)},Wc.prototype.gd=function(t,e){var n=this.yd();return this.Td=new pc(ua.Ot(),n,this.Rd,this.fd),this.Td.start(t,e)},Wc.prototype.Vd=function(i){var t=new oa(i,{di:ua.Ot().di});return new th(t,function(t){if(t instanceof Oc){var e=i,n=t.firestore._d;if(!n.isEqual(e))throw new qi(Mi.INVALID_ARGUMENT,"Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+e.projectId+"/"+e.database);return new $u(i,t.Sd)}return t})},Wc.md=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new qi(Mi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new qi(Mi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ia(n)},Object.defineProperty(Wc.prototype,"app",{get:function(){if(!this.dd)throw new qi(Mi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.dd},enumerable:!0,configurable:!0}),Wc.prototype.collection=function(t){return tu("Firestore.collection",arguments,1),iu("Firestore.collection","non-empty string",1,t),this.wd(),new qc(tr.K(t),this)},Wc.prototype.doc=function(t){return tu("Firestore.doc",arguments,1),iu("Firestore.doc","non-empty string",1,t),this.wd(),Oc.Cd(tr.K(t),this)},Wc.prototype.collectionGroup=function(t){if(tu("Firestore.collectionGroup",arguments,1),iu("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new qi(Mi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.wd(),new Pc(new Po(tr.H,t),this)},Wc.prototype.runTransaction=function(e){var n=this;return tu("Firestore.runTransaction",arguments,1),iu("Firestore.runTransaction","function",1,e),this.wd().transaction(function(t){return e(new Lc(n,t))})},Wc.prototype.batch=function(){return this.wd(),new Dc(this)},Object.defineProperty(Wc,"logLevel",{get:function(){switch(la()){case a.DEBUG:return"debug";case a.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),Wc.setLogLevel=function(t){switch(tu("Firestore.setLogLevel",arguments,1),iu("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":fa(a.DEBUG);break;case"error":fa(a.ERROR);break;case"silent":fa(a.SILENT);break;default:throw new qi(Mi.INVALID_ARGUMENT,"Invalid log level: "+t)}},Wc.prototype.Dd=function(){return this.Ad.timestampsInSnapshots},Wc),Lc=(Yc.prototype.get=function(t){var n=this;tu("Transaction.get",arguments,1);var i=tl("Transaction.get",t,this.Fd);return this.Nd.za([i.Sd]).then(function(t){if(!t||1!==t.length)return va("Mismatch in docs returned from document lookup.");var e=t[0];if(e instanceof Co)return new Vc(n.Fd,i.Sd,null,!1,!1,i.kd);if(e instanceof Oo)return new Vc(n.Fd,i.Sd,e,!1,!1,i.kd);throw va("BatchGetDocumentsRequest returned unexpected document type: "+e.constructor.name)})},Yc.prototype.set=function(t,e,n){nu("Transaction.set",arguments,2,3);var i=tl("Transaction.set",t,this.Fd);n=Kc("Transaction.set",n);var r=el(i.kd,e,"Transaction.set"),o=r[0],s=r[1],a=n.merge||n.mergeFields?this.Fd.Pd.zo(s,o,n.mergeFields):this.Fd.Pd.jo(s,o);return this.Nd.set(i.Sd,a),this},Yc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Au?(eu("Transaction.update",arguments,3),i=tl("Transaction.update",t,this.Fd),this.Fd.Pd.Yo("Transaction.update",e,n,o)):(tu("Transaction.update",arguments,2),i=tl("Transaction.update",t,this.Fd),this.Fd.Pd.Ko("Transaction.update",e)),this.Nd.update(i.Sd,r),this},Yc.prototype.delete=function(t){tu("Transaction.delete",arguments,1);var e=tl("Transaction.delete",t,this.Fd);return this.Nd.delete(e.Sd),this},Yc),Dc=(zc.prototype.set=function(t,e,n){nu("WriteBatch.set",arguments,2,3),this.Od();var i=tl("WriteBatch.set",t,this.Fd);n=Kc("WriteBatch.set",n);var r=el(i.kd,e,"WriteBatch.set"),o=r[0],s=r[1],a=n.merge||n.mergeFields?this.Fd.Pd.zo(s,o,n.mergeFields):this.Fd.Pd.jo(s,o);return this.Ld=this.Ld.concat(a.Lo(i.Sd,io.NONE)),this},zc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Od(),r="string"==typeof e||e instanceof Au?(eu("WriteBatch.update",arguments,3),i=tl("WriteBatch.update",t,this.Fd),this.Fd.Pd.Yo("WriteBatch.update",e,n,o)):(tu("WriteBatch.update",arguments,2),i=tl("WriteBatch.update",t,this.Fd),this.Fd.Pd.Ko("WriteBatch.update",e)),this.Ld=this.Ld.concat(r.Lo(i.Sd,io.exists(!0))),this},zc.prototype.delete=function(t){tu("WriteBatch.delete",arguments,1),this.Od();var e=tl("WriteBatch.delete",t,this.Fd);return this.Ld=this.Ld.concat(new go(e.Sd,io.NONE)),this},zc.prototype.commit=function(){return this.Od(),this.$d=!0,0<this.Ld.length?this.Fd.wd().write(this.Ld):Promise.resolve()},zc.prototype.Od=function(){if(this.$d)throw new qi(Mi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},zc),Oc=(Qc.Cd=function(t,e,n){if(t.length%2!=0)throw new qi(Mi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.G()+" has "+t.length);return new Qc(new ar(t),e,n)},Object.defineProperty(Qc.prototype,"id",{get:function(){return this.Sd.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(Qc.prototype,"parent",{get:function(){return new qc(this.Sd.path.O(),this.firestore,this.kd)},enumerable:!0,configurable:!0}),Object.defineProperty(Qc.prototype,"path",{get:function(){return this.Sd.path.G()},enumerable:!0,configurable:!0}),Qc.prototype.collection=function(t){if(tu("DocumentReference.collection",arguments,1),iu("DocumentReference.collection","non-empty string",1,t),!t)throw new qi(Mi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=tr.K(t);return new qc(this.Sd.path.child(e),this.firestore)},Qc.prototype.isEqual=function(t){if(!(t instanceof Qc))throw pu("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Sd.isEqual(t.Sd)&&this.kd===t.kd},Qc.prototype.set=function(t,e){nu("DocumentReference.set",arguments,1,2),e=Kc("DocumentReference.set",e);var n=el(this.kd,t,"DocumentReference.set"),i=n[0],r=n[1],o=e.merge||e.mergeFields?this.firestore.Pd.zo(r,i,e.mergeFields):this.firestore.Pd.jo(r,i);return this.Td.write(o.Lo(this.Sd,io.NONE))},Qc.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Au?(eu("DocumentReference.update",arguments,2),this.firestore.Pd.Yo("DocumentReference.update",t,e,i)):(tu("DocumentReference.update",arguments,1),this.firestore.Pd.Ko("DocumentReference.update",t)),this.Td.write(n.Lo(this.Sd,io.exists(!0)))},Qc.prototype.delete=function(){return tu("DocumentReference.delete",arguments,0),this.Td.write([new go(this.Sd,io.NONE)])},Qc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];nu("DocumentReference.onSnapshot",arguments,1,4);var n,i={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||Ic(t[r])||(fu("DocumentReference.onSnapshot",i=t[r],["includeMetadataChanges"]),su("DocumentReference.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++);var o={includeMetadataChanges:i.includeMetadataChanges};return n=Ic(t[r])?t[r]:(iu("DocumentReference.onSnapshot","function",r,t[r]),ru("DocumentReference.onSnapshot","function",r+1,t[r+1]),ru("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Md(o,n)},Qc.prototype.Md=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new dc({next:function(t){if(n.next){var e=t.docs.get(i.Sd);n.next(new Vc(i.firestore,i.Sd,e,t.fromCache,t.hasPendingWrites,i.kd))}},error:e}),o=this.Td.listen(Po.ve(this.Sd.path),r,t);return function(){r.sd(),i.Td.$u(o)}},Qc.prototype.get=function(n){var i=this;return nu("DocumentReference.get",arguments,0,1),$c("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.wd().Z_(i.Sd).then(function(t){e(new Vc(i.firestore,i.Sd,t,!0,t instanceof Oo&&t.te,i.kd))},t):i.Ud(e,t,n)})},Qc.prototype.Ud=function(e,n,i){var r=this.Md({includeMetadataChanges:!0,ql:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new qi(Mi.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new qi(Mi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Qc.prototype.withConverter=function(t){return new Qc(this.Sd,this.firestore,t)},Qc),Cc=(Hc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Hc),Vc=(Bc.prototype.data=function(t){if(nu("DocumentSnapshot.data",arguments,0,1),t=Zc("DocumentSnapshot.data",t),this.qd){if(this.kd){var e=new Uc(this.Fd,this.Sd,this.qd,this.Bd,this.xd);return this.kd.fromFirestore(e,t)}return new _c(this.Fd,this.Fd.Dd(),t.serverTimestamps,void 0).rd(this.qd.Re())}},Bc.prototype.get=function(t,e){if(nu("DocumentSnapshot.get",arguments,1,2),e=Zc("DocumentSnapshot.get",e),this.qd){var n=this.qd.data().field(oh("DocumentSnapshot.get",t));if(null!==n)return new _c(this.Fd,this.Fd.Dd(),e.serverTimestamps,this.kd).rd(n)}},Object.defineProperty(Bc.prototype,"id",{get:function(){return this.Sd.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"ref",{get:function(){return new Oc(this.Sd,this.Fd,this.kd)},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"exists",{get:function(){return null!==this.qd},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"metadata",{get:function(){return new Cc(this.xd,this.Bd)},enumerable:!0,configurable:!0}),Bc.prototype.isEqual=function(t){if(!(t instanceof Bc))throw pu("isEqual","DocumentSnapshot",1,t);return this.Fd===t.Fd&&this.Bd===t.Bd&&this.Sd.isEqual(t.Sd)&&(null===this.qd?null===t.qd:this.qd.isEqual(t.qd))&&this.kd===t.kd},Bc),Uc=(n(jc,Tc=Vc),jc.prototype.data=function(t){return Tc.prototype.data.call(this,t)},jc),Pc=(xc.prototype.where=function(t,e,n){var i;tu("Query.where",arguments,3),lu("Query.where",3,n),function(t,e){if(!t.some(function(t){return t===e}))throw new qi(Mi.INVALID_ARGUMENT,"Invalid value "+cu(e)+" provided to function Query.where() for its "+yu(2)+" argument. Acceptable values: "+t.join(", "))}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e);var r=oh("Query.where",t),o=Mo.K(e);if(r.Y()){if(o===Mo.ARRAY_CONTAINS||o===Mo.ARRAY_CONTAINS_ANY)throw new qi(Mi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o.toString()+"' queries on FieldPath.documentId().");if(o===Mo.IN){this.Wd(n,o);for(var s=[],a=0,u=n;a<u.length;a++){var h=u[a];s.push(this.jd(h))}i={arrayValue:{values:s}}}else i=this.jd(n)}else o!==Mo.IN&&o!==Mo.ARRAY_CONTAINS_ANY||this.Wd(n,o),i=this.firestore.Pd.Xo("Query.where",n,o===Mo.IN);var c=Zo.create(r,o,i);return this.Gd(c),new xc(this.Qd.De(c),this.firestore,this.kd)},xc.prototype.orderBy=function(t,e){var n;if(nu("Query.orderBy",arguments,1,2),ru("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n=rs.ASCENDING;else{if("desc"!==e)throw new qi(Mi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n=rs.DESCENDING}if(null!==this.Qd.startAt)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.Qd.endAt)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=oh("Query.orderBy",t),r=new vs(i,n);return this.zd(r),new xc(this.Qd.Fe(r),this.firestore,this.kd)},xc.prototype.limit=function(t){return tu("Query.limit",arguments,1),iu("Query.limit","number",1,t),du("Query.limit",1,t),new xc(this.Qd.Ne(t),this.firestore,this.kd)},xc.prototype.limitToLast=function(t){return tu("Query.limitToLast",arguments,1),iu("Query.limitToLast","number",1,t),du("Query.limitToLast",1,t),new xc(this.Qd.ke(t),this.firestore,this.kd)},xc.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];eu("Query.startAt",arguments,1);var i=this.Kd("Query.startAt",t,e,!0);return new xc(this.Qd.Le(i),this.firestore,this.kd)},xc.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];eu("Query.startAfter",arguments,1);var i=this.Kd("Query.startAfter",t,e,!1);return new xc(this.Qd.Le(i),this.firestore,this.kd)},xc.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];eu("Query.endBefore",arguments,1);var i=this.Kd("Query.endBefore",t,e,!0);return new xc(this.Qd.$e(i),this.firestore,this.kd)},xc.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];eu("Query.endAt",arguments,1);var i=this.Kd("Query.endAt",t,e,!1);return new xc(this.Qd.$e(i),this.firestore,this.kd)},xc.prototype.isEqual=function(t){if(!(t instanceof xc))throw pu("isEqual","Query",1,t);return this.firestore===t.firestore&&this.Qd.isEqual(t.Qd)},xc.prototype.withConverter=function(t){return new xc(this.Qd,this.firestore,t)},xc.prototype.Kd=function(t,e,n,i){if(lu(t,1,e),e instanceof Vc){if(0<n.length)throw new qi(Mi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var r=e;if(!r.exists)throw new qi(Mi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.Hd(r.qd,i)}var o=[e].concat(n);return this.Jd(t,o,i)},xc.prototype.Hd=function(t,e){for(var n=[],i=0,r=this.Qd.orderBy;i<r.length;i++){var o=r[i];if(o.field.Y())n.push(Fr(this.firestore._d,t.key));else{var s=t.field(o.field);if(Sr(s))throw new qi(Mi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var a=o.field.G();throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}n.push(s)}}return new ys(n,e)},xc.prototype.Jd=function(t,e,n){var i=this.Qd.Ve;if(e.length>i.length)throw new qi(Mi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.Y()){if("string"!=typeof s)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.Qd.He()&&-1!==s.indexOf("/"))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var a=this.Qd.path.child(tr.K(s));if(!ar.st(a))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+a+"' is not because it contains an odd number of segments.");var u=new ar(a);r.push(Fr(this.firestore._d,u))}else{var h=this.firestore.Pd.Xo(t,s);r.push(h)}}return new ys(r,n)},xc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];nu("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||Ic(t[r])||(fu("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),su("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=Ic(t[r])?t[r]:(iu("Query.onSnapshot","function",r,t[r]),ru("Query.onSnapshot","function",r+1,t[r+1]),ru("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Yd(this.Qd),this.Md(i,n)},xc.prototype.Md=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new dc({next:function(t){e.next&&e.next(new Mc(n.firestore,n.Qd,t,n.kd))},error:i}),o=this.firestore.wd(),s=o.listen(this.Qd,r,t);return function(){r.sd(),o.$u(s)}},xc.prototype.Yd=function(t){if(t.Ge()&&0===t.Ve.length)throw new qi(Mi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},xc.prototype.get=function(n){var i=this;return nu("Query.get",arguments,0,1),$c("Query.get",n),this.Yd(this.Qd),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.wd().td(i.Qd).then(function(t){e(new Mc(i.firestore,i.Qd,t,i.kd))},t):i.Ud(e,t,n)})},xc.prototype.Ud=function(e,n,i){var r=this.Md({includeMetadataChanges:!0,ql:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new qi(Mi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},xc.prototype.jd=function(t){if("string"==typeof t){if(""===t)throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.Qd.He()&&-1!==t.indexOf("/"))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.Qd.path.child(tr.K(t));if(!ar.st(e))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Fr(this.firestore._d,new ar(e))}if(t instanceof Oc){var n=t;return Fr(this.firestore._d,n.Sd)}throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+cu(t)+".")},xc.prototype.Wd=function(t,e){if(!Array.isArray(t)||0===t.length)throw new qi(Mi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new qi(Mi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new qi(Mi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new qi(Mi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},xc.prototype.Gd=function(t){if(t instanceof Zo){var e=[Mo.ARRAY_CONTAINS,Mo.ARRAY_CONTAINS_ANY],n=[Mo.IN,Mo.ARRAY_CONTAINS_ANY],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.ze()){var o=this.Qd.Se();if(null!==o&&!o.isEqual(t.field))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.Qd.Ce();null!==s&&this.Xd(t.field,s)}else if(r||i){var a=null;if(r&&(a=this.Qd.Ke(n)),null===a&&i&&(a=this.Qd.Ke(e)),null!=a)throw a===t.op?new qi(Mi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new qi(Mi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+a.toString()+"' filters.")}}},xc.prototype.zd=function(t){if(null===this.Qd.Ce()){var e=this.Qd.Se();null!==e&&this.Xd(e,t.field)}},xc.prototype.Xd=function(t,e){if(!e.isEqual(t))throw new qi(Mi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},xc),Mc=(Object.defineProperty(Gc.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Gc.prototype,"empty",{get:function(){return this.tf.docs.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Gc.prototype,"size",{get:function(){return this.tf.docs.size},enumerable:!0,configurable:!0}),Gc.prototype.forEach=function(e,n){var i=this;nu("QuerySnapshot.forEach",arguments,1,2),iu("QuerySnapshot.forEach","function",1,e),this.tf.docs.forEach(function(t){e.call(n,i.if(t))})},Object.defineProperty(Gc.prototype,"query",{get:function(){return new Pc(this.Zd,this.Fd,this.kd)},enumerable:!0,configurable:!0}),Gc.prototype.docChanges=function(t){t&&(fu("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),su("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.tf.ds)throw new qi(Mi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.ef&&this.sf===e||(this.ef=function(r,e,o,s){if(o.cs.q()){var n=0;return o.docChanges.map(function(t){var e=new Uc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var a=o.cs;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Uc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=a.indexOf(t.doc.key),a=a.delete(t.doc.key)),1!==t.type&&(i=(a=a.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return va("Unknown change type: "+t)}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.Fd,e,this.tf,this.kd),this.sf=e),this.ef},Gc.prototype.isEqual=function(t){if(!(t instanceof Gc))throw pu("isEqual","QuerySnapshot",1,t);return this.Fd===t.Fd&&this.Zd.isEqual(t.Zd)&&this.tf.isEqual(t.tf)&&this.kd===t.kd},Gc.prototype.if=function(t){return new Uc(this.Fd,t.key,t,this.metadata.fromCache,this.tf.ls.has(t.key),this.kd)},Gc),qc=(n(Fc,Nc=Pc),Object.defineProperty(Fc.prototype,"id",{get:function(){return this.Qd.path.U()},enumerable:!0,configurable:!0}),Object.defineProperty(Fc.prototype,"parent",{get:function(){var t=this.Qd.path.O();return t.q()?null:new Oc(new ar(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(Fc.prototype,"path",{get:function(){return this.Qd.path.G()},enumerable:!0,configurable:!0}),Fc.prototype.doc=function(t){if(nu("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=ma.Tn()),iu("CollectionReference.doc","non-empty string",1,t),""===t)throw new qi(Mi.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=tr.K(t);return Oc.Cd(this.Qd.path.child(e),this.firestore,this.kd)},Fc.prototype.add=function(t){tu("CollectionReference.add",arguments,1),iu("CollectionReference.add","object",1,this.kd?this.kd.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Fc.prototype.withConverter=function(t){return new Fc(this.nf,this.firestore,t)},Fc);function Fc(t,e,n){var i=this;if(((i=Nc.call(this,Po.ve(t),e,n)||this).nf=t).length%2!=1)throw new qi(Mi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.G()+" has "+t.length);return i}function Gc(t,e,n,i){this.Fd=t,this.Zd=e,this.tf=n,this.kd=i,this.ef=null,this.sf=null,this.metadata=new Cc(n.hasPendingWrites,n.fromCache)}function xc(t,e,n){this.Qd=t,this.firestore=e,this.kd=n}function jc(){return null!==Tc&&Tc.apply(this,arguments)||this}function Bc(t,e,n,i,r,o){this.Fd=t,this.Sd=e,this.qd=n,this.Bd=i,this.xd=r,this.kd=o}function Hc(t,e){this.hasPendingWrites=t,this.fromCache=e}function Qc(t,e,n){this.Sd=t,this.firestore=e,this.kd=n,this.Td=this.firestore.wd()}function zc(t){this.Fd=t,this.Ld=[],this.$d=!1}function Yc(t,e){this.Fd=t,this.Nd=e}function Wc(t,e,n){var i=this;if(void 0===n&&(n=new fc),this.dd=null,this.fd=new Qa,this.INTERNAL={delete:function(){return c(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wd(),[4,this.Td.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.dd=r,this._d=Wc.md(r),this.Ed=r.name,this.Rd=new Gi(e)}else{var o=t;if(!o.projectId)throw new qi(Mi.INVALID_ARGUMENT,"Must provide projectId");this._d=new Ia(o.projectId,o.database),this.Ed="[DEFAULT]",this.Rd=new Fi}this.Id=n,this.Ad=new kc({}),this.Pd=this.Vd(this._d)}function Xc(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new qi(Mi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ou("settings","non-empty string","host",t.host),this.host=t.host,su("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(fu("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),su("settings","object","credentials",t.credentials),this.credentials=t.credentials,su("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?da("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&da("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,su("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=za.nh;else{if(t.cacheSizeBytes!==Sc&&t.cacheSizeBytes<za.ih)throw new qi(Mi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+za.ih);this.cacheSizeBytes=t.cacheSizeBytes}su("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function Jc(t,e,n,i){this.firestore=t,this.timestampsInSnapshots=e,this.nd=n,this.converter=i}function Kc(t,e){if(void 0===e)return{merge:!1};if(fu(t,e,["merge","mergeFields"]),su(t,"boolean","merge",e.merge),n=t,void 0!==(i=e.mergeFields)&&function(t,e,n,i){if(!(n instanceof Array))throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+cu(n));for(var r=0;r<n.length;++r)if(!i(n[r]))throw new qi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+cu(n[r]))}(n,"mergeFields",i,function(t){return"string"==typeof t||t instanceof Au}),void 0!==e.mergeFields&&void 0!==e.merge)throw new qi(Mi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,i;return e}function Zc(t,e){return void 0===e?{}:(fu(t,e,["serverTimestamps"]),au(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function $c(t,e){ru(t,"object",1,e),e&&(fu(t,e,["source"]),au(t,0,"source",e.source,["default","server","cache"]))}function tl(t,e,n){if(e instanceof Oc){if(e.firestore!==n)throw new qi(Mi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw pu(t,"DocumentReference",1,e)}function el(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}var nl,il=gu(Rc,"Use firebase.firestore() instead."),rl=gu(Lc,"Use firebase.firestore().runTransaction() instead."),ol=gu(Dc,"Use firebase.firestore().batch() instead."),sl=gu(Oc,"Use firebase.firestore().doc() instead."),al=gu(Vc),ul=gu(Uc),hl=gu(Pc),cl=gu(Mc),ll=gu(qc,"Use firebase.firestore().collection() instead."),fl={Firestore:il,GeoPoint:xu,Timestamp:Bi,Blob:Eu,Transaction:rl,WriteBatch:ol,DocumentReference:sl,DocumentSnapshot:al,Query:hl,QueryDocumentSnapshot:ul,QuerySnapshot:cl,CollectionReference:ll,FieldPath:Au,FieldValue:Gu,setLogLevel:Rc.setLogLevel,CACHE_SIZE_UNLIMITED:Sc},pl=(Al.prototype.mu=function(t){},Al.prototype.ku=function(){},Al),dl=(El.prototype.mu=function(t){this.cf.push(t)},El.prototype.ku=function(){window.removeEventListener("online",this.rf),window.removeEventListener("offline",this.af)},El.prototype.lf=function(){window.addEventListener("online",this.rf),window.addEventListener("offline",this.af)},El.prototype.hf=function(){pa("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.cf;t<e.length;t++)(0,e[t])(0)},El.prototype.uf=function(){pa("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.cf;t<e.length;t++)(0,e[t])(1)},El._f=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},El),yl=(bl.prototype.Na=function(t){this.wf=t},bl.prototype.va=function(t){this.Tf=t},bl.prototype.onMessage=function(t){this.mf=t},bl.prototype.close=function(){this.ff()},bl.prototype.send=function(t){this.df(t)},bl.prototype.Ef=function(){this.wf()},bl.prototype.Rf=function(t){this.Tf(t)},bl.prototype.If=function(t){this.mf(t)},bl),vl={BatchGetDocuments:"batchGet",Commit:"commit"},gl="gl-js/ fire/"+Oi,ml=(wl.prototype.Pf=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=gl},wl.prototype.Ga=function(u,i,r){var h=this,c=this.Vf(u);return new Promise(function(o,s){var a=new Di;a.listenOnce(Ri.COMPLETE,function(){try{switch(a.getLastErrorCode()){case ki.NO_ERROR:var t=a.getResponseJson();pa("Connection","XHR received:",JSON.stringify(t)),o(t);break;case ki.TIMEOUT:pa("Connection",'RPC "'+u+'" timed out'),s(new qi(Mi.DEADLINE_EXCEEDED,"Request time out"));break;case ki.HTTP_ERROR:var e=a.getStatus();if(pa("Connection",'RPC "'+u+'" failed with status:',e,"response text:",a.getResponseText()),0<e){var n=a.getResponseJson().error;if(n&&n.status&&n.message){var i=(r=n.status.toLowerCase().replace("_","-"),0<=Object.values(Mi).indexOf(r)?r:Mi.UNKNOWN);s(new qi(i,n.message))}else s(new qi(Mi.UNKNOWN,"Server responded with status "+a.getStatus()))}else pa("Connection",'RPC "'+u+'" failed'),s(new qi(Mi.UNAVAILABLE,"Connection failed."));break;default:va('RPC "'+u+'" failed with unanticipated webchannel error '+a.getLastErrorCode()+": "+a.getLastError()+", giving up.")}}finally{pa("Connection",'RPC "'+u+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);pa("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.Pf(n,r),a.send(c,"POST",e,n,15)})},wl.prototype.Ka=function(t,e,n){return this.Ga(t,e,n)},wl.prototype.ka=function(t,e){var n,i,r=[this.Af,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Si(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ci.projectId+"/databases/"+this.ci.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Pf(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(i=p()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=r.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}pa("Connection","Creating WebChannel: "+a+" "+s);var h=o.createWebChannel(a,s),c=!1,l=!1,f=new yl({df:function(t){l?pa("Connection","Not sending because WebChannel is closed:",t):(c||(pa("Connection","Opening WebChannel transport."),h.open(),c=!0),pa("Connection","WebChannel sending:",t),h.send(t))},ff:function(){return h.close()}});return u(Li.EventType.OPEN,function(){l||pa("Connection","WebChannel transport opened.")}),u(Li.EventType.CLOSE,function(){l||(l=!0,pa("Connection","WebChannel transport closed"),f.Rf())}),u(Li.EventType.ERROR,function(t){l||(l=!0,pa("Connection","WebChannel transport errored:",t),f.Rf(new qi(Mi.UNAVAILABLE,"The operation could not be completed")))}),u(Li.EventType.MESSAGE,function(t){var e;if(!l){var n=t.data[0];ga(!!n,"Got a webchannel message without data.");var i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(i){pa("Connection","WebChannel received error:",i);var r=i.status,o=function(){var t=ps[r];if(void 0!==t)return Ns(t)}(),s=i.message;void 0===o&&(o=Mi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.Rf(new qi(o,s)),h.close()}else pa("Connection","WebChannel received:",n),f.If(n)}}),setTimeout(function(){f.Ef()},0),f},wl.prototype.Vf=function(t){var e=vl[t];return this.Af+"/v1/projects/"+this.ci.projectId+"/databases/"+this.ci.database+"/documents:"+e},wl);function wl(t){this.ci=t.ci;var e=t.ssl?"https":"http";this.Af=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function bl(t){this.df=t.df,this.ff=t.ff}function El(){var t=this;this.rf=function(){return t.hf()},this.af=function(){return t.uf()},this.cf=[],this.lf()}function Al(){}function Il(){this.di=!0,this.yo="undefined"!=typeof atob}ua.fn((Object.defineProperty(Il.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(Il.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),Il.prototype.K_=function(t){return Promise.resolve(new ml(t))},Il.prototype.Q_=function(){return new(dl._f()?dl:pl)},Il.prototype.H_=function(t){return new oa(t,{di:!0})},Il.prototype.wn=function(t){return JSON.stringify(t)},Il.prototype.atob=function(t){return atob(t)},Il.prototype.btoa=function(t){return btoa(t)},new Il)),(nl=Nl).INTERNAL.registerComponent(new E("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Rc(e,n,new fc);var e,n},"PUBLIC").setServiceProps(Object.assign({},fl))),nl.registerVersion("@firebase/firestore","1.14.0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
